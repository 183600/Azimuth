// å¤šè¯­è¨€å’ŒUnicodeæ”¯æŒæµ‹è¯•
// Multilingual and Unicode support tests for Azimuth telemetry system

test "å¤šè¯­è¨€å±æ€§é”®å€¼æµ‹è¯•" {
  // æµ‹è¯•å„ç§è¯­è¨€çš„å±æ€§é”®å’Œå€¼
  
  let attrs = @azimuth.telemetry.api.common.Attributes::new()
  
  // æµ‹è¯•ä¸­æ–‡å±æ€§
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ç”¨æˆ·å", @azimuth.telemetry.api.common.StringValue("å¼ ä¸‰"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "æœåŠ¡åç§°", @azimuth.telemetry.api.common.StringValue("ç”¨æˆ·è®¤è¯æœåŠ¡"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "æ“ä½œç±»å‹", @azimuth.telemetry.api.common.StringValue("ç™»å½•éªŒè¯"))
  
  // æµ‹è¯•æ—¥æ–‡å±æ€§
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ãƒ¦ãƒ¼ã‚¶ãƒ¼å", @azimuth.telemetry.api.common.StringValue("ç”°ä¸­å¤ªéƒ"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ã‚µãƒ¼ãƒ“ã‚¹å", @azimuth.telemetry.api.common.StringValue("èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "æ“ä½œã‚¿ã‚¤ãƒ—", @azimuth.telemetry.api.common.StringValue("ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼"))
  
  // æµ‹è¯•éŸ©æ–‡å±æ€§
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ì‚¬ìš©ìëª…", @azimuth.telemetry.api.common.StringValue("ê¹€ì² ìˆ˜"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ì„œë¹„ìŠ¤ëª…", @azimuth.telemetry.api.common.StringValue("ì¸ì¦ ì„œë¹„ìŠ¤"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ì‘ì—…ìœ í˜•", @azimuth.telemetry.api.common.StringValue("ë¡œê·¸ì¸ ì¸ì¦"))
  
  // æµ‹è¯•ä¿„æ–‡å±æ€§
  @azimuth.telemetry.api.common.Attributes::set(attrs, "Ğ¸Ğ¼Ñ_Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", @azimuth.telemetry.api.common.StringValue("Ğ˜Ğ²Ğ°Ğ½ ĞŸĞµÑ‚Ñ€Ğ¾Ğ²"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "Ğ¸Ğ¼Ñ_ÑĞµÑ€Ğ²Ğ¸ÑĞ°", @azimuth.telemetry.api.common.StringValue("ÑĞ»ÑƒĞ¶Ğ±Ğ°_Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "Ñ‚Ğ¸Ğ¿_Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸", @azimuth.telemetry.api.common.StringValue("Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ_Ğ²Ñ…Ğ¾Ğ´Ğ°"))
  
  // æµ‹è¯•é˜¿æ‹‰ä¼¯æ–‡å±æ€§
  @azimuth.telemetry.api.common.Attributes::set(attrs, "Ø§Ø³Ù…_Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", @azimuth.telemetry.api.common.StringValue("Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "Ø§Ø³Ù…_Ø§Ù„Ø®Ø¯Ù…Ø©", @azimuth.telemetry.api.common.StringValue("Ø®Ø¯Ù…Ø©_Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "Ù†ÙˆØ¹_Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", @azimuth.telemetry.api.common.StringValue("Ù…ØµØ§Ø¯Ù‚Ø©_Ø§Ù„Ø¯Ø®ÙˆÙ„"))
  
  // æµ‹è¯•æ··åˆè¯­è¨€å±æ€§
  @azimuth.telemetry.api.common.Attributes::set(attrs, "æ··åˆé”®å€¼", @azimuth.telemetry.api.common.StringValue("Mixed Value: å¼ ä¸‰-ç”°ä¸­-ê¹€ì² ìˆ˜-Ğ˜Ğ²Ğ°Ğ½-Ø£Ø­Ù…Ø¯"))
  
  // éªŒè¯å±æ€§è®¾ç½®æˆåŠŸ
  assert_true(attrs != @azimuth.telemetry.api.common.Attributes::{})
  
  // æµ‹è¯•å±æ€§è·å–ï¼ˆç®€åŒ–å®ç°å¯èƒ½è¿”å›Noneï¼‰
  let chinese_username = @azimuth.telemetry.api.common.Attributes::get(attrs, "ç”¨æˆ·å")
  let japanese_username = @azimuth.telemetry.api.common.Attributes::get(attrs, "ãƒ¦ãƒ¼ã‚¶ãƒ¼å")
  let korean_username = @azimuth.telemetry.api.common.Attributes::get(attrs, "ì‚¬ìš©ìëª…")
  let russian_username = @azimuth.telemetry.api.common.Attributes::get(attrs, "Ğ¸Ğ¼Ñ_Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ")
  let arabic_username = @azimuth.telemetry.api.common.Attributes::get(attrs, "Ø§Ø³Ù…_Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…")
  let mixed_value = @azimuth.telemetry.api.common.Attributes::get(attrs, "æ··åˆé”®å€¼")
}

test "å¤šè¯­è¨€Spanåç§°å’Œäº‹ä»¶æµ‹è¯•" {
  // æµ‹è¯•å¤šè¯­è¨€Spanåç§°å’Œäº‹ä»¶
  
  let trace_provider = @azimuth.telemetry.sdk.trace.TracerProvider::default()
  let tracer = @azimuth.telemetry.sdk.trace.TracerProvider::get_tracer(trace_provider, "å¤šè¯­è¨€æµ‹è¯•è¿½è¸ªå™¨")
  
  // åˆ›å»ºä¸­æ–‡Span
  let (_, chinese_span) = @azimuth.telemetry.sdk.trace.Tracer::start_span(tracer, "ç”¨æˆ·ç™»å½•æµç¨‹")
  @azimuth.telemetry.api.trace.Span::set_attribute(chinese_span, "ç”¨æˆ·ID", @azimuth.telemetry.api.common.StringValue("ç”¨æˆ·12345"))
  @azimuth.telemetry.api.trace.Span::set_attribute(chinese_span, "æ“ä½œæè¿°", @azimuth.telemetry.api.common.StringValue("ç”¨æˆ·é€šè¿‡æ‰‹æœºå·è¿›è¡Œç™»å½•éªŒè¯"))
  
  // æ·»åŠ ä¸­æ–‡äº‹ä»¶
  @azimuth.telemetry.api.trace.Span::add_event(
    chinese_span, 
    "å¼€å§‹éªŒè¯ç”¨æˆ·èº«ä»½", 
    Some([("éªŒè¯æ–¹å¼", @azimuth.telemetry.api.common.StringValue("çŸ­ä¿¡éªŒè¯ç "))]),
    None
  )
  
  @azimuth.telemetry.api.trace.Span::add_event(
    chinese_span, 
    "éªŒè¯æˆåŠŸ", 
    Some([("ç»“æœ", @azimuth.telemetry.api.common.StringValue("ç”¨æˆ·èº«ä»½éªŒè¯é€šè¿‡"))]),
    None
  )
  
  // åˆ›å»ºæ—¥æ–‡Span
  let (_, japanese_span) = @azimuth.telemetry.sdk.trace.Tracer::start_span(tracer, "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†")
  @azimuth.telemetry.api.trace.Span::set_attribute(japanese_span, "ãƒ¦ãƒ¼ã‚¶ãƒ¼ID", @azimuth.telemetry.api.common.StringValue("ãƒ¦ãƒ¼ã‚¶ãƒ¼12345"))
  @azimuth.telemetry.api.trace.Span::set_attribute(japanese_span, "æ“ä½œèª¬æ˜", @azimuth.telemetry.api.common.StringValue("é›»è©±ç•ªå·ã§ã®ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼"))
  
  // æ·»åŠ æ—¥æ–‡äº‹ä»¶
  @azimuth.telemetry.api.trace.Span::add_event(
    japanese_span, 
    "ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼é–‹å§‹", 
    Some([("èªè¨¼æ–¹å¼", @azimuth.telemetry.api.common.StringValue("SMSèªè¨¼ã‚³ãƒ¼ãƒ‰"))]),
    None
  )
  
  @azimuth.telemetry.api.trace.Span::add_event(
    japanese_span, 
    "èªè¨¼æˆåŠŸ", 
    Some([("çµæœ", @azimuth.telemetry.api.common.StringValue("ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼å®Œäº†"))]),
    None
  )
  
  // åˆ›å»ºéŸ©æ–‡Span
  let (_, korean_span) = @azimuth.telemetry.sdk.trace.Tracer::start_span(tracer, "ì‚¬ìš©ì ë¡œê·¸ì¸ ì²˜ë¦¬")
  @azimuth.telemetry.api.trace.Span::set_attribute(korean_span, "ì‚¬ìš©ìID", @azimuth.telemetry.api.common.StringValue("ì‚¬ìš©ì12345"))
  @azimuth.telemetry.api.trace.Span::set_attribute(korean_span, "ì‘ì—…ì„¤ëª…", @azimuth.telemetry.api.common.StringValue("ì „í™”ë²ˆí˜¸ë¥¼ í†µí•œ ë¡œê·¸ì¸ ì¸ì¦"))
  
  // æ·»åŠ éŸ©æ–‡äº‹ä»¶
  @azimuth.telemetry.api.trace.Span::add_event(
    korean_span, 
    "ì‚¬ìš©ì ì¸ì¦ ì‹œì‘", 
    Some([("ì¸ì¦ë°©ì‹", @azimuth.telemetry.api.common.StringValue("SMS ì¸ì¦ì½”ë“œ"))]),
    None
  )
  
  @azimuth.telemetry.api.trace.Span::add_event(
    korean_span, 
    "ì¸ì¦ ì„±ê³µ", 
    Some([("ê²°ê³¼", @azimuth.telemetry.api.common.StringValue("ì‚¬ìš©ì ì¸ì¦ ì™„ë£Œ"))]),
    None
  )
  
  // ç»“æŸæ‰€æœ‰Span
  @azimuth.telemetry.api.trace.Span::end(chinese_span)
  @azimuth.telemetry.api.trace.Span::end(japanese_span)
  @azimuth.telemetry.api.trace.Span::end(korean_span)
  
  // éªŒè¯Spanéƒ½æœ‰æœ‰æ•ˆçš„ä¸Šä¸‹æ–‡
  let chinese_ctx = @azimuth.telemetry.api.trace.Span::span_context(chinese_span)
  let japanese_ctx = @azimuth.telemetry.api.trace.Span::span_context(japanese_span)
  let korean_ctx = @azimuth.telemetry.api.trace.Span::span_context(korean_span)
  
  assert_true(@azimuth.telemetry.api.trace.SpanContext::is_valid(chinese_ctx))
  assert_true(@azimuth.telemetry.api.trace.SpanContext::is_valid(japanese_ctx))
  assert_true(@azimuth.telemetry.api.trace.SpanContext::is_valid(korean_ctx))
}

test "å¤šè¯­è¨€æ—¥å¿—è®°å½•æµ‹è¯•" {
  // æµ‹è¯•å¤šè¯­è¨€æ—¥å¿—è®°å½•
  
  let logs_provider = @azimuth.telemetry.sdk.logs.LoggerProvider::default()
  let logger = @azimuth.telemetry.sdk.logs.LoggerProvider::get_logger(logs_provider, "å¤šè¯­è¨€æ—¥å¿—è®°å½•å™¨")
  
  // åˆ›å»ºä¸­æ–‡æ—¥å¿—
  let chinese_attrs = @azimuth.telemetry.api.common.Attributes::new()
  @azimuth.telemetry.api.common.Attributes::set(chinese_attrs, "ç”¨æˆ·å", @azimuth.telemetry.api.common.StringValue("å¼ ä¸‰"))
  @azimuth.telemetry.api.common.Attributes::set(chinese_attrs, "æ“ä½œ", @azimuth.telemetry.api.common.StringValue("ç™»å½•"))
  @azimuth.telemetry.api.common.Attributes::set(chinese_attrs, "ç»“æœ", @azimuth.telemetry.api.common.StringValue("æˆåŠŸ"))
  
  let chinese_log = @azimuth.telemetry.api.logs.LogRecord::new(
    @azimuth.telemetry.api.logs.Info,
    "ç”¨æˆ·ç™»å½•æ“ä½œæˆåŠŸå®Œæˆ",
    Some(chinese_attrs),
    Some(@azimuth.telemetry.sdk.platform.time.Clock::now_unix_nanos(@azimuth.telemetry.sdk.platform.time.Clock::system())),
    None,
    Some("ä¸­æ–‡è¿½è¸ªID123"),
    Some("ä¸­æ–‡è·¨åº¦ID456"),
    None
  )
  
  // åˆ›å»ºæ—¥æ–‡æ—¥å¿—
  let japanese_attrs = @azimuth.telemetry.api.common.Attributes::new()
  @azimuth.telemetry.api.common.Attributes::set(japanese_attrs, "ãƒ¦ãƒ¼ã‚¶ãƒ¼å", @azimuth.telemetry.api.common.StringValue("ç”°ä¸­å¤ªéƒ"))
  @azimuth.telemetry.api.common.Attributes::set(japanese_attrs, "æ“ä½œ", @azimuth.telemetry.api.common.StringValue("ãƒ­ã‚°ã‚¤ãƒ³"))
  @azimuth.telemetry.api.common.Attributes::set(japanese_attrs, "çµæœ", @azimuth.telemetry.api.common.StringValue("æˆåŠŸ"))
  
  let japanese_log = @azimuth.telemetry.api.logs.LogRecord::new(
    @azimuth.telemetry.api.logs.Info,
    "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³æ“ä½œãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ",
    Some(japanese_attrs),
    Some(@azimuth.telemetry.sdk.platform.time.Clock::now_unix_nanos(@azimuth.telemetry.sdk.platform.time.Clock::system())),
    None,
    Some("æ—¥æœ¬èªãƒˆãƒ¬ãƒ¼ã‚¹ID123"),
    Some("æ—¥æœ¬èªã‚¹ãƒ‘ãƒ³ID456"),
    None
  )
  
  // åˆ›å»ºéŸ©æ–‡æ—¥å¿—
  let korean_attrs = @azimuth.telemetry.api.common.Attributes::new()
  @azimuth.telemetry.api.common.Attributes::set(korean_attrs, "ì‚¬ìš©ìëª…", @azimuth.telemetry.api.common.StringValue("ê¹€ì² ìˆ˜"))
  @azimuth.telemetry.api.common.Attributes::set(korean_attrs, "ì‘ì—…", @azimuth.telemetry.api.common.StringValue("ë¡œê·¸ì¸"))
  @azimuth.telemetry.api.common.Attributes::set(korean_attrs, "ê²°ê³¼", @azimuth.telemetry.api.common.StringValue("ì„±ê³µ"))
  
  let korean_log = @azimuth.telemetry.api.logs.LogRecord::new(
    @azimuth.telemetry.api.logs.Info,
    "ì‚¬ìš©ì ë¡œê·¸ì¸ ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤",
    Some(korean_attrs),
    Some(@azimuth.telemetry.sdk.platform.time.Clock::now_unix_nanos(@azimuth.telemetry.sdk.platform.time.Clock::system())),
    None,
    Some("í•œêµ­ì–´ ì¶”ì  ID123"),
    Some("í•œêµ­ì–´ ìŠ¤íŒ¬ ID456"),
    None
  )
  
  // è®°å½•æ‰€æœ‰æ—¥å¿—
  @azimuth.telemetry.sdk.logs.Logger::emit(logger, chinese_log)
  @azimuth.telemetry.sdk.logs.Logger::emit(logger, japanese_log)
  @azimuth.telemetry.sdk.logs.Logger::emit(logger, korean_log)
  
  // æµ‹è¯•ä¸åŒä¸¥é‡ç¨‹åº¦çš„å¤šè¯­è¨€æ—¥å¿—
  let severity_messages = [
    (@azimuth.telemetry.api.logs.Trace, "è·Ÿè¸ªä¿¡æ¯ï¼šè¯¦ç»†è°ƒè¯•ä¿¡æ¯"),
    (@azimuth.telemetry.api.logs.Debug, "è°ƒè¯•ä¿¡æ¯ï¼šå¼€å‘é˜¶æ®µè°ƒè¯•"),
    (@azimuth.telemetry.api.logs.Info, "ä¿¡æ¯æ—¥å¿—ï¼šæ­£å¸¸æ“ä½œè®°å½•"),
    (@azimuth.telemetry.api.logs.Warn, "è­¦å‘Šä¿¡æ¯ï¼šéœ€è¦æ³¨æ„çš„æƒ…å†µ"),
    (@azimuth.telemetry.api.logs.Error, "é”™è¯¯ä¿¡æ¯ï¼šæ“ä½œå¤±è´¥è®°å½•"),
    (@azimuth.telemetry.api.logs.Fatal, "è‡´å‘½é”™è¯¯ï¼šç³»ç»Ÿä¸¥é‡é—®é¢˜")
  ]
  
  for (severity, message) in severity_messages {
    let severity_log = @azimuth.telemetry.api.logs.LogRecord::new(
      severity,
      message,
      None,
      None,
      None,
      None,
      None,
      None
    )
    
    @azimuth.telemetry.sdk.logs.Logger::emit(logger, severity_log)
  }
}

test "å¤šè¯­è¨€æŒ‡æ ‡æµ‹è¯•" {
  // æµ‹è¯•å¤šè¯­è¨€æŒ‡æ ‡åç§°å’Œæè¿°
  
  let metrics_provider = @azimuth.telemetry.sdk.metrics.MeterProvider::default()
  let meter = @azimuth.telemetry.sdk.metrics.MeterProvider::get_meter(metrics_provider, "å¤šè¯­è¨€æŒ‡æ ‡æµ‹é‡å™¨")
  
  // åˆ›å»ºä¸­æ–‡æŒ‡æ ‡
  let chinese_counter = @azimuth.telemetry.sdk.metrics.Meter::create_counter(
    meter,
    "ç”¨æˆ·ç™»å½•æ¬¡æ•°",
    Some("è®°å½•ç”¨æˆ·ç™»å½•æˆåŠŸçš„æ€»æ¬¡æ•°"),
    Some("æ¬¡")
  )
  
  let chinese_histogram = @azimuth.telemetry.sdk.metrics.Meter::create_histogram(
    meter,
    "å“åº”æ—¶é—´",
    Some("APIè¯·æ±‚å“åº”æ—¶é—´åˆ†å¸ƒ"),
    Some("æ¯«ç§’")
  )
  
  // åˆ›å»ºæ—¥æ–‡æŒ‡æ ‡
  let japanese_counter = @azimuth.telemetry.sdk.metrics.Meter::create_counter(
    meter,
    "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³å›æ•°",
    Some("ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸã®ç·å›æ•°ã‚’è¨˜éŒ²"),
    Some("å›")
  )
  
  let japanese_histogram = @azimuth.telemetry.sdk.metrics.Meter::create_histogram(
    meter,
    "å¿œç­”æ™‚é–“",
    Some("APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå¿œç­”æ™‚é–“ã®åˆ†å¸ƒ"),
    Some("ãƒŸãƒªç§’")
  )
  
  // åˆ›å»ºéŸ©æ–‡æŒ‡æ ‡
  let korean_counter = @azimuth.telemetry.sdk.metrics.Meter::create_counter(
    meter,
    "ì‚¬ìš©ì ë¡œê·¸ì¸ íšŸìˆ˜",
    Some("ì‚¬ìš©ì ë¡œê·¸ì¸ ì„±ê³µ ì´ íšŸìˆ˜ ê¸°ë¡"),
    Some("íšŒ")
  )
  
  let korean_histogram = @azimuth.telemetry.sdk.metrics.Meter::create_histogram(
    meter,
    "ì‘ë‹µ ì‹œê°„",
    Some("API ìš”ì²­ ì‘ë‹µ ì‹œê°„ ë¶„í¬"),
    Some("ë°€ë¦¬ì´ˆ")
  )
  
  // è®°å½•ä¸­æ–‡æŒ‡æ ‡
  let chinese_attrs = @azimuth.telemetry.api.common.Attributes::new()
  @azimuth.telemetry.api.common.Attributes::set(chinese_attrs, "ç”¨æˆ·ç±»å‹", @azimuth.telemetry.api.common.StringValue("æ™®é€šç”¨æˆ·"))
  @azimuth.telemetry.api.common.Attributes::set(chinese_attrs, "ç™»å½•æ–¹å¼", @azimuth.telemetry.api.common.StringValue("æ‰‹æœºå·"))
  
  @azimuth.telemetry.sdk.metrics.Counter::add(chinese_counter, 1.0, Some(chinese_attrs))
  @azimuth.telemetry.sdk.metrics.Histogram::record(chinese_histogram, 150.5, Some(chinese_attrs))
  
  // è®°å½•æ—¥æ–‡æŒ‡æ ‡
  let japanese_attrs = @azimuth.telemetry.api.common.Attributes::new()
  @azimuth.telemetry.api.common.Attributes::set(japanese_attrs, "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—", @azimuth.telemetry.api.common.StringValue("ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼"))
  @azimuth.telemetry.api.common.Attributes::set(japanese_attrs, "ãƒ­ã‚°ã‚¤ãƒ³æ–¹å¼", @azimuth.telemetry.api.common.StringValue("é›»è©±ç•ªå·"))
  
  @azimuth.telemetry.sdk.metrics.Counter::add(japanese_counter, 1.0, Some(japanese_attrs))
  @azimuth.telemetry.sdk.metrics.Histogram::record(japanese_histogram, 120.3, Some(japanese_attrs))
  
  // è®°å½•éŸ©æ–‡æŒ‡æ ‡
  let korean_attrs = @azimuth.telemetry.api.common.Attributes::new()
  @azimuth.telemetry.api.common.Attributes::set(korean_attrs, "ì‚¬ìš©ì ìœ í˜•", @azimuth.telemetry.api.common.StringValue("ì¼ë°˜ ì‚¬ìš©ì"))
  @azimuth.telemetry.api.common.Attributes::set(korean_attrs, "ë¡œê·¸ì¸ ë°©ì‹", @azimuth.telemetry.api.common.StringValue("ì „í™”ë²ˆí˜¸"))
  
  @azimuth.telemetry.sdk.metrics.Counter::add(korean_counter, 1.0, Some(korean_attrs))
  @azimuth.telemetry.sdk.metrics.Histogram::record(korean_histogram, 180.7, Some(korean_attrs))
}

test "å¤šè¯­è¨€èµ„æºæµ‹è¯•" {
  // æµ‹è¯•å¤šè¯­è¨€èµ„æºå±æ€§
  
  // åˆ›å»ºä¸­æ–‡èµ„æº
  let chinese_resource = @azimuth.telemetry.api.common.Resource::with_attributes(
    @azimuth.telemetry.api.common.Resource::new(),
    [
      ("æœåŠ¡åç§°", @azimuth.telemetry.api.common.StringValue("ç”¨æˆ·è®¤è¯æœåŠ¡")),
      ("æœåŠ¡ç‰ˆæœ¬", @azimuth.telemetry.api.common.StringValue("1.0.0")),
      ("æœåŠ¡å®ä¾‹ID", @azimuth.telemetry.api.common.StringValue("å®ä¾‹-CN-001")),
      ("éƒ¨ç½²ç¯å¢ƒ", @azimuth.telemetry.api.common.StringValue("ç”Ÿäº§ç¯å¢ƒ")),
      ("æ•°æ®ä¸­å¿ƒ", @azimuth.telemetry.api.common.StringValue("åŒ—äº¬æ•°æ®ä¸­å¿ƒ"))
    ]
  )
  
  // åˆ›å»ºæ—¥æ–‡èµ„æº
  let japanese_resource = @azimuth.telemetry.api.common.Resource::with_attributes(
    @azimuth.telemetry.api.common.Resource::new(),
    [
      ("ã‚µãƒ¼ãƒ“ã‚¹å", @azimuth.telemetry.api.common.StringValue("èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹")),
      ("ã‚µãƒ¼ãƒ“ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ³", @azimuth.telemetry.api.common.StringValue("1.0.0")),
      ("ã‚µãƒ¼ãƒ“ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ID", @azimuth.telemetry.api.common.StringValue("ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹-JP-001")),
      ("ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ", @azimuth.telemetry.api.common.StringValue("æœ¬ç•ªç’°å¢ƒ")),
      ("ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼", @azimuth.telemetry.api.common.StringValue("æ±äº¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼"))
    ]
  )
  
  // åˆ›å»ºéŸ©æ–‡èµ„æº
  let korean_resource = @azimuth.telemetry.api.common.Resource::with_attributes(
    @azimuth.telemetry.api.common.Resource::new(),
    [
      ("ì„œë¹„ìŠ¤ëª…", @azimuth.telemetry.api.common.StringValue("ì¸ì¦ ì„œë¹„ìŠ¤")),
      ("ì„œë¹„ìŠ¤ ë²„ì „", @azimuth.telemetry.api.common.StringValue("1.0.0")),
      ("ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ID", @azimuth.telemetry.api.common.StringValue("ì¸ìŠ¤í„´ìŠ¤-KR-001")),
      ("ë°°í¬ í™˜ê²½", @azimuth.telemetry.api.common.StringValue("í”„ë¡œë•ì…˜ í™˜ê²½")),
      ("ë°ì´í„° ì„¼í„°", @azimuth.telemetry.api.common.StringValue("ì„œìš¸ ë°ì´í„° ì„¼í„°"))
    ]
  )
  
  // æµ‹è¯•èµ„æºåˆå¹¶
  let merged_resource1 = @azimuth.telemetry.api.common.Resource::merge(chinese_resource, japanese_resource)
  let merged_resource2 = @azimuth.telemetry.api.common.Resource::merge(merged_resource1, korean_resource)
  
  // éªŒè¯èµ„æºå±æ€§ï¼ˆç®€åŒ–å®ç°å¯èƒ½è¿”å›Noneï¼‰
  let chinese_service_name = @azimuth.telemetry.api.common.Resource::get_attribute(chinese_resource, "æœåŠ¡åç§°")
  let japanese_service_name = @azimuth.telemetry.api.common.Resource::get_attribute(japanese_resource, "ã‚µãƒ¼ãƒ“ã‚¹å")
  let korean_service_name = @azimuth.telemetry.api.common.Resource::get_attribute(korean_resource, "ì„œë¹„ìŠ¤ëª…")
  
  // æµ‹è¯•ä½¿ç”¨å¤šè¯­è¨€èµ„æºåˆ›å»ºæä¾›è€…
  let chinese_trace_provider = @azimuth.telemetry.sdk.trace.TracerProvider::with_resource(chinese_resource)
  let japanese_metrics_provider = @azimuth.telemetry.sdk.metrics.MeterProvider::with_resource(japanese_resource)
  let korean_logs_provider = @azimuth.telemetry.sdk.logs.LoggerProvider::with_resource(korean_resource)
  
  // éªŒè¯æä¾›è€…åˆ›å»ºæˆåŠŸ
  assert_true(chinese_trace_provider != @azimuth.telemetry.sdk.trace.TracerProvider::{})
  assert_true(japanese_metrics_provider != @azimuth.telemetry.sdk.metrics.MeterProvider::{})
  assert_true(korean_logs_provider != @azimuth.telemetry.sdk.logs.LoggerProvider::{})
}

test "Unicodeç‰¹æ®Šå­—ç¬¦æµ‹è¯•" {
  // æµ‹è¯•Unicodeç‰¹æ®Šå­—ç¬¦å¤„ç†
  
  let attrs = @azimuth.telemetry.api.common.Attributes::new()
  
  // æµ‹è¯•Emojiå­—ç¬¦
  @azimuth.telemetry.api.common.Attributes::set(attrs, "è¡¨æƒ…ç¬¦å·", @azimuth.telemetry.api.common.StringValue("ğŸš€ğŸŒŸâ­ğŸ’«âœ¨ğŸ‰ğŸŠğŸˆğŸğŸ‚ğŸ°"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "åŠ¨ç‰©è¡¨æƒ…", @azimuth.telemetry.api.common.StringValue("ğŸ¶ğŸ±ğŸ­ğŸ¹ğŸ°ğŸ¦ŠğŸ»ğŸ¼ğŸ¨ğŸ¯"))
  @azimuth.telemetry.api.common.Attributes::set(attrs, "é£Ÿç‰©è¡¨æƒ…", @azimuth.telemetry.api.common.StringValue("ğŸğŸŠğŸ‹ğŸŒğŸ‰ğŸ‡ğŸ“ğŸ«ğŸˆğŸ’"))
  
  // æµ‹è¯•æ•°å­¦ç¬¦å·
  @azimuth.telemetry.api.common.Attributes::set(attrs, "æ•°å­¦ç¬¦å·", @azimuth.telemetry.api.common.StringValue("âˆ‘âˆâˆ«âˆ†âˆ‡âˆ‚âˆÂ±â‰¤â‰¥â‰ â‰ˆâˆˆâˆ‰âˆªâˆ©"))
  
  // æµ‹è¯•è´§å¸ç¬¦å·
  @azimuth.telemetry.api.common.Attributes::set(attrs, "è´§å¸ç¬¦å·", @azimuth.telemetry.api.common.StringValue("Â¥$â‚¬Â£Â¢â‚¹â‚½â‚©â‚ªâ‚«â‚¡â‚¦â‚¨â‚±â‚²â‚´â‚¸â‚¼â‚®"))
  
  // æµ‹è¯•ç®­å¤´ç¬¦å·
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ç®­å¤´ç¬¦å·", @azimuth.telemetry.api.common.StringValue("â†â†’â†‘â†“â†–â†—â†˜â†™â‡â‡’â‡‘â‡“â‡”â‡•â‡–â‡—â‡˜â‡™"))
  
  // æµ‹è¯•ç‰¹æ®ŠUnicodeå­—ç¬¦
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ç‰¹æ®Šå­—ç¬¦", @azimuth.telemetry.api.common.StringValue("â„¢Â®Â©Â§Â¶â€ â€¡â€¢â€¦â€°â€²â€³â€¹â€º''""""â€“â€”"))
  
  // æµ‹è¯•ç»„åˆå­—ç¬¦
  @azimuth.telemetry.api.common.Attributes::set(attrs, "ç»„åˆå­—ç¬¦", @azimuth.telemetry.api.common.StringValue("Ã©Ã Ã¨Ã¹Ã¢ÃªÃ®Ã´Ã»Ã¤Ã«Ã¯Ã¶Ã¼Ã£ÃµÃ¥Ã¦Å“Ã§Ã±ÃŸ"))
  
  // æµ‹è¯•åœ¨Spanä¸­ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦
  let trace_provider = @azimuth.telemetry.sdk.trace.TracerProvider::default()
  let tracer = @azimuth.telemetry.sdk.trace.TracerProvider::get_tracer(trace_provider, "ç‰¹æ®Šå­—ç¬¦æµ‹è¯•è¿½è¸ªå™¨")
  
  let (_, special_span) = @azimuth.telemetry.sdk.trace.Tracer::start_span(tracer, "ğŸš€ç‰¹æ®Šå­—ç¬¦æµ‹è¯•SpanğŸŒŸ")
  
  // æ·»åŠ ç‰¹æ®Šå­—ç¬¦å±æ€§
  @azimuth.telemetry.api.trace.Span::set_attribute(special_span, "è¡¨æƒ…æµ‹è¯•", @azimuth.telemetry.api.common.StringValue("ğŸ˜€ğŸ˜ƒğŸ˜„ğŸ˜ğŸ˜†ğŸ˜…ğŸ˜‚ğŸ¤£ğŸ˜ŠğŸ˜‡"))
  @azimuth.telemetry.api.trace.Span::set_attribute(special_span, "ç¬¦å·æµ‹è¯•", @azimuth.telemetry.api.common.StringValue("â™ â™£â™¥â™¦â™¤â™§â™¡â™¢â˜…â˜†â˜€â˜â›…â›ˆğŸŒ¤ğŸŒ¥ğŸŒ¦ğŸŒ§ğŸŒ¨ğŸŒ©ğŸŒª"))
  
  // æ·»åŠ ç‰¹æ®Šå­—ç¬¦äº‹ä»¶
  let special_attrs = @azimuth.telemetry.api.common.Attributes::new()
  @azimuth.telemetry.api.common.Attributes::set(special_attrs, "äº‹ä»¶ç±»å‹", @azimuth.telemetry.api.common.StringValue("ğŸ‰ç‰¹æ®Šäº‹ä»¶ğŸŠ"))
  
  @azimuth.telemetry.api.trace.Span::add_event(
    special_span, 
    "âœ¨ç‰¹æ®Šå­—ç¬¦äº‹ä»¶â­", 
    Some(special_attrs),
    None
  )
  
  // è®°å½•ç‰¹æ®Šå­—ç¬¦å¼‚å¸¸
  @azimuth.telemetry.api.trace.Span::record_exception(
    special_span,
    "âš ï¸ç‰¹æ®Šå­—ç¬¦å¼‚å¸¸âš ï¸",
    Some("ğŸš¨UnicodeExceptionğŸš¨"),
    Some("at special.char.test()\n  at main()"),
    Some(special_attrs)
  )
  
  @azimuth.telemetry.api.trace.Span::end(special_span)
  
  // æµ‹è¯•ç‰¹æ®Šå­—ç¬¦æ—¥å¿—
  let logs_provider = @azimuth.telemetry.sdk.logs.LoggerProvider::default()
  let logger = @azimuth.telemetry.sdk.logs.LoggerProvider::get_logger(logs_provider, "ç‰¹æ®Šå­—ç¬¦æ—¥å¿—è®°å½•å™¨")
  
  let special_log = @azimuth.telemetry.api.logs.LogRecord::new(
    @azimuth.telemetry.api.logs.Warn,
    "âš ï¸åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æ—¥å¿—æ¶ˆæ¯ğŸŒŸ",
    Some(special_attrs),
    None,
    None,
    None,
    None,
    None
  )
  
  @azimuth.telemetry.sdk.logs.Logger::emit(logger, special_log)
}

test "ä¸Šä¸‹æ–‡ä¼ æ’­å¤šè¯­è¨€æµ‹è¯•" {
  // æµ‹è¯•å¤šè¯­è¨€ä¸Šä¸‹æ–‡ä¼ æ’­
  
  let composite = @azimuth.telemetry.api.propagation.CompositePropagator::new([
    @azimuth.telemetry.api.propagation.W3CTraceContextPropagator::new(),
    @azimuth.telemetry.api.propagation.W3CBaggagePropagator::new()
  ])
  
  // åˆ›å»ºå¤šè¯­è¨€baggage
  let ctx = @azimuth.telemetry.api.context.Context::root()
  
  // æ·»åŠ å¤šè¯­è¨€ä¸Šä¸‹æ–‡å€¼
  let chinese_key = @azimuth.telemetry.api.context.ContextKey::new("ä¸­æ–‡é”®")
  let ctx_with_chinese = @azimuth.telemetry.api.context.Context::with_value(ctx, chinese_key, "ä¸­æ–‡å€¼")
  
  let japanese_key = @azimuth.telemetry.api.context.ContextKey::new("æ—¥æœ¬èªã‚­ãƒ¼")
  let ctx_with_japanese = @azimuth.telemetry.api.context.Context::with_value(ctx_with_chinese, japanese_key, "æ—¥æœ¬èªå€¤")
  
  let korean_key = @azimuth.telemetry.api.context.ContextKey::new("í•œêµ­ì–´ í‚¤")
  let ctx_with_korean = @azimuth.telemetry.api.context.Context::with_value(ctx_with_japanese, korean_key, "í•œêµ­ì–´ ê°’")
  
  // æµ‹è¯•æ³¨å…¥
  let carrier = @azimuth.telemetry.api.propagation.TextMapCarrier::new()
  @azimuth.telemetry.api.propagation.CompositePropagator::inject(composite, ctx_with_korean, carrier)
  
  // éªŒè¯æ³¨å…¥çš„traceparent
  let traceparent = @azimuth.telemetry.api.propagation.TextMapCarrier::get(carrier, "traceparent")
  assert_true(traceparent != None)
  assert_true(traceparent.unwrap().starts_with("00-"))
  
  // æµ‹è¯•æå–
  let extracted_ctx = @azimuth.telemetry.api.propagation.CompositePropagator::extract(composite, carrier)
  assert_true(extracted_ctx != @azimuth.telemetry.api.context.Context::{})
  
  // æµ‹è¯•å¤šè¯­è¨€baggageå€¼
  let baggage_carrier = @azimuth.telemetry.api.propagation.TextMapCarrier::new()
  @azimuth.telemetry.api.propagation.TextMapCarrier::set(
    baggage_carrier, 
    "baggage", 
    "ç”¨æˆ·=å¼ ä¸‰,ãƒ¦ãƒ¼ã‚¶ãƒ¼=ç”°ä¸­,ì‚¬ìš©ì=ê¹€ì² ìˆ˜,user=John"
  )
  
  let baggage_extracted_ctx = @azimuth.telemetry.api.propagation.CompositePropagator::extract(composite, baggage_carrier)
  assert_true(baggage_extracted_ctx != @azimuth.telemetry.api.context.Context::{})
  
  // æµ‹è¯•å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦çš„baggage
  let special_baggage_carrier = @azimuth.telemetry.api.propagation.TextMapCarrier::new()
  @azimuth.telemetry.api.propagation.TextMapCarrier::set(
    special_baggage_carrier, 
    "baggage", 
    "è¡¨æƒ…=ğŸš€,ç¬¦å·=âˆ‘âˆâˆ«,è´§å¸=Â¥$â‚¬,ç®­å¤´=â†â†’"
  )
  
  let special_extracted_ctx = @azimuth.telemetry.api.propagation.CompositePropagator::extract(composite, special_baggage_carrier)
  assert_true(special_extracted_ctx != @azimuth.telemetry.api.context.Context::{})
}