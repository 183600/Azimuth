// é«˜è´¨é‡ MoonBit æµ‹è¯•ç”¨ä¾‹ - é’ˆå¯¹ azimuth åº“çš„æ ¸å¿ƒåŠŸèƒ½è¿›è¡Œå…¨é¢æµ‹è¯•
// åŒ…å«è¾¹ç•Œæƒ…å†µã€æ•°å­¦æ€§è´¨éªŒè¯å’Œå®é™…åº”ç”¨åœºæ™¯

test "import_test" {
  // ç®€å•çš„å¯¼å…¥æµ‹è¯•ï¼Œç¡®ä¿å‡½æ•°å¯ä»¥æ­£å¸¸è°ƒç”¨
  assert_eq(5, add(2, 3))
  assert_eq(6, multiply(2, 3))
  assert_eq_string("Hello, Test!", greet("Test"))
  assert_eq(4, divide_with_ceil(10, 3))
}

test "enhanced_mathematical_properties" {
  // æµ‹è¯•åŸºæœ¬æ•°å­¦æ€§è´¨
  let a = 12
  let b = 8
  let c = 5
  
  // åŠ æ³•äº¤æ¢å¾‹å’Œç»“åˆå¾‹
  assert_eq(add(a, b), add(b, a))
  assert_eq(add(add(a, b), c), add(a, add(b, c)))
  
  // ä¹˜æ³•äº¤æ¢å¾‹å’Œç»“åˆå¾‹
  assert_eq(multiply(a, b), multiply(b, a))
  assert_eq(multiply(multiply(a, b), c), multiply(a, multiply(b, c)))
  
  // åˆ†é…å¾‹: a * (b + c) = a * b + a * c
  assert_eq(multiply(a, add(b, c)), add(multiply(a, b), multiply(a, c)))
}

test "enhanced_division_precision" {
  // æµ‹è¯•å‘ä¸Šå–æ•´é™¤æ³•çš„ç²¾åº¦å’Œè¾¹ç•Œæƒ…å†µ
  // æ­£æ•°é™¤æ³•
  assert_eq(4, divide_with_ceil(11, 3))   // 11/3 = 3.666... -> 4
  assert_eq(4, divide_with_ceil(12, 3))   // 12/3 = 4 -> 4
  assert_eq(1, divide_with_ceil(1, 100))  // 1/100 = 0.01 -> 1
  
  // è´Ÿæ•°é™¤æ³•
  assert_eq(-3, divide_with_ceil(-10, 3))  // -10/3 = -3.333... -> -3
  assert_eq(-4, divide_with_ceil(-11, 3))  // -11/3 = -3.666... -> -4
  assert_eq(4, divide_with_ceil(-11, -3))  // -11/-3 = 3.666... -> 4
  
  // é™¤æ•°ä¸ºé›¶çš„å®‰å…¨å¤„ç†
  assert_eq(0, divide_with_ceil(100, 0))
  assert_eq(0, divide_with_ceil(-100, 0))
  assert_eq(0, divide_with_ceil(0, 0))
}

test "enhanced_string_processing" {
  // æµ‹è¯•å­—ç¬¦ä¸²å¤„ç†å’Œ Unicode æ”¯æŒ
  // åŸºæœ¬é—®å€™åŠŸèƒ½
  assert_eq_string("Hello, MoonBit!", greet("MoonBit"))
  assert_eq_string("Hello, !", greet(""))
  
  // Unicode å’Œè¡¨æƒ…ç¬¦å·æ”¯æŒ
  assert_eq_string("Hello, ä¸–ç•Œ!", greet("ä¸–ç•Œ"))
  assert_eq_string("Hello, ğŸš€!", greet("ğŸš€"))
  assert_eq_string("Hello, Î±Î²Î³Î´Îµ!", greet("Î±Î²Î³Î´Îµ"))
  assert_eq_string("Hello, ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦!", greet("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"))
  
  // ç‰¹æ®Šå­—ç¬¦å’Œæ•°å­—ç»„åˆ
  assert_eq_string("Hello, Test123!", greet("Test123"))
  assert_eq_string("Hello, user@example.com!", greet("user@example.com"))
}

test "enhanced_business_calculations" {
  // æµ‹è¯•å®é™…ä¸šåŠ¡è®¡ç®—åœºæ™¯
  // è®¢å•æ€»ä»·è®¡ç®—
  let product_price = 89
  let quantity = 4
  let tax_rate = 8
  let shipping = 15
  let discount = 20
  
  // è®¡ç®—å°è®¡
  let subtotal = multiply(product_price, quantity)
  // è®¡ç®—ç¨è´¹
  let tax = divide_with_ceil(multiply(subtotal, tax_rate), 100)
  // è®¡ç®—æ€»ä»·
  let total_before_discount = add(subtotal, add(tax, shipping))
  let final_total = add(total_before_discount, -discount)
  
  assert_eq(356, subtotal)
  assert_eq(29, tax)
  assert_eq(400, total_before_discount)
  assert_eq(380, final_total)
}

test "enhanced_inventory_management" {
  // æµ‹è¯•åº“å­˜ç®¡ç†åœºæ™¯
  let items_per_box = 24
  let total_items_small = 100
  let total_items_medium = 250
  let total_items_large = 1000
  
  // è®¡ç®—éœ€è¦çš„ç®±å­æ•°é‡
  let boxes_small = divide_with_ceil(total_items_small, items_per_box)
  let boxes_medium = divide_with_ceil(total_items_medium, items_per_box)
  let boxes_large = divide_with_ceil(total_items_large, items_per_box)
  
  // è®¡ç®—æ€»ç®±å­æ•°
  let total_boxes = add(add(boxes_small, boxes_medium), boxes_large)
  
  assert_eq(5, boxes_small)    // ceil(100/24) = 5
  assert_eq(11, boxes_medium)  // ceil(250/24) = 11
  assert_eq(42, boxes_large)   // ceil(1000/24) = 42
  assert_eq(58, total_boxes)   // 5 + 11 + 42 = 58
}

test "enhanced_financial_calculations" {
  // æµ‹è¯•é‡‘èè®¡ç®—åœºæ™¯
  let principal = 10000
  let rate_percent = 5
  
  // è®¡ç®—å¤åˆ©ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼Œä½¿ç”¨å‘ä¸Šå–æ•´ï¼‰
  let year1 = add(principal, divide_with_ceil(multiply(principal, rate_percent), 100))
  let year2 = add(year1, divide_with_ceil(multiply(year1, rate_percent), 100))
  let year3 = add(year2, divide_with_ceil(multiply(year2, rate_percent), 100))
  
  // è®¡ç®—æ€»æ”¶ç›Š
  let total_return = add(year3, -principal)
  
  assert_eq(10500, year1)
  assert_eq(11025, year2)
  assert_eq(11576, year3)
  assert_eq(1576, total_return)
}

test "enhanced_performance_simulation" {
  // æµ‹è¯•æ€§èƒ½æ¨¡æ‹Ÿè®¡ç®—
  let base_operations = 1000
  let optimization_factor = 3
  let overhead_percentage = 15
  
  // è®¡ç®—ä¼˜åŒ–åçš„æ“ä½œæ•°
  let optimized_operations = multiply(base_operations, optimization_factor)
  
  // è®¡ç®—å¼€é”€
  let overhead = divide_with_ceil(multiply(optimized_operations, overhead_percentage), 100)
  
  // è®¡ç®—å®é™…æ€§èƒ½
  let actual_performance = add(optimized_operations, -overhead)
  
  // è®¡ç®—æ€§èƒ½æå‡å€æ•°
  let performance_improvement = divide_with_ceil(actual_performance, base_operations)
  
  assert_eq(3000, optimized_operations)
  assert_eq(450, overhead)
  assert_eq(2550, actual_performance)
  assert_eq(3, performance_improvement)
}

test "enhanced_extreme_boundary_values" {
  // æµ‹è¯•æç«¯è¾¹ç•Œå€¼
  let max_int = 2147483647
  let min_int = -2147483648
  
  // æµ‹è¯•æ¥è¿‘è¾¹ç•Œå€¼çš„è¿ç®—
  assert_eq(2147483646, add(max_int, -1))
  assert_eq(-2147483647, add(min_int, 1))
  assert_eq(0, add(max_int, add(min_int, 1)))
  
  // æµ‹è¯•å¤§æ•°é™¤æ³•çš„ç²¾åº¦
  assert_eq(1, divide_with_ceil(1, max_int))
  assert_eq(1, divide_with_ceil(max_int, max_int))
  assert_eq(2, divide_with_ceil(add(max_int, 1), max_int))
  
  // æµ‹è¯•é›¶çš„å„ç§è¿ç®—
  assert_eq(0, multiply(0, max_int))
  assert_eq(0, multiply(0, min_int))
  assert_eq(0, divide_with_ceil(0, max_int))
  assert_eq(max_int, add(max_int, 0))
  assert_eq(min_int, add(min_int, 0))
}