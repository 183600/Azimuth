// æ ‡å‡† MoonBit æµ‹è¯•å¢žå¼ºç”¨ä¾‹
// ä½¿ç”¨å†…ç½®è¿ç®—ç¬¦å’Œæ ‡å‡† MoonBit æµ‹è¯•è¯­æ³•

test "addition_commutative_property" {
  // æµ‹è¯•åŠ æ³•äº¤æ¢å¾‹
  let a = 15
  let b = 27
  let result1 = a + b
  let result2 = b + a
  if (result1 != result2) {
    @builtin.abort("Addition commutative property test failed")
  }
  
  // æµ‹è¯•è´Ÿæ•°äº¤æ¢å¾‹
  let x = -12
  let y = 8
  let result3 = x + y
  let result4 = y + x
  if (result3 != result4) {
    @builtin.abort("Negative addition commutative property test failed")
  }
}

test "multiplication_distributive_property" {
  // æµ‹è¯•ä¹˜æ³•åˆ†é…å¾‹ a * (b + c) = a * b + a * c
  let a = 4
  let b = 7
  let c = 9
  
  let left_side = a * (b + c)
  let right_side = a * b + a * c
  if (left_side != right_side) {
    @builtin.abort("Multiplication distributive property test failed")
  }
}

test "integer_division_ceil_function" {
  // æµ‹è¯•å‘ä¸Šå–æ•´é™¤æ³•å‡½æ•°
  let divide_with_ceil = fn(a : Int, b : Int) -> Int {
    if b == 0 { 
      0 
    } else {
      let quotient = a / b
      let remainder = a % b
      if remainder == 0 {
        quotient
      } else if a > 0 && b > 0 {
        quotient + 1
      } else if a < 0 && b < 0 {
        quotient + 1
      } else {
        quotient
      }
    }
  }
  
  // æ­£æ•°å°æ•°
  let result1 = divide_with_ceil(3, 2)
  if (result1 != 2) {
    @builtin.abort("Positive division ceil test failed")
  }
  
  let result2 = divide_with_ceil(11, 3)
  if (result2 != 4) {
    @builtin.abort("Positive division ceil test 2 failed")
  }
  
  // è´Ÿæ•°æƒ…å†µ
  let result3 = divide_with_ceil(-3, 2)
  if (result3 != -1) {
    @builtin.abort("Negative division ceil test failed")
  }
  
  // é›¶é™¤æ•°å®‰å…¨å¤„ç†
  let result4 = divide_with_ceil(100, 0)
  if (result4 != 0) {
    @builtin.abort("Zero divisor test failed")
  }
}

test "string_concatenation_and_greeting" {
  // æµ‹è¯•å­—ç¬¦ä¸²è¿žæŽ¥å’Œé—®å€™åŠŸèƒ½
  let greet = fn(name : String) -> String {
    "Hello, " + name + "!"
  }
  
  let result1 = greet("ä¸–ç•Œ")
  if (result1 != "Hello, ä¸–ç•Œ!") {
    @builtin.abort("Unicode greeting test failed")
  }
  
  let result2 = greet("ðŸš€")
  if (result2 != "Hello, ðŸš€!") {
    @builtin.abort("Emoji greeting test failed")
  }
  
  let result3 = greet("CafÃ©")
  if (result3 != "Hello, CafÃ©!") {
    @builtin.abort("Accented character greeting test failed")
  }
  
  let result4 = greet("test@example.com")
  if (result4 != "Hello, test@example.com!") {
    @builtin.abort("Email greeting test failed")
  }
}

test "business_calculation_scenario" {
  // ä¸šåŠ¡è®¡ç®—åœºæ™¯ï¼šè®¢å•æ€»ä»·è®¡ç®—
  let unit_price = 45
  let quantity = 12
  let tax_rate = 8
  let shipping = 25
  let discount = 50
  
  let divide_with_ceil = fn(a : Int, b : Int) -> Int {
    if b == 0 { 
      0 
    } else {
      let quotient = a / b
      let remainder = a % b
      if remainder == 0 {
        quotient
      } else if a > 0 && b > 0 {
        quotient + 1
      } else if a < 0 && b < 0 {
        quotient + 1
      } else {
        quotient
      }
    }
  }
  
  // è®¡ç®—å°è®¡
  let subtotal = unit_price * quantity
  // è®¡ç®—ç¨Žè´¹
  let tax = divide_with_ceil(subtotal * tax_rate, 100)
  // è®¡ç®—æ€»ä»·
  let total_before_discount = subtotal + tax + shipping
  let final_total = total_before_discount - discount
  
  if (subtotal != 540) {
    @builtin.abort("Subtotal calculation failed")
  }
  
  if (tax != 44) {
    @builtin.abort("Tax calculation failed")
  }
  
  if (total_before_discount != 609) {
    @builtin.abort("Total before discount calculation failed")
  }
  
  if (final_total != 559) {
    @builtin.abort("Final total calculation failed")
  }
}

test "mathematical_series_calculation" {
  // æ•°å­¦çº§æ•°è®¡ç®—ï¼šç­‰å·®æ•°åˆ—æ±‚å’Œ
  let first_term = 5
  let common_diff = 3
  let num_terms = 8
  
  let divide_with_ceil = fn(a : Int, b : Int) -> Int {
    if b == 0 { 
      0 
    } else {
      let quotient = a / b
      let remainder = a % b
      if remainder == 0 {
        quotient
      } else if a > 0 && b > 0 {
        quotient + 1
      } else if a < 0 && b < 0 {
        quotient + 1
      } else {
        quotient
      }
    }
  }
  
  // ä½¿ç”¨å…¬å¼æ±‚å’Œï¼šS = n/2 * (2a + (n-1)d)
  let sum = divide_with_ceil(
    num_terms * (2 * first_term + (num_terms - 1) * common_diff),
    2
  )
  
  if (sum != 62) {
    @builtin.abort("Mathematical series calculation failed")
  }
}

test "inventory_management_calculation" {
  // åº“å­˜ç®¡ç†è®¡ç®—ï¼šè®¡ç®—å­˜å‚¨ç©ºé—´éœ€æ±‚
  let items_per_box = 18
  let total_items_a = 75
  let total_items_b = 120
  let total_items_c = 200
  
  let divide_with_ceil = fn(a : Int, b : Int) -> Int {
    if b == 0 { 
      0 
    } else {
      let quotient = a / b
      let remainder = a % b
      if remainder == 0 {
        quotient
      } else if a > 0 && b > 0 {
        quotient + 1
      } else if a < 0 && b < 0 {
        quotient + 1
      } else {
        quotient
      }
    }
  }
  
  let boxes_a = divide_with_ceil(total_items_a, items_per_box)
  let boxes_b = divide_with_ceil(total_items_b, items_per_box)
  let boxes_c = divide_with_ceil(total_items_c, items_per_box)
  
  let total_boxes = boxes_a + boxes_b + boxes_c
  
  if (boxes_a != 5) {
    @builtin.abort("Boxes A calculation failed")
  }
  
  if (boxes_b != 7) {
    @builtin.abort("Boxes B calculation failed")
  }
  
  if (boxes_c != 12) {
    @builtin.abort("Boxes C calculation failed")
  }
  
  if (total_boxes != 24) {
    @builtin.abort("Total boxes calculation failed")
  }
}

test "time_and_resource_calculation" {
  // æ—¶é—´å’Œèµ„æºè®¡ç®—ï¼šé¡¹ç›®å®Œæˆæ—¶é—´ä¼°ç®—
  let tasks_per_day = 6
  let total_tasks = 47
  let working_days_per_week = 5
  
  let divide_with_ceil = fn(a : Int, b : Int) -> Int {
    if b == 0 { 
      0 
    } else {
      let quotient = a / b
      let remainder = a % b
      if remainder == 0 {
        quotient
      } else if a > 0 && b > 0 {
        quotient + 1
      } else if a < 0 && b < 0 {
        quotient + 1
      } else {
        quotient
      }
    }
  }
  
  let days_needed = divide_with_ceil(total_tasks, tasks_per_day)
  let weeks_needed = divide_with_ceil(days_needed, working_days_per_week)
  
  if (days_needed != 8) {
    @builtin.abort("Days needed calculation failed")
  }
  
  if (weeks_needed != 2) {
    @builtin.abort("Weeks needed calculation failed")
  }
}

test "string_processing_with_formal_greeting" {
  // å­—ç¬¦ä¸²å¤„ç†ä¸Žæ­£å¼é—®å€™
  let greet = fn(name : String) -> String {
    "Hello, " + name + "!"
  }
  
  let prefix = "Dr."
  let first_name = "Alice"
  let last_name = "Johnson"
  let suffix = "PhD"
  
  let full_name = prefix + " " + first_name + " " + last_name + ", " + suffix
  let formal_greeting = greet(full_name)
  
  if (formal_greeting != "Hello, Dr. Alice Johnson, PhD!") {
    @builtin.abort("Formal greeting test failed")
  }
}

test "financial_compound_interest" {
  // é‡‘èžå¤åˆ©è®¡ç®—ï¼ˆç®€åŒ–ç‰ˆï¼‰
  let principal = 1000
  let interest_rate = 5  // 5%
  
  let divide_with_ceil = fn(a : Int, b : Int) -> Int {
    if b == 0 { 
      0 
    } else {
      let quotient = a / b
      let remainder = a % b
      if remainder == 0 {
        quotient
      } else if a > 0 && b > 0 {
        quotient + 1
      } else if a < 0 && b < 0 {
        quotient + 1
      } else {
        quotient
      }
    }
  }
  
  // ç¬¬ä¸€å¹´
  let year1 = principal + divide_with_ceil(principal * interest_rate, 100)
  // ç¬¬äºŒå¹´
  let year2 = year1 + divide_with_ceil(year1 * interest_rate, 100)
  // ç¬¬ä¸‰å¹´
  let year3 = year2 + divide_with_ceil(year2 * interest_rate, 100)
  
  if (year1 != 1050) {
    @builtin.abort("Year 1 calculation failed")
  }
  
  if (year2 != 1103) {
    @builtin.abort("Year 2 calculation failed")
  }
  
  if (year3 != 1158) {
    @builtin.abort("Year 3 calculation failed")
  }
}