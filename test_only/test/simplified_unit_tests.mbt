// ç®€åŒ–çš„ç»¼åˆå•å…ƒæµ‹è¯• - 5ä¸ªæµ‹è¯•ç”¨ä¾‹

// å¯¼å…¥å¿…è¦çš„åŒ…
// æ³¨æ„ï¼šç”±äºmoonbitlang/core/arrayä¸å¯ç”¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç®€åŒ–çš„æ–¹æ³•

// ä½¿ç”¨ä» lib.mbt å¯¼å…¥çš„å‡½æ•°

// æµ‹è¯•ç”¨ä¾‹1: æ‰¹é‡æ“ä½œæ€§èƒ½æµ‹è¯•
test "batch_operations_performance" {
  // æ‰¹é‡åŠ æ³•æ“ä½œï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼Œä¸ä½¿ç”¨æ•°ç»„ï¼‰
  let mut sum = 0
  sum = @test_only.add(sum, 1)
  sum = @test_only.add(sum, 2)
  sum = @test_only.add(sum, 3)
  sum = @test_only.add(sum, 4)
  sum = @test_only.add(sum, 5)
  @test_only.assert_eq(15, sum)
  
  // æ‰¹é‡ä¹˜æ³•æ“ä½œï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼Œä¸ä½¿ç”¨æ•°ç»„ï¼‰
  let mut product = 1
  product = @test_only.multiply(product, 1)
  product = @test_only.multiply(product, 2)
  product = @test_only.multiply(product, 3)
  @test_only.assert_eq(6, product)
}

// æµ‹è¯•ç”¨ä¾‹2: æ•°å­¦æ’ç­‰å¼éªŒè¯
test "mathematical_identities" {
  // æµ‹è¯•åˆ†é…å¾‹: a * (b + c) = a * b + a * c
  let a = 7
  let b = 3
  let c = 5
  let left = @test_only.multiply(a, @test_only.add(b, c))
  let right = @test_only.add(@test_only.multiply(a, b), @test_only.multiply(a, c))
  @test_only.assert_eq(left, right)
  
  // æµ‹è¯•é›¶å…ƒç´ æ€§è´¨: a + 0 = a, a * 0 = 0
  @test_only.assert_eq(42, @test_only.add(42, 0))
  @test_only.assert_eq(0, @test_only.multiply(42, 0))
  
  // æµ‹è¯•å•ä½å…ƒç´ æ€§è´¨: a * 1 = a
  @test_only.assert_eq(42, @test_only.multiply(42, 1))
}

// æµ‹è¯•ç”¨ä¾‹3: ç‰¹æ®Šè¾¹ç•Œç»„åˆæµ‹è¯•
test "special_boundary_combinations" {
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•æœ€å¤§å€¼ä¸-1çš„è¿ç®—
  @test_only.assert_eq(2147483646, @test_only.add(max_val, -1))
  @test_only.assert_eq(-2147483648, @test_only.multiply(max_val, -1))
  
  // æµ‹è¯•æœ€å°å€¼ä¸1çš„è¿ç®—
  @test_only.assert_eq(-2147483647, @test_only.add(min_val, 1))
  @test_only.assert_eq(-2147483648, @test_only.multiply(min_val, 1))
  
  // æµ‹è¯•æœ€å¤§å€¼ä¸æœ€å°å€¼çš„ä¹˜æ³•
  @test_only.assert_eq(-2147483648, @test_only.multiply(max_val, min_val))
}

// æµ‹è¯•ç”¨ä¾‹4: æ•°å­¦æ€§è´¨éªŒè¯æµ‹è¯•
test "mathematical_properties_verification" {
  // éªŒè¯äº¤æ¢å¾‹ï¼ˆåœ¨éæº¢å‡ºæƒ…å†µä¸‹ï¼‰
  @test_only.assert_eq(@test_only.add(5, 3), @test_only.add(3, 5))
  @test_only.assert_eq(@test_only.multiply(4, 7), @test_only.multiply(7, 4))
  @test_only.assert_eq(@test_only.add(-2, 8), @test_only.add(8, -2))
  @test_only.assert_eq(@test_only.multiply(-3, 6), @test_only.multiply(6, -3))
  
  // éªŒè¯ç»“åˆå¾‹ï¼ˆåœ¨éæº¢å‡ºæƒ…å†µä¸‹ï¼‰
  @test_only.assert_eq(@test_only.add(@test_only.add(1, 2), 3), @test_only.add(1, @test_only.add(2, 3)))
  @test_only.assert_eq(@test_only.multiply(@test_only.multiply(2, 3), 4), @test_only.multiply(2, @test_only.multiply(3, 4)))
  
  // éªŒè¯åˆ†é…å¾‹ï¼ˆåœ¨éæº¢å‡ºæƒ…å†µä¸‹ï¼‰
  let a = 5
  let b = 3
  let c = 2
  @test_only.assert_eq(@test_only.multiply(a, @test_only.add(b, c)), @test_only.add(@test_only.multiply(a, b), @test_only.multiply(a, c)))
}

// æµ‹è¯•ç”¨ä¾‹5: å®é™…ä¸šåŠ¡åœºæ™¯æµ‹è¯•
test "real_business_scenarios" {
  // åœºæ™¯1: é“¶è¡Œè´¦æˆ·ä½™é¢è®¡ç®—
  let initial_balance = 1000
  let deposit1 = 500
  let deposit2 = 300
  let withdrawal1 = 200
  let withdrawal2 = 150
  
  let final_balance = @test_only.add(
    @test_only.add(
      @test_only.add(initial_balance, deposit1), 
      deposit2
    ),
    @test_only.add(-withdrawal1, -withdrawal2)
  )
  @test_only.assert_eq(1450, final_balance)  // 1000+500+300-200-150 = 1450
  
  // åœºæ™¯2: åº“å­˜ç®¡ç†
  let initial_stock = 100
  let shipments_received = 3
  let items_per_shipment = 25
  let items_sold = 57
  
  let mut current_stock = @test_only.add(
    initial_stock,
    @test_only.multiply(shipments_received, items_per_shipment)
  )
  current_stock = @test_only.add(current_stock, -items_sold)
  @test_only.assert_eq(118, current_stock)  // 100 + 3*25 - 57 = 118
}

// æ–°å¢çš„æµ‹è¯•ç”¨ä¾‹
test "arithmetics_add_boundary_values" {
  // æµ‹è¯•åŠ æ³•è¾¹ç•Œå€¼
  let max_val = 2147483647
  let min_val = -2147483648
  @test_only.assert_eq(@test_only.add(max_val, 0), max_val)
  @test_only.assert_eq(@test_only.add(min_val, 0), min_val)
  @test_only.assert_eq(@test_only.add(max_val, -max_val), 0)
}

test "arithmetics_multiply_edge_cases" {
  // æµ‹è¯•ä¹˜æ³•è¾¹ç•Œæƒ…å†µ
  @test_only.assert_eq(@test_only.multiply(-2147483648, 0), 0)
  @test_only.assert_eq(@test_only.multiply(2147483647, 1), 2147483647)
  @test_only.assert_eq(@test_only.multiply(-2147483648, 1), -2147483648)
}

test "string_greet_unicode_characters" {
  // æµ‹è¯•åŒ…å«Unicodeå­—ç¬¦çš„å­—ç¬¦ä¸²å¤„ç†
  @test_only.assert_eq_string(@test_only.greet("ä¸–ç•Œ"), "Hello, ä¸–ç•Œ!")
  @test_only.assert_eq_string(@test_only.greet("ğŸŒŸ"), "Hello, ğŸŒŸ!")
  @test_only.assert_eq_string(@test_only.greet("CafÃ©"), "Hello, CafÃ©!")
}