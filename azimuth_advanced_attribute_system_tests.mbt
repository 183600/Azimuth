// Azimuth Advanced Attribute System Test Suite
// é«˜çº§å±æ€§ç³»ç»Ÿæµ‹è¯•ç”¨ä¾‹ï¼Œä¸“æ³¨äºå¤æ‚å±æ€§å€¼å¤„ç†ã€è½¬æ¢å’Œè¾¹ç•Œæ¡ä»¶

test "å¤æ‚åµŒå¥—å±æ€§å€¼çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–" {
  // åˆ›å»ºåŒ…å«ä¸åŒç±»å‹å€¼çš„å±æ€§é›†åˆ
  let string_attr = azimuth::StringValue("å¤æ‚å­—ç¬¦ä¸²å€¼-åŒ…å«ç‰¹æ®Šå­—ç¬¦: !@#$%^&*()")
  let int_attr = azimuth::IntValue(2147483647)  // Int32 æœ€å¤§å€¼
  let float_attr = azimuth::FloatValue(3.141592653589793)
  let bool_attr = azimuth::BoolValue(true)
  let array_string_attr = azimuth::ArrayStringValue(["å…ƒç´ 1", "element2", "ğŸš€ emojiæµ‹è¯•", ""])
  let array_int_attr = azimuth::ArrayIntValue([0, -1, 2147483647, -2147483648])
  
  // éªŒè¯å­—ç¬¦ä¸²å±æ€§
  match string_attr {
    StringValue(v) => {
      assert_eq(v.length(), 35)
      assert_true(v.contains("ç‰¹æ®Šå­—ç¬¦"))
      assert_true(v.contains("emoji"))
    }
    _ => assert_true(false)
  }
  
  // éªŒè¯æ•´æ•°å±æ€§
  match int_attr {
    IntValue(v) => {
      assert_eq(v, 2147483647)
      assert_true(v > 0)
    }
    _ => assert_true(false)
  }
  
  // éªŒè¯æµ®ç‚¹æ•°å±æ€§ç²¾åº¦
  match float_attr {
    FloatValue(v) => {
      assert_true(v > 3.14 && v < 3.15)
      assert_true(v > 0.0)
    }
    _ => assert_true(false)
  }
  
  // éªŒè¯å¸ƒå°”å±æ€§
  match bool_attr {
    BoolValue(v) => assert_true(v)
    _ => assert_true(false)
  }
  
  // éªŒè¯å­—ç¬¦ä¸²æ•°ç»„å±æ€§
  match array_string_attr {
    ArrayStringValue(v) => {
      assert_eq(v.length(), 4)
      assert_eq(v[0], "å…ƒç´ 1")
      assert_eq(v[1], "element2")
      assert_eq(v[2], "ğŸš€ emojiæµ‹è¯•")
      assert_eq(v[3], "")
      assert_true(v[2].contains("emoji"))
    }
    _ => assert_true(false)
  }
  
  // éªŒè¯æ•´æ•°æ•°ç»„å±æ€§è¾¹ç•Œå€¼
  match array_int_attr {
    ArrayIntValue(v) => {
      assert_eq(v.length(), 4)
      assert_eq(v[0], 0)
      assert_eq(v[1], -1)
      assert_eq(v[2], 2147483647)  // Int32 æœ€å¤§å€¼
      assert_eq(v[3], -2147483648) // Int32 æœ€å°å€¼
    }
    _ => assert_true(false)
  }
}

test "å±æ€§ç±»å‹è½¬æ¢å’Œå…¼å®¹æ€§æµ‹è¯•" {
  // æµ‹è¯•å±æ€§å€¼çš„ç±»å‹è½¬æ¢é€»è¾‘
  let string_number = StringValue("123")
  let string_float = StringValue("3.14")
  let string_bool = StringValue("true")
  let empty_string = StringValue("")
  
  // éªŒè¯å­—ç¬¦ä¸²æ•°å­—çš„æ½œåœ¨è½¬æ¢
  match string_number {
    StringValue(v) => {
      assert_eq(v, "123")
      assert_true(v.to_int() > 0)
    }
    _ => assert_true(false)
  }
  
  // éªŒè¯å­—ç¬¦ä¸²æµ®ç‚¹æ•°çš„æ½œåœ¨è½¬æ¢
  match string_float {
    StringValue(v) => {
      assert_eq(v, "3.14")
      assert_true(v.contains("."))
    }
    _ => assert_true(false)
  }
  
  // éªŒè¯å­—ç¬¦ä¸²å¸ƒå°”å€¼çš„æ½œåœ¨è½¬æ¢
  match string_bool {
    StringValue(v) => {
      assert_eq(v, "true")
      assert_true(v.to_lowercase() == "true")
    }
    _ => assert_true(false)
  }
  
  // éªŒè¯ç©ºå­—ç¬¦ä¸²å¤„ç†
  match empty_string {
    StringValue(v) => {
      assert_eq(v.length(), 0)
      assert_eq(v, "")
    }
    _ => assert_true(false)
  }
}

test "å±æ€§é›†åˆçš„æ‰¹é‡æ“ä½œå’Œæ€§èƒ½æµ‹è¯•" {
  // åˆ›å»ºå¤§å‹å±æ€§é›†åˆç”¨äºæ€§èƒ½æµ‹è¯•
  let large_string_array = ArrayStringValue([
    "å±æ€§1", "å±æ€§2", "å±æ€§3", "å±æ€§4", "å±æ€§5",
    "å±æ€§6", "å±æ€§7", "å±æ€§8", "å±æ€§9", "å±æ€§10",
    "å±æ€§11", "å±æ€§12", "å±æ€§13", "å±æ€§14", "å±æ€§15",
    "å±æ€§16", "å±æ€§17", "å±æ€§18", "å±æ€§19", "å±æ€§20"
  ])
  
  let large_int_array = ArrayIntValue([
    1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
    11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
    -1, -2, -3, -4, -5, -6, -7, -8, -9, -10
  ])
  
  // éªŒè¯å¤§å‹å­—ç¬¦ä¸²æ•°ç»„
  match large_string_array {
    ArrayStringValue(v) => {
      assert_eq(v.length(), 20)
      assert_eq(v[0], "å±æ€§1")
      assert_eq(v[19], "å±æ€§20")
      assert_eq(v[10], "å±æ€§11")
      
      // éªŒè¯æ‰€æœ‰å…ƒç´ éƒ½åŒ…å«"å±æ€§"
      for item in v {
        assert_true(item.contains("å±æ€§"))
      }
    }
    _ => assert_true(false)
  }
  
  // éªŒè¯å¤§å‹æ•´æ•°æ•°ç»„
  match large_int_array {
    ArrayIntValue(v) => {
      assert_eq(v.length(), 30)
      assert_eq(v[0], 1)
      assert_eq(v[9], 10)
      assert_eq(v[10], 11)
      assert_eq(v[19], 20)
      assert_eq(v[20], -1)
      assert_eq(v[29], -10)
      
      // éªŒè¯æ­£æ•°å’Œè´Ÿæ•°çš„åˆ†å¸ƒ
      let positive_count = v.filter(fn(x) { x > 0 }).length()
      let negative_count = v.filter(fn(x) { x < 0 }).length()
      assert_eq(positive_count, 20)
      assert_eq(negative_count, 10)
    }
    _ => assert_true(false)
  }
}

test "å±æ€§è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µå¤„ç†" {
  // æµ‹è¯•è¾¹ç•Œå€¼å’Œå¼‚å¸¸æƒ…å†µ
  
  // æµ‹è¯•æé•¿å­—ç¬¦ä¸²
  let very_long_string = StringValue("è¿™æ˜¯ä¸€ä¸ªéå¸¸é•¿çš„å­—ç¬¦ä¸²ï¼Œç”¨äºæµ‹è¯•å±æ€§ç³»ç»Ÿå¯¹é•¿æ–‡æœ¬çš„å¤„ç†èƒ½åŠ›ã€‚" + 
    "é‡å¤å†…å®¹ï¼šæµ‹è¯•é•¿å­—ç¬¦ä¸²å¤„ç†ã€‚é‡å¤å†…å®¹ï¼šæµ‹è¯•é•¿å­—ç¬¦ä¸²å¤„ç†ã€‚" +
    "é‡å¤å†…å®¹ï¼šæµ‹è¯•é•¿å­—ç¬¦ä¸²å¤„ç†ã€‚é‡å¤å†…å®¹ï¼šæµ‹è¯•é•¿å­—ç¬¦ä¸²å¤„ç†ã€‚" +
    "é‡å¤å†…å®¹ï¼šæµ‹è¯•é•¿å­—ç¬¦ä¸²å¤„ç†ã€‚é‡å¤å†…å®¹ï¼šæµ‹è¯•é•¿å­—ç¬¦ä¸²å¤„ç†ã€‚")
  
  match very_long_string {
    StringValue(v) => {
      assert_true(v.length() > 100)
      assert_true(v.contains("é•¿å­—ç¬¦ä¸²"))
      assert_eq(v occurrences "æµ‹è¯•é•¿å­—ç¬¦ä¸²å¤„ç†", 6)
    }
    _ => assert_true(false)
  }
  
  // æµ‹è¯•ç‰¹æ®Šå­—ç¬¦å’ŒUnicode
  let special_chars = StringValue("ç‰¹æ®Šå­—ç¬¦æµ‹è¯•: \n\t\r\\\"'<>[]{}|\\~`!@#$%^&*()_+-=;:,.?/ğŸ‰ğŸŒŸğŸ’¡ğŸ”¥")
  match special_chars {
    StringValue(v) => {
      assert_true(v.contains("\n"))
      assert_true(v.contains("\t"))
      assert_true(v.contains("ğŸ‰"))
      assert_true(v.contains("ğŸŒŸ"))
      assert_true(v.contains("ğŸ’¡"))
      assert_true(v.contains("ğŸ”¥"))
    }
    _ => assert_true(false)
  }
  
  // æµ‹è¯•ç©ºæ•°ç»„
  let empty_string_array = ArrayStringValue([])
  let empty_int_array = ArrayIntValue([])
  
  match empty_string_array {
    ArrayStringValue(v) => assert_eq(v.length(), 0)
    _ => assert_true(false)
  }
  
  match empty_int_array {
    ArrayIntValue(v) => assert_eq(v.length(), 0)
    _ => assert_true(false)
  }
  
  // æµ‹è¯•å•å…ƒç´ æ•°ç»„
  let single_string_array = ArrayStringValue(["å•å…ƒç´ "])
  let single_int_array = ArrayIntValue([42])
  
  match single_string_array {
    ArrayStringValue(v) => {
      assert_eq(v.length(), 1)
      assert_eq(v[0], "å•å…ƒç´ ")
    }
    _ => assert_true(false)
  }
  
  match single_int_array {
    ArrayIntValue(v) => {
      assert_eq(v.length(), 1)
      assert_eq(v[0], 42)
    }
    _ => assert_true(false)
  }
}

test "å±æ€§å€¼çš„å†…å­˜æ•ˆç‡å’Œæ—¶é—´å¤æ‚åº¦éªŒè¯" {
  // åˆ›å»ºå¤§é‡å±æ€§å€¼è¿›è¡Œæ•ˆç‡æµ‹è¯•
  let string_values = [
    StringValue("æµ‹è¯•å­—ç¬¦ä¸²1"), StringValue("æµ‹è¯•å­—ç¬¦ä¸²2"), StringValue("æµ‹è¯•å­—ç¬¦ä¸²3"),
    StringValue("æµ‹è¯•å­—ç¬¦ä¸²4"), StringValue("æµ‹è¯•å­—ç¬¦ä¸²5"), StringValue("æµ‹è¯•å­—ç¬¦ä¸²6"),
    StringValue("æµ‹è¯•å­—ç¬¦ä¸²7"), StringValue("æµ‹è¯•å­—ç¬¦ä¸²8"), StringValue("æµ‹è¯•å­—ç¬¦ä¸²9"), StringValue("æµ‹è¯•å­—ç¬¦ä¸²10")
  ]
  
  let int_values = [
    IntValue(1), IntValue(2), IntValue(3), IntValue(4), IntValue(5),
    IntValue(6), IntValue(7), IntValue(8), IntValue(9), IntValue(10)
  ]
  
  let float_values = [
    FloatValue(1.1), FloatValue(2.2), FloatValue(3.3), FloatValue(4.4), FloatValue(5.5),
    FloatValue(6.6), FloatValue(7.7), FloatValue(8.8), FloatValue(9.9), FloatValue(10.0)
  ]
  
  let bool_values = [
    BoolValue(true), BoolValue(false), BoolValue(true), BoolValue(false), BoolValue(true),
    BoolValue(false), BoolValue(true), BoolValue(false), BoolValue(true), BoolValue(false)
  ]
  
  // éªŒè¯æ‰€æœ‰å­—ç¬¦ä¸²å€¼
  for (i, value) in string_values.enumerate() {
    match value {
      StringValue(v) => {
        let expected = "æµ‹è¯•å­—ç¬¦ä¸²" + (i + 1).to_string()
        assert_eq(v, expected)
      }
      _ => assert_true(false)
    }
  }
  
  // éªŒè¯æ‰€æœ‰æ•´æ•°å€¼
  for (i, value) in int_values.enumerate() {
    match value {
      IntValue(v) => assert_eq(v, i + 1)
      _ => assert_true(false)
    }
  }
  
  // éªŒè¯æ‰€æœ‰æµ®ç‚¹æ•°å€¼
  for (i, value) in float_values.enumerate() {
    match value {
      FloatValue(v) => assert_true(v > 0.0 && v <= 10.0)
      _ => assert_true(false)
    }
  }
  
  // éªŒè¯æ‰€æœ‰å¸ƒå°”å€¼
  for (i, value) in bool_values.enumerate() {
    match value {
      BoolValue(v) => assert_eq(v, i % 2 == 0)
      _ => assert_true(false)
    }
  }
  
  // éªŒè¯æ•°ç»„é•¿åº¦
  assert_eq(string_values.length(), 10)
  assert_eq(int_values.length(), 10)
  assert_eq(float_values.length(), 10)
  assert_eq(bool_values.length(), 10)
}