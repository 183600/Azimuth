// Azimuth Premium Internationalization Tests
// é«˜è´¨é‡å›½é™…åŒ–å’Œæœ¬åœ°åŒ–æµ‹è¯•ç”¨ä¾‹
// ä¸“æ³¨äºæµ‹è¯•é¥æµ‹ç³»ç»Ÿåœ¨ä¸åŒè¯­è¨€ã€åœ°åŒºå’Œæ–‡åŒ–ç¯å¢ƒä¸‹çš„å…¼å®¹æ€§å’Œæ­£ç¡®æ€§

// æµ‹è¯•1: å¤šè¯­è¨€å­—ç¬¦ä¸²å¤„ç†
test "å¤šè¯­è¨€å­—ç¬¦ä¸²å¤„ç†æµ‹è¯•" {
  // 1. æµ‹è¯•ä¸­æ–‡å­—ç¬¦ä¸²å¤„ç†
  let chinese_attr = AttributeValue::StringValue("é¥æµ‹æ•°æ®å¤„ç†ç³»ç»Ÿ")
  match chinese_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "é¥æµ‹æ•°æ®å¤„ç†ç³»ç»Ÿ")
      assert_eq(s.length(), 6)
      assert_true(s.contains("é¥æµ‹"))
      assert_true(s.contains("ç³»ç»Ÿ"))
    }
    _ => assert_true(false, "ä¸­æ–‡å­—ç¬¦ä¸²ç±»å‹è½¬æ¢å¤±è´¥")
  }
  
  // 2. æµ‹è¯•æ—¥æ–‡å­—ç¬¦ä¸²å¤„ç†
  let japanese_attr = AttributeValue::StringValue("ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ")
  match japanese_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ")
      assert_eq(s.length(), 12)
      assert_true(s.contains("ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª"))
      assert_true(s.contains("ã‚·ã‚¹ãƒ†ãƒ "))
    }
    _ => assert_true(false, "æ—¥æ–‡å­—ç¬¦ä¸²ç±»å‹è½¬æ¢å¤±è´¥")
  }
  
  // 3. æµ‹è¯•éŸ©æ–‡å­—ç¬¦ä¸²å¤„ç†
  let korean_attr = AttributeValue::StringValue("ì›ê²© ì¸¡ì • ë°ì´í„° ì²˜ë¦¬ ì‹œìŠ¤í…œ")
  match korean_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "ì›ê²© ì¸¡ì • ë°ì´í„° ì²˜ë¦¬ ì‹œìŠ¤í…œ")
      assert_eq(s.length(), 12)
      assert_true(s.contains("ì›ê²©"))
      assert_true(s.contains("ì‹œìŠ¤í…œ"))
    }
    _ => assert_true(false, "éŸ©æ–‡å­—ç¬¦ä¸²ç±»å‹è½¬æ¢å¤±è´¥")
  }
  
  // 4. æµ‹è¯•é˜¿æ‹‰ä¼¯æ–‡å­—ç¬¦ä¸²å¤„ç†
  let arabic_attr = AttributeValue::StringValue("Ù†Ø¸Ø§Ù… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚ÙŠØ§Ø³ Ø¹Ù† Ø¨Ø¹Ø¯")
  match arabic_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "Ù†Ø¸Ø§Ù… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚ÙŠØ§Ø³ Ø¹Ù† Ø¨Ø¹Ø¯")
      assert_eq(s.length(), 26)
      assert_true(s.contains("Ù†Ø¸Ø§Ù…"))
      assert_true(s.contains("Ù…Ø¹Ø§Ù„Ø¬Ø©"))
    }
    _ => assert_true(false, "é˜¿æ‹‰ä¼¯æ–‡å­—ç¬¦ä¸²ç±»å‹è½¬æ¢å¤±è´¥")
  }
  
  // 5. æµ‹è¯•ä¿„æ–‡å­—ç¬¦ä¸²å¤„ç†
  let russian_attr = AttributeValue::StringValue("Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…")
  match russian_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…")
      assert_eq(s.length(), 36)
      assert_true(s.contains("Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ°"))
      assert_true(s.contains("Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸"))
    }
    _ => assert_true(false, "ä¿„æ–‡å­—ç¬¦ä¸²ç±»å‹è½¬æ¢å¤±è´¥")
  }
  
  // 6. æµ‹è¯•æ··åˆè¯­è¨€å­—ç¬¦ä¸²å¤„ç†
  let mixed_attr = AttributeValue::StringValue("é¥æµ‹ç³»ç»Ÿ Telemetry System ØªÙŠÙ„ÙŠÙ…ØªØ±ÙŠ Ù†Ø¸Ø§Ù…")
  match mixed_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "é¥æµ‹ç³»ç»Ÿ Telemetry System ØªÙŠÙ„ÙŠÙ…ØªØ±ÙŠ Ù†Ø¸Ø§Ù…")
      assert_eq(s.length(), 23)
      assert_true(s.contains("é¥æµ‹ç³»ç»Ÿ"))
      assert_true(s.contains("Telemetry"))
      assert_true(s.contains("ØªÙŠÙ„ÙŠÙ…ØªØ±ÙŠ"))
    }
    _ => assert_true(false, "æ··åˆè¯­è¨€å­—ç¬¦ä¸²ç±»å‹è½¬æ¢å¤±è´¥")
  }
  
  // 7. æµ‹è¯•åŒ…å«è¡¨æƒ…ç¬¦å·çš„å­—ç¬¦ä¸²å¤„ç†
  let emoji_attr = AttributeValue::StringValue("é¥æµ‹ç³»ç»Ÿ ğŸŒŸğŸ“ŠğŸ”„ æ•°æ®å¤„ç†")
  match emoji_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "é¥æµ‹ç³»ç»Ÿ ğŸŒŸğŸ“ŠğŸ”„ æ•°æ®å¤„ç†")
      assert_eq(s.length(), 11)
      assert_true(s.contains("ğŸŒŸ"))
      assert_true(s.contains("ğŸ“Š"))
      assert_true(s.contains("ğŸ”„"))
    }
    _ => assert_true(false, "è¡¨æƒ…ç¬¦å·å­—ç¬¦ä¸²ç±»å‹è½¬æ¢å¤±è´¥")
  }
}

// æµ‹è¯•2: å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„Baggageå¤„ç†
test "å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„Baggageå¤„ç†æµ‹è¯•" {
  // 1. åˆ›å»ºåŒ…å«å¤šè¯­è¨€é”®å€¼å¯¹çš„Baggage
  let multilingual_baggage = Baggage({
    entries: [
      ("ç”¨æˆ·.id", "user123"),
      ("user.id", "user123"),
      ("ãƒ¦ãƒ¼ã‚¶ãƒ¼.id", "user123"),
      ("ì‚¬ìš©ì.id", "user123"),
      ("Ù…Ø¹Ø±Ù.Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", "user123"),
      ("Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€.Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", "user123"),
      ("æ“ä½œ.åç§°", "æ•°æ®å¤„ç†"),
      ("operation.name", "data_processing"),
      ("æ“ä½œå", "ãƒ‡ãƒ¼ã‚¿å‡¦ç†"),
      ("ì‘ì—….ì´ë¦„", "ë°ì´í„° ì²˜ë¦¬"),
      ("Ø§Ø³Ù….Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", "Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"),
      ("Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ.Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸", "Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…")
    ]
  })
  
  // 2. éªŒè¯å¤šè¯­è¨€Baggageæ¡ç›®æ•°é‡
  assert_eq(multilingual_baggage.entries.length(), 12)
  
  // 3. éªŒè¯ä¸­æ–‡é”®å€¼å¯¹
  let mut chinese_user_found = false
  let mut chinese_operation_found = false
  
  for (key, value) in multilingual_baggage.entries {
    match key {
      "ç”¨æˆ·.id" => {
        assert_eq(value, "user123")
        chinese_user_found = true
      }
      "æ“ä½œ.åç§°" => {
        assert_eq(value, "æ•°æ®å¤„ç†")
        chinese_operation_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(chinese_user_found, "ä¸­æ–‡ç”¨æˆ·IDé”®åº”è¯¥å­˜åœ¨")
  assert_true(chinese_operation_found, "ä¸­æ–‡æ“ä½œåç§°é”®åº”è¯¥å­˜åœ¨")
  
  // 4. éªŒè¯æ—¥æ–‡é”®å€¼å¯¹
  let mut japanese_user_found = false
  let mut japanese_operation_found = false
  
  for (key, value) in multilingual_baggage.entries {
    match key {
      "ãƒ¦ãƒ¼ã‚¶ãƒ¼.id" => {
        assert_eq(value, "user123")
        japanese_user_found = true
      }
      "æ“ä½œå" => {
        assert_eq(value, "ãƒ‡ãƒ¼ã‚¿å‡¦ç†")
        japanese_operation_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(japanese_user_found, "æ—¥æ–‡ç”¨æˆ·IDé”®åº”è¯¥å­˜åœ¨")
  assert_true(japanese_operation_found, "æ—¥æ–‡æ“ä½œåç§°é”®åº”è¯¥å­˜åœ¨")
  
  // 5. éªŒè¯éŸ©æ–‡é”®å€¼å¯¹
  let mut korean_user_found = false
  let mut korean_operation_found = false
  
  for (key, value) in multilingual_baggage.entries {
    match key {
      "ì‚¬ìš©ì.id" => {
        assert_eq(value, "user123")
        korean_user_found = true
      }
      "ì‘ì—….ì´ë¦„" => {
        assert_eq(value, "ë°ì´í„° ì²˜ë¦¬")
        korean_operation_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(korean_user_found, "éŸ©æ–‡ç”¨æˆ·IDé”®åº”è¯¥å­˜åœ¨")
  assert_true(korean_operation_found, "éŸ©æ–‡æ“ä½œåç§°é”®åº”è¯¥å­˜åœ¨")
  
  // 6. éªŒè¯é˜¿æ‹‰ä¼¯æ–‡é”®å€¼å¯¹
  let mut arabic_user_found = false
  let mut arabic_operation_found = false
  
  for (key, value) in multilingual_baggage.entries {
    match key {
      "Ù…Ø¹Ø±Ù.Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" => {
        assert_eq(value, "user123")
        arabic_user_found = true
      }
      "Ø§Ø³Ù….Ø§Ù„Ø¹Ù…Ù„ÙŠØ©" => {
        assert_eq(value, "Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
        arabic_operation_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(arabic_user_found, "é˜¿æ‹‰ä¼¯æ–‡ç”¨æˆ·IDé”®åº”è¯¥å­˜åœ¨")
  assert_true(arabic_operation_found, "é˜¿æ‹‰ä¼¯æ–‡æ“ä½œåç§°é”®åº”è¯¥å­˜åœ¨")
  
  // 7. éªŒè¯ä¿„æ–‡é”®å€¼å¯¹
  let mut russian_user_found = false
  let mut russian_operation_found = false
  
  for (key, value) in multilingual_baggage.entries {
    match key {
      "Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€.Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ" => {
        assert_eq(value, "user123")
        russian_user_found = true
      }
      "Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ.Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸" => {
        assert_eq(value, "Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…")
        russian_operation_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(russian_user_found, "ä¿„æ–‡ç”¨æˆ·IDé”®åº”è¯¥å­˜åœ¨")
  assert_true(russian_operation_found, "ä¿„æ–‡æ“ä½œåç§°é”®åº”è¯¥å­˜åœ¨")
}

// æµ‹è¯•3: å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„TextMapCarrierå¤„ç†
test "å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„TextMapCarrierå¤„ç†æµ‹è¯•" {
  // 1. åˆ›å»ºåŒ…å«å¤šè¯­è¨€headerçš„TextMapCarrier
  let multilingual_carrier = TextMapCarrier({
    headers: [
      ("traceparent", "00-12345678901234567890123456789012-1234567890123456-01"),
      ("tracestate", "æœåŠ¡=é¥æµ‹ç³»ç»Ÿ,æ“ä½œ=æ•°æ®å¤„ç†"),
      ("baggage", "ç”¨æˆ·.å§“å=å¼ ä¸‰,æ“ä½œ.ç±»å‹=æ•°æ®æ”¶é›†"),
      ("x-è¯·æ±‚-id", "req-123456"),
      ("x-request-id", "req-123456"),
      ("x-ãƒªã‚¯ã‚¨ã‚¹ãƒˆ-id", "req-123456"),
      ("x-ìš”ì²­-id", "req-123456"),
      ("x-Ù…Ø¹Ø±Ù-Ø§Ù„Ø·Ù„Ø¨", "req-123456"),
      ("x-Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€-Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°", "req-123456"),
      ("ç”¨æˆ·-ä»£ç†", "é¥æµ‹å®¢æˆ·ç«¯/1.0"),
      ("user-agent", "telemetry-client/1.0"),
      ("ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ", "ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ/1.0"),
      ("ì‚¬ìš©ì-ì—ì´ì „íŠ¸", "ì›ê²© ì¸¡ì • í´ë¼ì´ì–¸íŠ¸/1.0"),
      ("ÙˆÙƒÙŠÙ„-Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", "Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙŠØ§Ø³ Ø¹Ù† Ø¨Ø¹Ø¯/1.0"),
      ("Ğ°Ğ³ĞµĞ½Ñ‚-Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", "ĞºĞ»Ğ¸ĞµĞ½Ñ‚ Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸/1.0")
    ]
  })
  
  // 2. éªŒè¯å¤šè¯­è¨€TextMapCarrieræ¡ç›®æ•°é‡
  assert_eq(multilingual_carrier.headers.length(), 14)
  
  // 3. éªŒè¯ä¸­æ–‡header
  let mut chinese_request_id_found = false
  let mut chinese_user_agent_found = false
  
  for (key, value) in multilingual_carrier.headers {
    match key {
      "x-è¯·æ±‚-id" => {
        assert_eq(value, "req-123456")
        chinese_request_id_found = true
      }
      "ç”¨æˆ·-ä»£ç†" => {
        assert_eq(value, "é¥æµ‹å®¢æˆ·ç«¯/1.0")
        chinese_user_agent_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(chinese_request_id_found, "ä¸­æ–‡è¯·æ±‚ID headeråº”è¯¥å­˜åœ¨")
  assert_true(chinese_user_agent_found, "ä¸­æ–‡ç”¨æˆ·ä»£ç†headeråº”è¯¥å­˜åœ¨")
  
  // 4. éªŒè¯æ—¥æ–‡header
  let mut japanese_request_id_found = false
  let mut japanese_user_agent_found = false
  
  for (key, value) in multilingual_carrier.headers {
    match key {
      "x-ãƒªã‚¯ã‚¨ã‚¹ãƒˆ-id" => {
        assert_eq(value, "req-123456")
        japanese_request_id_found = true
      }
      "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ" => {
        assert_eq(value, "ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ/1.0")
        japanese_user_agent_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(japanese_request_id_found, "æ—¥æ–‡è¯·æ±‚ID headeråº”è¯¥å­˜åœ¨")
  assert_true(japanese_user_agent_found, "æ—¥æ–‡ç”¨æˆ·ä»£ç†headeråº”è¯¥å­˜åœ¨")
  
  // 5. éªŒè¯éŸ©æ–‡header
  let mut korean_request_id_found = false
  let mut korean_user_agent_found = false
  
  for (key, value) in multilingual_carrier.headers {
    match key {
      "x-ìš”ì²­-id" => {
        assert_eq(value, "req-123456")
        korean_request_id_found = true
      }
      "ì‚¬ìš©ì-ì—ì´ì „íŠ¸" => {
        assert_eq(value, "ì›ê²© ì¸¡ì • í´ë¼ì´ì–¸íŠ¸/1.0")
        korean_user_agent_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(korean_request_id_found, "éŸ©æ–‡è¯·æ±‚ID headeråº”è¯¥å­˜åœ¨")
  assert_true(korean_user_agent_found, "éŸ©æ–‡ç”¨æˆ·ä»£ç†headeråº”è¯¥å­˜åœ¨")
  
  // 6. éªŒè¯é˜¿æ‹‰ä¼¯æ–‡header
  let mut arabic_request_id_found = false
  let mut arabic_user_agent_found = false
  
  for (key, value) in multilingual_carrier.headers {
    match key {
      "x-Ù…Ø¹Ø±Ù-Ø§Ù„Ø·Ù„Ø¨" => {
        assert_eq(value, "req-123456")
        arabic_request_id_found = true
      }
      "ÙˆÙƒÙŠÙ„-Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" => {
        assert_eq(value, "Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙŠØ§Ø³ Ø¹Ù† Ø¨Ø¹Ø¯/1.0")
        arabic_user_agent_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(arabic_request_id_found, "é˜¿æ‹‰ä¼¯æ–‡è¯·æ±‚ID headeråº”è¯¥å­˜åœ¨")
  assert_true(arabic_user_agent_found, "é˜¿æ‹‰ä¼¯æ–‡ç”¨æˆ·ä»£ç†headeråº”è¯¥å­˜åœ¨")
  
  // 7. éªŒè¯ä¿„æ–‡header
  let mut russian_request_id_found = false
  let mut russian_user_agent_found = false
  
  for (key, value) in multilingual_carrier.headers {
    match key {
      "x-Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€-Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°" => {
        assert_eq(value, "req-123456")
        russian_request_id_found = true
      }
      "Ğ°Ğ³ĞµĞ½Ñ‚-Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ" => {
        assert_eq(value, "ĞºĞ»Ğ¸ĞµĞ½Ñ‚ Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸/1.0")
        russian_user_agent_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(russian_request_id_found, "ä¿„æ–‡è¯·æ±‚ID headeråº”è¯¥å­˜åœ¨")
  assert_true(russian_user_agent_found, "ä¿„æ–‡ç”¨æˆ·ä»£ç†headeråº”è¯¥å­˜åœ¨")
}

// æµ‹è¯•4: å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„InstrumentationScopeå¤„ç†
test "å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„InstrumentationScopeå¤„ç†æµ‹è¯•" {
  // 1. åˆ›å»ºä¸­æ–‡ç¯å¢ƒä¸‹çš„InstrumentationScope
  let chinese_scope = InstrumentationScope({
    name: "é¥æµ‹.æ•°æ®å¤„ç†.æ¨¡å—",
    version: Some("1.0.0"),
    schema_url: Some("https://opentelemetry.io/schemas/v1.20.0")
  })
  
  // éªŒè¯ä¸­æ–‡InstrumentationScope
  assert_eq(chinese_scope.name, "é¥æµ‹.æ•°æ®å¤„ç†.æ¨¡å—")
  assert_true(chinese_scope.name.contains("é¥æµ‹"))
  assert_true(chinese_scope.name.contains("æ•°æ®å¤„ç†"))
  assert_true(chinese_scope.name.contains("æ¨¡å—"))
  
  // 2. åˆ›å»ºæ—¥æ–‡ç¯å¢ƒä¸‹çš„InstrumentationScope
  let japanese_scope = InstrumentationScope({
    name: "ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª.ãƒ‡ãƒ¼ã‚¿å‡¦ç†.ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«",
    version: Some("1.0.0"),
    schema_url: Some("https://opentelemetry.io/schemas/v1.20.0")
  })
  
  // éªŒè¯æ—¥æ–‡InstrumentationScope
  assert_eq(japanese_scope.name, "ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª.ãƒ‡ãƒ¼ã‚¿å‡¦ç†.ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«")
  assert_true(japanese_scope.name.contains("ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª"))
  assert_true(japanese_scope.name.contains("ãƒ‡ãƒ¼ã‚¿å‡¦ç†"))
  assert_true(japanese_scope.name.contains("ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«"))
  
  // 3. åˆ›å»ºéŸ©æ–‡ç¯å¢ƒä¸‹çš„InstrumentationScope
  let korean_scope = InstrumentationScope({
    name: "ì›ê²©ì¸¡ì •.ë°ì´í„°ì²˜ë¦¬.ëª¨ë“ˆ",
    version: Some("1.0.0"),
    schema_url: Some("https://opentelemetry.io/schemas/v1.20.0")
  })
  
  // éªŒè¯éŸ©æ–‡InstrumentationScope
  assert_eq(korean_scope.name, "ì›ê²©ì¸¡ì •.ë°ì´í„°ì²˜ë¦¬.ëª¨ë“ˆ")
  assert_true(korean_scope.name.contains("ì›ê²©ì¸¡ì •"))
  assert_true(korean_scope.name.contains("ë°ì´í„°ì²˜ë¦¬"))
  assert_true(korean_scope.name.contains("ëª¨ë“ˆ"))
  
  // 4. åˆ›å»ºé˜¿æ‹‰ä¼¯æ–‡ç¯å¢ƒä¸‹çš„InstrumentationScope
  let arabic_scope = InstrumentationScope({
    name: "Ø§Ù„Ù‚ÙŠØ§Ø³.Ø¹Ù†.Ø¨Ø¹Ø¯.Ù…Ø¹Ø§Ù„Ø¬Ø©.Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.ÙˆØ­Ø¯Ø©",
    version: Some("1.0.0"),
    schema_url: Some("https://opentelemetry.io/schemas/v1.20.0")
  })
  
  // éªŒè¯é˜¿æ‹‰ä¼¯æ–‡InstrumentationScope
  assert_eq(arabic_scope.name, "Ø§Ù„Ù‚ÙŠØ§Ø³.Ø¹Ù†.Ø¨Ø¹Ø¯.Ù…Ø¹Ø§Ù„Ø¬Ø©.Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.ÙˆØ­Ø¯Ø©")
  assert_true(arabic_scope.name.contains("Ø§Ù„Ù‚ÙŠØ§Ø³"))
  assert_true(arabic_scope.name.contains("Ù…Ø¹Ø§Ù„Ø¬Ø©"))
  assert_true(arabic_scope.name.contains("ÙˆØ­Ø¯Ø©"))
  
  // 5. åˆ›å»ºä¿„æ–‡ç¯å¢ƒä¸‹çš„InstrumentationScope
  let russian_scope = InstrumentationScope({
    name: "Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ñ.Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°.Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ",
    version: Some("1.0.0"),
    schema_url: Some("https://opentelemetry.io/schemas/v1.20.0")
  })
  
  // éªŒè¯ä¿„æ–‡InstrumentationScope
  assert_eq(russian_scope.name, "Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ñ.Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°.Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ")
  assert_true(russian_scope.name.contains("Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ñ"))
  assert_true(russian_scope.name.contains("Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°"))
  assert_true(russian_scope.name.contains("Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ"))
  
  // 6. éªŒè¯æ‰€æœ‰scopeçš„ç‰ˆæœ¬å’Œschema URLä¸€è‡´æ€§
  let scopes = [chinese_scope, japanese_scope, korean_scope, arabic_scope, russian_scope]
  
  for scope in scopes {
    match scope.version {
      Some(v) => assert_eq(v, "1.0.0")
      None => assert_true(false, "ç‰ˆæœ¬ä¸åº”ä¸ºNone")
    }
    
    match scope.schema_url {
      Some(url) => assert_eq(url, "https://opentelemetry.io/schemas/v1.20.0")
      None => assert_true(false, "Schema URLä¸åº”ä¸ºNone")
    }
  }
}

// æµ‹è¯•5: å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„Contextå¤„ç†
test "å¤šè¯­è¨€ç¯å¢ƒä¸‹çš„Contextå¤„ç†æµ‹è¯•" {
  // 1. åˆ›å»ºä¸­æ–‡ç¯å¢ƒä¸‹çš„Context
  let chinese_context = Context({
    data: Some(("æ“ä½œ.åç§°", "æ•°æ®æ”¶é›†ä¸åˆ†æ"))
  })
  
  match chinese_context.data {
    Some((key, value)) => {
      assert_eq(key, "æ“ä½œ.åç§°")
      assert_eq(value, "æ•°æ®æ”¶é›†ä¸åˆ†æ")
      assert_true(key.contains("æ“ä½œ"))
      assert_true(value.contains("æ•°æ®æ”¶é›†"))
    }
    None => assert_true(false, "ä¸­æ–‡Contextæ•°æ®ä¸åº”ä¸ºNone")
  }
  
  // 2. åˆ›å»ºæ—¥æ–‡ç¯å¢ƒä¸‹çš„Context
  let japanese_context = Context({
    data: Some(("æ“ä½œ.åå‰", "ãƒ‡ãƒ¼ã‚¿åé›†ã¨åˆ†æ"))
  })
  
  match japanese_context.data {
    Some((key, value)) => {
      assert_eq(key, "æ“ä½œ.åå‰")
      assert_eq(value, "ãƒ‡ãƒ¼ã‚¿åé›†ã¨åˆ†æ")
      assert_true(key.contains("æ“ä½œ"))
      assert_true(value.contains("ãƒ‡ãƒ¼ã‚¿åé›†"))
    }
    None => assert_true(false, "æ—¥æ–‡Contextæ•°æ®ä¸åº”ä¸ºNone")
  }
  
  // 3. åˆ›å»ºéŸ©æ–‡ç¯å¢ƒä¸‹çš„Context
  let korean_context = Context({
    data: Some(("ì‘ì—….ì´ë¦„", "ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„"))
  })
  
  match korean_context.data {
    Some((key, value)) => {
      assert_eq(key, "ì‘ì—….ì´ë¦„")
      assert_eq(value, "ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„")
      assert_true(key.contains("ì‘ì—…"))
      assert_true(value.contains("ë°ì´í„° ìˆ˜ì§‘"))
    }
    None => assert_true(false, "éŸ©æ–‡Contextæ•°æ®ä¸åº”ä¸ºNone")
  }
  
  // 4. åˆ›å»ºé˜¿æ‹‰ä¼¯æ–‡ç¯å¢ƒä¸‹çš„Context
  let arabic_context = Context({
    data: Some(("Ø§Ø³Ù….Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", "Ø¬Ù…Ø¹ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"))
  })
  
  match arabic_context.data {
    Some((key, value)) => {
      assert_eq(key, "Ø§Ø³Ù….Ø§Ù„Ø¹Ù…Ù„ÙŠØ©")
      assert_eq(value, "Ø¬Ù…Ø¹ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
      assert_true(key.contains("Ø¹Ù…Ù„ÙŠØ©"))
      assert_true(value.contains("Ø¬Ù…Ø¹"))
    }
    None => assert_true(false, "é˜¿æ‹‰ä¼¯æ–‡Contextæ•°æ®ä¸åº”ä¸ºNone")
  }
  
  // 5. åˆ›å»ºä¿„æ–‡ç¯å¢ƒä¸‹çš„Context
  let russian_context = Context({
    data: Some(("Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ.Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸", "ÑĞ±Ğ¾Ñ€ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…"))
  })
  
  match russian_context.data {
    Some((key, value)) => {
      assert_eq(key, "Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ.Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸")
      assert_eq(value, "ÑĞ±Ğ¾Ñ€ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…")
      assert_true(key.contains("Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸"))
      assert_true(value.contains("ÑĞ±Ğ¾Ñ€"))
    }
    None => assert_true(false, "ä¿„æ–‡Contextæ•°æ®ä¸åº”ä¸ºNone")
  }
  
  // 6. åˆ›å»ºåŒ…å«æ··åˆè¯­è¨€çš„Context
  let mixed_context = Context({
    data: Some(("operation.name", "é¥æµ‹æ“ä½œ ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ æ“ä½œ ì›ê²© ì¸¡å®š Ù‚ÙŠØ§Ø³ Ø¹Ù† Ø¨Ø¹Ø¯ Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ñ"))
  })
  
  match mixed_context.data {
    Some((key, value)) => {
      assert_eq(key, "operation.name")
      assert_true(value.contains("é¥æµ‹æ“ä½œ"))
      assert_true(value.contains("ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼"))
      assert_true(value.contains("ì›ê²© ì¸¡ì •"))
      assert_true(value.contains("Ù‚ÙŠØ§Ø³ Ø¹Ù† Ø¨Ø¹Ø¯"))
      assert_true(value.contains("Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ñ"))
    }
    None => assert_true(false, "æ··åˆè¯­è¨€Contextæ•°æ®ä¸åº”ä¸ºNone")
  }
}

// æµ‹è¯•6: åŒºåŸŸç‰¹å®šæ ¼å¼å¤„ç†
test "åŒºåŸŸç‰¹å®šæ ¼å¼å¤„ç†æµ‹è¯•" {
  // 1. æµ‹è¯•ä¸åŒåŒºåŸŸçš„æ—¥æœŸæ—¶é—´æ ¼å¼
  let chinese_date_attr = AttributeValue::StringValue("2023å¹´1æœˆ1æ—¥ 00:00:00")
  match chinese_date_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "2023å¹´1æœˆ1æ—¥ 00:00:00")
      assert_true(s.contains("å¹´"))
      assert_true(s.contains("æœˆ"))
      assert_true(s.contains("æ—¥"))
    }
    _ => assert_true(false, "ä¸­æ–‡æ—¥æœŸæ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let japanese_date_attr = AttributeValue::StringValue("2023å¹´1æœˆ1æ—¥ 00:00:00")
  match japanese_date_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "2023å¹´1æœˆ1æ—¥ 00:00:00")
      assert_true(s.contains("å¹´"))
      assert_true(s.contains("æœˆ"))
      assert_true(s.contains("æ—¥"))
    }
    _ => assert_true(false, "æ—¥æ–‡æ—¥æœŸæ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let korean_date_attr = AttributeValue::StringValue("2023ë…„ 1ì›” 1ì¼ 00:00:00")
  match korean_date_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "2023ë…„ 1ì›” 1ì¼ 00:00:00")
      assert_true(s.contains("ë…„"))
      assert_true(s.contains("ì›”"))
      assert_true(s.contains("ì¼"))
    }
    _ => assert_true(false, "éŸ©æ–‡æ—¥æœŸæ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let arabic_date_attr = AttributeValue::StringValue("Ù¡ ÙŠÙ†Ø§ÙŠØ± Ù¢Ù Ù¢Ù£ Ù Ù :Ù Ù :Ù Ù ")
  match arabic_date_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "Ù¡ ÙŠÙ†Ø§ÙŠØ± Ù¢Ù Ù¢Ù£ Ù Ù :Ù Ù :Ù Ù ")
      assert_true(s.contains("ÙŠÙ†Ø§ÙŠØ±"))
      assert_true(s.contains("Ù¢Ù Ù¢Ù£"))
    }
    _ => assert_true(false, "é˜¿æ‹‰ä¼¯æ–‡æ—¥æœŸæ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let russian_date_attr = AttributeValue::StringValue("1 ÑĞ½Ğ²Ğ°Ñ€Ñ 2023 Ğ³. 00:00:00")
  match russian_date_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "1 ÑĞ½Ğ²Ğ°Ñ€Ñ 2023 Ğ³. 00:00:00")
      assert_true(s.contains("ÑĞ½Ğ²Ğ°Ñ€Ñ"))
      assert_true(s.contains("2023"))
    }
    _ => assert_true(false, "ä¿„æ–‡æ—¥æœŸæ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  // 2. æµ‹è¯•ä¸åŒåŒºåŸŸçš„æ•°å­—æ ¼å¼
  let western_number_attr = AttributeValue::StringValue("1,234,567.89")
  match western_number_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "1,234,567.89")
      assert_true(s.contains(","))
      assert_true(s.contains("."))
    }
    _ => assert_true(false, "è¥¿æ–¹æ•°å­—æ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let chinese_number_attr = AttributeValue::StringValue("1,234,567.89")
  match chinese_number_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "1,234,567.89")
      assert_true(s.contains(","))
      assert_true(s.contains("."))
    }
    _ => assert_true(false, "ä¸­æ–‡æ•°å­—æ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let european_number_attr = AttributeValue::StringValue("1.234.567,89")
  match european_number_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "1.234.567,89")
      assert_true(s.contains("."))
      assert_true(s.contains(","))
    }
    _ => assert_true(false, "æ¬§æ´²æ•°å­—æ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let arabic_number_attr = AttributeValue::StringValue("Ù¡Ù¬Ù¢Ù£Ù¤Ù¬Ù¥Ù¦Ù§Ù«Ù¨Ù©")
  match arabic_number_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "Ù¡Ù¬Ù¢Ù£Ù¤Ù¬Ù¥Ù¦Ù§Ù«Ù¨Ù©")
      assert_true(s.contains("Ù¡"))
      assert_true(s.contains("Ù¨Ù©"))
    }
    _ => assert_true(false, "é˜¿æ‹‰ä¼¯æ–‡æ•°å­—æ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  // 3. æµ‹è¯•ä¸åŒåŒºåŸŸçš„è´§å¸æ ¼å¼
  let usd_currency_attr = AttributeValue::StringValue("$1,234.56")
  match usd_currency_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "$1,234.56")
      assert_true(s.contains("$"))
      assert_true(s.contains(","))
    }
    _ => assert_true(false, "ç¾å…ƒè´§å¸æ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let eur_currency_attr = AttributeValue::StringValue("1.234,56 â‚¬")
  match eur_currency_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "1.234,56 â‚¬")
      assert_true(s.contains("â‚¬"))
      assert_true(s.contains(","))
    }
    _ => assert_true(false, "æ¬§å…ƒè´§å¸æ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let cny_currency_attr = AttributeValue::StringValue("Â¥1,234.56")
  match cny_currency_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "Â¥1,234.56")
      assert_true(s.contains("Â¥"))
      assert_true(s.contains(","))
    }
    _ => assert_true(false, "äººæ°‘å¸è´§å¸æ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  let jpy_currency_attr = AttributeValue::StringValue("Â¥1,235")
  match jpy_currency_attr {
    AttributeValue::StringValue(s) => {
      assert_eq(s, "Â¥1,235")
      assert_true(s.contains("Â¥"))
      assert_false(s.contains("."))
    }
    _ => assert_true(false, "æ—¥å…ƒè´§å¸æ ¼å¼è½¬æ¢å¤±è´¥")
  }
  
  // 4. åˆ›å»ºåŒ…å«åŒºåŸŸç‰¹å®šæ ¼å¼çš„Baggage
  let regional_baggage = Baggage({
    entries: [
      ("transaction.amount.usd", "$1,234.56"),
      ("transaction.amount.eur", "1.234,56 â‚¬"),
      ("transaction.amount.cny", "Â¥1,234.56"),
      ("transaction.amount.jpy", "Â¥1,235"),
      ("transaction.date.us", "01/01/2023"),
      ("transaction.date.eu", "01.01.2023"),
      ("transaction.date.cn", "2023å¹´1æœˆ1æ—¥"),
      ("transaction.date.jp", "2023/01/01"),
      ("transaction.date.kr", "2023. 01. 01."),
      ("transaction.date.ar", "Ù¡/Ù¡/Ù¢Ù Ù¢Ù£"),
      ("transaction.date.ru", "01.01.2023")
    ]
  })
  
  // 5. éªŒè¯åŒºåŸŸç‰¹å®šæ ¼å¼çš„Baggage
  assert_eq(regional_baggage.entries.length(), 11)
  
  let mut usd_found = false
  let mut eur_found = false
  let mut cny_found = false
  let mut jpy_found = false
  let mut cn_date_found = false
  
  for (key, value) in regional_baggage.entries {
    match key {
      "transaction.amount.usd" => {
        assert_eq(value, "$1,234.56")
        usd_found = true
      }
      "transaction.amount.eur" => {
        assert_eq(value, "1.234,56 â‚¬")
        eur_found = true
      }
      "transaction.amount.cny" => {
        assert_eq(value, "Â¥1,234.56")
        cny_found = true
      }
      "transaction.amount.jpy" => {
        assert_eq(value, "Â¥1,235")
        jpy_found = true
      }
      "transaction.date.cn" => {
        assert_eq(value, "2023å¹´1æœˆ1æ—¥")
        cn_date_found = true
      }
      _ => () // å¿½ç•¥å…¶ä»–é”®
    }
  }
  
  assert_true(usd_found, "ç¾å…ƒæ ¼å¼åº”è¯¥å­˜åœ¨")
  assert_true(eur_found, "æ¬§å…ƒæ ¼å¼åº”è¯¥å­˜åœ¨")
  assert_true(cny_found, "äººæ°‘å¸æ ¼å¼åº”è¯¥å­˜åœ¨")
  assert_true(jpy_found, "æ—¥å…ƒæ ¼å¼åº”è¯¥å­˜åœ¨")
  assert_true(cn_date_found, "ä¸­æ–‡æ—¥æœŸæ ¼å¼åº”è¯¥å­˜åœ¨")
}