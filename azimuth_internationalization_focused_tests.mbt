// Azimuth å›½é™…åŒ–ä¸“é¡¹æµ‹è¯•
// ä¸“æ³¨äºæµ‹è¯•é¥æµ‹ç³»ç»Ÿçš„å›½é™…åŒ–å’Œæœ¬åœ°åŒ–æ”¯æŒ

// æµ‹è¯•1: å¤šè¯­è¨€å­—ç¬¦ä¸²å¤„ç†
test "multilingual_string_processing" {
  // æµ‹è¯•è‹±æ–‡å­—ç¬¦ä¸²
  let english_string = "azimuth telemetry system"
  assert_eq(english_string.length(), 23)
  assert_true(english_string.contains("telemetry"))
  
  // æµ‹è¯•ä¸­æ–‡å­—ç¬¦ä¸²
  let chinese_string = "æ–¹ä½è§’é¥æµ‹ç³»ç»Ÿ"
  assert_eq(chinese_string.length(), 6)
  assert_true(chinese_string.contains("é¥æµ‹"))
  
  // æµ‹è¯•æ—¥æ–‡å­—ç¬¦ä¸²
  let japanese_string = "æ–¹ä½è§’ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚·ã‚¹ãƒ†ãƒ "
  assert_eq(japanese_string.length(), 12)
  assert_true(japanese_string.contains("ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª"))
  
  // æµ‹è¯•é˜¿æ‹‰ä¼¯æ–‡å­—ç¬¦ä¸²
  let arabic_string = "Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø£Ø²ÙŠÙ…ÙˆØ«"
  assert_eq(arabic_string.length(), 15)
  assert_true(arabic_string.contains("ØªØªØ¨Ø¹"))
  
  // æµ‹è¯•ä¿„æ–‡å­—ç¬¦ä¸²
  let russian_string = "ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸ Ğ°Ğ·Ğ¸Ğ¼ÑƒÑ‚"
  assert_eq(russian_string.length(), 25)
  assert_true(russian_string.contains("Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸"))
  
  // æµ‹è¯•æ··åˆè¯­è¨€å­—ç¬¦ä¸²
  let mixed_string = "Azimuth æ–¹ä½è§’ ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª Telemetry"
  assert_eq(mixed_string.length(), 21)
  assert_true(mixed_string.contains("Azimuth"))
  assert_true(mixed_string.contains("æ–¹ä½è§’"))
  assert_true(mixed_string.contains("ãƒ†ãƒ¬ãƒ¡ãƒˆãƒª"))
  assert_true(mixed_string.contains("Telemetry"))
}

// æµ‹è¯•2: Unicodeå­—ç¬¦å¤„ç†
test "unicode_character_processing" {
  // æµ‹è¯•åŸºæœ¬å¤šè¯­è¨€å¹³é¢å­—ç¬¦
  let bmp_string = "Hello ä¸–ç•Œ ã“ã‚“ã«ã¡ã¯ Ù…Ø±Ø­Ø¨Ø§ ĞŸÑ€Ğ¸Ğ²ĞµÑ‚"
  assert_eq(bmp_string.length(), 23)
  
  // æµ‹è¯•è¡¨æƒ…ç¬¦å·
  let emoji_string = "ğŸš€ ğŸ“Š ğŸ“ˆ ğŸ“‰"
  assert_eq(emoji_string.length(), 7)
  
  // æµ‹è¯•æ•°å­¦ç¬¦å·
  let math_symbols = "âˆ‘ âˆ âˆ« âˆ† âˆ‡ âˆ‚"
  assert_eq(math_symbols.length(), 11)
  
  // æµ‹è¯•è´§å¸ç¬¦å·
  let currency_symbols = "$ â‚¬ Â£ Â¥ â‚¹ â‚½"
  assert_eq(currency_symbols.length(), 11)
  
  // æµ‹è¯•ç‰¹æ®Šç©ºæ ¼å­—ç¬¦
  let space_chars = "Hello\u00A0World\u2003Test"
  assert_eq(space_chars.length(), 15)
  assert_true(space_chars.contains("Hello"))
  assert_true(space_chars.contains("World"))
  assert_true(space_chars.contains("Test"))
}

// æµ‹è¯•3: å¤šè¯­è¨€å±æ€§å€¼å¤„ç†
test "multilingual_attribute_values" {
  // åˆ›å»ºåŒ…å«å¤šè¯­è¨€å€¼çš„å±æ€§
  let multilingual_attrs = Attributes {
    values: [
      ("service.name.en", AttributeValue::StringValue("Azimuth Telemetry Service")),
      ("service.name.zh", AttributeValue::StringValue("æ–¹ä½è§’é¥æµ‹æœåŠ¡")),
      ("service.name.ja", AttributeValue::StringValue("æ–¹ä½è§’ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚µãƒ¼ãƒ“ã‚¹")),
      ("service.name.ar", AttributeValue::StringValue("Ø®Ø¯Ù…Ø© ØªØªØ¨Ø¹ Ø£Ø²ÙŠÙ…ÙˆØ«")),
      ("service.name.ru", AttributeValue::StringValue("Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ° Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸ ĞĞ·Ğ¸Ğ¼ÑƒÑ‚"))
    ]
  }
  
  // éªŒè¯å±æ€§æ•°é‡
  assert_eq(multilingual_attrs.values.length(), 5)
  
  // éªŒè¯è‹±æ–‡åç§°
  let english_name = multilingual_attrs.values.find(fn(pair) { pair.0 == "service.name.en" })
  match english_name {
    Some((k, v)) => {
      assert_eq(k, "service.name.en")
      match v {
        AttributeValue::StringValue(name) => assert_eq(name, "Azimuth Telemetry Service")
        _ => assert_true(false)
      }
    }
    None => assert_true(false)
  }
  
  // éªŒè¯ä¸­æ–‡åç§°
  let chinese_name = multilingual_attrs.values.find(fn(pair) { pair.0 == "service.name.zh" })
  match chinese_name {
    Some((k, v)) => {
      assert_eq(k, "service.name.zh")
      match v {
        AttributeValue::StringValue(name) => assert_eq(name, "æ–¹ä½è§’é¥æµ‹æœåŠ¡")
        _ => assert_true(false)
      }
    }
    None => assert_true(false)
  }
  
  // éªŒè¯æ—¥æ–‡åç§°
  let japanese_name = multilingual_attrs.values.find(fn(pair) { pair.0 == "service.name.ja" })
  match japanese_name {
    Some((k, v)) => {
      assert_eq(k, "service.name.ja")
      match v {
        AttributeValue::StringValue(name) => assert_eq(name, "æ–¹ä½è§’ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚µãƒ¼ãƒ“ã‚¹")
        _ => assert_true(false)
      }
    }
    None => assert_true(false)
  }
}

// æµ‹è¯•4: æœ¬åœ°åŒ–é”™è¯¯æ¶ˆæ¯
test "localized_error_messages" {
  // åˆ›å»ºå¤šè¯­è¨€é”™è¯¯æ¶ˆæ¯
  let error_messages = [
    ("en", "Invalid trace ID format"),
    ("zh", "æ— æ•ˆçš„è·Ÿè¸ªIDæ ¼å¼"),
    ("ja", "ç„¡åŠ¹ãªãƒˆãƒ¬ãƒ¼ã‚¹IDå½¢å¼"),
    ("ar", "ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹Ø±Ù Ø§Ù„ØªØªØ¨Ø¹ ØºÙŠØ± ØµØ§Ù„Ø­"),
    ("ru", "ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ğ° Ñ‚Ñ€Ğ°ÑÑĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸")
  ]
  
  // éªŒè¯é”™è¯¯æ¶ˆæ¯æ•°é‡
  assert_eq(error_messages.length(), 5)
  
  // éªŒè¯è‹±æ–‡é”™è¯¯æ¶ˆæ¯
  let english_error = error_messages.find(fn(pair) { pair.0 == "en" })
  match english_error {
    Some((lang, msg)) => {
      assert_eq(lang, "en")
      assert_eq(msg, "Invalid trace ID format")
    }
    None => assert_true(false)
  }
  
  // éªŒè¯ä¸­æ–‡é”™è¯¯æ¶ˆæ¯
  let chinese_error = error_messages.find(fn(pair) { pair.0 == "zh" })
  match chinese_error {
    Some((lang, msg)) => {
      assert_eq(lang, "zh")
      assert_eq(msg, "æ— æ•ˆçš„è·Ÿè¸ªIDæ ¼å¼")
    }
    None => assert_true(false)
  }
  
  // éªŒè¯æ—¥æ–‡é”™è¯¯æ¶ˆæ¯
  let japanese_error = error_messages.find(fn(pair) { pair.0 == "ja" })
  match japanese_error {
    Some((lang, msg)) => {
      assert_eq(lang, "ja")
      assert_eq(msg, "ç„¡åŠ¹ãªãƒˆãƒ¬ãƒ¼ã‚¹IDå½¢å¼")
    }
    None => assert_true(false)
  }
}

// æµ‹è¯•5: åŒºåŸŸç‰¹å®šæ ¼å¼
test "locale_specific_formats" {
  // æµ‹è¯•æ—¥æœŸæ ¼å¼
  let date_formats = [
    ("en-US", "01/15/2023"),
    ("en-GB", "15/01/2023"),
    ("zh-CN", "2023/01/15"),
    ("ja-JP", "2023/01/15"),
    ("ar-SA", "15/01/2023"),
    ("ru-RU", "15.01.2023")
  ]
  
  // éªŒè¯æ—¥æœŸæ ¼å¼æ•°é‡
  assert_eq(date_formats.length(), 6)
  
  // éªŒè¯ç‰¹å®šæ ¼å¼
  let us_format = date_formats.find(fn(pair) { pair.0 == "en-US" })
  match us_format {
    Some((locale, format)) => {
      assert_eq(locale, "en-US")
      assert_eq(format, "01/15/2023")
    }
    None => assert_true(false)
  }
  
  let gb_format = date_formats.find(fn(pair) { pair.0 == "en-GB" })
  match gb_format {
    Some((locale, format)) => {
      assert_eq(locale, "en-GB")
      assert_eq(format, "15/01/2023")
    }
    None => assert_true(false)
  }
  
  // æµ‹è¯•æ•°å­—æ ¼å¼
  let number_formats = [
    ("en-US", "1,234.56"),
    ("de-DE", "1.234,56"),
    ("zh-CN", "1,234.56"),
    ("ja-JP", "1,234.56"),
    ("ar-SA", "1,234.56"),
    ("ru-RU", "1 234,56")
  ]
  
  // éªŒè¯æ•°å­—æ ¼å¼æ•°é‡
  assert_eq(number_formats.length(), 6)
  
  // éªŒè¯ç‰¹å®šæ ¼å¼
  let de_format = number_formats.find(fn(pair) { pair.0 == "de-DE" })
  match de_format {
    Some((locale, format)) => {
      assert_eq(locale, "de-DE")
      assert_eq(format, "1.234,56")
    }
    None => assert_true(false)
  }
}

// æµ‹è¯•6: æ–‡æœ¬æ–¹å‘å¤„ç†
test "text_direction_processing" {
  // æµ‹è¯•ä»å·¦åˆ°å³æ–‡æœ¬
  let ltr_text = "Hello World"
  assert_eq(ltr_text.length(), 11)
  
  // æµ‹è¯•ä»å³åˆ°å·¦æ–‡æœ¬
  let rtl_text = "Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…"
  assert_eq(rtl_text.length(), 13)
  
  // æµ‹è¯•åŒå‘æ–‡æœ¬
  let bidi_text = "Hello Ù…Ø±Ø­Ø¨Ø§ World"
  assert_eq(bidi_text.length(), 18)
  
  // æµ‹è¯•æ··åˆæ–¹å‘æ–‡æœ¬
  let mixed_direction_text = "English Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© æ—¥æœ¬è¯­ Ñ€ÑƒÑÑĞºĞ¸Ğ¹"
  assert_eq(mixed_direction_text.length(), 29)
  
  // éªŒè¯æ–‡æœ¬åŒ…å«ä¸åŒè¯­è¨€çš„å­—ç¬¦
  assert_true(ltr_text.contains("Hello"))
  assert_true(rtl_text.contains("Ù…Ø±Ø­Ø¨Ø§"))
  assert_true(bidi_text.contains("Hello"))
  assert_true(bidi_text.contains("Ù…Ø±Ø­Ø¨Ø§"))
  assert_true(mixed_direction_text.contains("English"))
  assert_true(mixed_direction_text.contains("Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"))
  assert_true(mixed_direction_text.contains("æ—¥æœ¬è¯­"))
  assert_true(mixed_direction_text.contains("Ñ€ÑƒÑÑĞºĞ¸Ğ¹"))
}

// æµ‹è¯•7: å¤šè¯­è¨€Baggageå¤„ç†
test "multilingual_baggage_processing" {
  // åˆ›å»ºåŒ…å«å¤šè¯­è¨€æ¡ç›®çš„Baggage
  let multilingual_baggage = Baggage {
    entries: [
      ("user.id", "12345"),
      ("user.name.en", "John Doe"),
      ("user.name.zh", "å¼ ä¸‰"),
      ("user.name.ja", "ç”°ä¸­å¤ªéƒ"),
      ("user.department.en", "Engineering"),
      ("user.department.zh", "å·¥ç¨‹éƒ¨"),
      ("user.department.ja", "ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°éƒ¨")
    ]
  }
  
  // éªŒè¯æ¡ç›®æ•°é‡
  assert_eq(multilingual_baggage.entries.length(), 7)
  
  // éªŒè¯ç”¨æˆ·ID
  let user_id = multilingual_baggage.entries.find(fn(entry) { entry.0 == "user.id" })
  match user_id {
    Some((k, v)) => {
      assert_eq(k, "user.id")
      assert_eq(v, "12345")
    }
    None => assert_true(false)
  }
  
  // éªŒè¯è‹±æ–‡ç”¨æˆ·å
  let english_name = multilingual_baggage.entries.find(fn(entry) { entry.0 == "user.name.en" })
  match english_name {
    Some((k, v)) => {
      assert_eq(k, "user.name.en")
      assert_eq(v, "John Doe")
    }
    None => assert_true(false)
  }
  
  // éªŒè¯ä¸­æ–‡ç”¨æˆ·å
  let chinese_name = multilingual_baggage.entries.find(fn(entry) { entry.0 == "user.name.zh" })
  match chinese_name {
    Some((k, v)) => {
      assert_eq(k, "user.name.zh")
      assert_eq(v, "å¼ ä¸‰")
    }
    None => assert_true(false)
  }
  
  // éªŒè¯æ—¥æ–‡ç”¨æˆ·å
  let japanese_name = multilingual_baggage.entries.find(fn(entry) { entry.0 == "user.name.ja" })
  match japanese_name {
    Some((k, v)) => {
      assert_eq(k, "user.name.ja")
      assert_eq(v, "ç”°ä¸­å¤ªéƒ")
    }
    None => assert_true(false)
  }
}

// æµ‹è¯•8: å›½é™…åŒ–èµ„æºé…ç½®
test "internationalized_resource_configuration" {
  // åˆ›å»ºå¤šè¯­è¨€èµ„æºé…ç½®
  let multilingual_resources = [
    Resource {
      attributes: [
        ("service.name", AttributeValue::StringValue("Azimuth Service")),
        ("service.locale", AttributeValue::StringValue("en-US")),
        ("service.description", AttributeValue::StringValue("Telemetry and monitoring service"))
      ]
    },
    Resource {
      attributes: [
        ("service.name", AttributeValue::StringValue("æ–¹ä½è§’æœåŠ¡")),
        ("service.locale", AttributeValue::StringValue("zh-CN")),
        ("service.description", AttributeValue::StringValue("é¥æµ‹å’Œç›‘æ§æœåŠ¡"))
      ]
    },
    Resource {
      attributes: [
        ("service.name", AttributeValue::StringValue("æ–¹ä½è§’ã‚µãƒ¼ãƒ“ã‚¹")),
        ("service.locale", AttributeValue::StringValue("ja-JP")),
        ("service.description", AttributeValue::StringValue("ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã¨ç›£è¦–ã‚µãƒ¼ãƒ“ã‚¹"))
      ]
    }
  ]
  
  // éªŒè¯èµ„æºæ•°é‡
  assert_eq(multilingual_resources.length(), 3)
  
  // éªŒè¯è‹±æ–‡èµ„æº
  let english_resource = multilingual_resources[0]
  assert_eq(english_resource.attributes.length(), 3)
  
  let en_locale = english_resource.attributes.find(fn(attr) { attr.0 == "service.locale" })
  match en_locale {
    Some((k, v)) => {
      assert_eq(k, "service.locale")
      match v {
        AttributeValue::StringValue(locale) => assert_eq(locale, "en-US")
        _ => assert_true(false)
      }
    }
    None => assert_true(false)
  }
  
  // éªŒè¯ä¸­æ–‡èµ„æº
  let chinese_resource = multilingual_resources[1]
  assert_eq(chinese_resource.attributes.length(), 3)
  
  let zh_locale = chinese_resource.attributes.find(fn(attr) { attr.0 == "service.locale" })
  match zh_locale {
    Some((k, v)) => {
      assert_eq(k, "service.locale")
      match v {
        AttributeValue::StringValue(locale) => assert_eq(locale, "zh-CN")
        _ => assert_true(false)
      }
    }
    None => assert_true(false)
  }
  
  // éªŒè¯æ—¥æ–‡èµ„æº
  let japanese_resource = multilingual_resources[2]
  assert_eq(japanese_resource.attributes.length(), 3)
  
  let ja_locale = japanese_resource.attributes.find(fn(attr) { attr.0 == "service.locale" })
  match ja_locale {
    Some((k, v)) => {
      assert_eq(k, "service.locale")
      match v {
        AttributeValue::StringValue(locale) => assert_eq(locale, "ja-JP")
        _ => assert_true(false)
      }
    }
    None => assert_true(false)
  }
}