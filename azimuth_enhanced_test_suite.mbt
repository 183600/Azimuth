// æ–°å¢çš„é«˜è´¨é‡ MoonBit æµ‹è¯•ç”¨ä¾‹
// é’ˆå¯¹ azimuth åº“æ ¸å¿ƒåŠŸèƒ½çš„å…¨é¢æµ‹è¯•

test "add_function_mathematical_properties" {
  // æµ‹è¯•åŠ æ³•çš„æ•°å­¦æ€§è´¨
  // äº¤æ¢å¾‹æµ‹è¯•
  assert_eq(add(7, 13), add(13, 7))
  assert_eq(add(-5, 10), add(10, -5))
  
  // ç»“åˆå¾‹æµ‹è¯•
  assert_eq(add(add(2, 3), 5), add(2, add(3, 5)))
  
  // å•ä½å…ƒæµ‹è¯•
  assert_eq(42, add(42, 0))
  assert_eq(-17, add(-17, 0))
  
  // ç›¸åæ•°æµ‹è¯•
  assert_eq(0, add(15, -15))
  assert_eq(0, add(-8, 8))
}

test "multiply_function_comprehensive" {
  // æµ‹è¯•ä¹˜æ³•çš„å…¨é¢åŠŸèƒ½
  // äº¤æ¢å¾‹æµ‹è¯•
  assert_eq(multiply(6, 7), multiply(7, 6))
  assert_eq(multiply(-3, 8), multiply(8, -3))
  
  // ç»“åˆå¾‹æµ‹è¯•
  assert_eq(multiply(multiply(2, 3), 4), multiply(2, multiply(3, 4)))
  
  // åˆ†é…å¾‹æµ‹è¯•
  assert_eq(multiply(5, add(3, 2)), add(multiply(5, 3), multiply(5, 2)))
  
  // é›¶å…ƒç´ æµ‹è¯•
  assert_eq(0, multiply(0, 123))
  assert_eq(0, multiply(-456, 0))
  
  // å•ä½å…ƒæµ‹è¯•
  assert_eq(25, multiply(25, 1))
  assert_eq(-17, multiply(-17, 1))
}

test "divide_with_ceil_advanced_scenarios" {
  // æµ‹è¯•å‘ä¸Šå–æ•´é™¤æ³•çš„é«˜çº§åœºæ™¯
  // æ­£æ•°é™¤æ³•æµ‹è¯•
  assert_eq(4, divide_with_ceil(11, 3))  // 3.666... -> 4
  assert_eq(7, divide_with_ceil(13, 2))  // 6.5 -> 7
  assert_eq(1, divide_with_ceil(1, 100)) // 0.01 -> 1
  
  // è´Ÿæ•°é™¤æ³•æµ‹è¯•
  assert_eq(-3, divide_with_ceil(-10, 3))  // -3.333... -> -3
  assert_eq(-2, divide_with_ceil(-4, 2))   // -2 -> -2
  assert_eq(4, divide_with_ceil(-11, -3))  // 3.666... -> 4
  
  // è¾¹ç•Œæƒ…å†µæµ‹è¯•
  assert_eq(0, divide_with_ceil(0, 5))
  assert_eq(0, divide_with_ceil(100, 0))  // é™¤æ•°ä¸ºé›¶çš„å®‰å…¨å¤„ç†
  assert_eq(1, divide_with_ceil(5, 5))
  assert_eq(100, divide_with_ceil(999, 10))  // 99.9 -> 100
}

test "greet_function_unicode_and_special_chars" {
  // æµ‹è¯•é—®å€™å‡½æ•°çš„ Unicode å’Œç‰¹æ®Šå­—ç¬¦å¤„ç†
  // Unicode å­—ç¬¦æµ‹è¯•
  assert_eq_string("Hello, ä¸–ç•Œ!", greet("ä¸–ç•Œ"))
  assert_eq_string("Hello, ğŸš€!", greet("ğŸš€"))
  assert_eq_string("Hello, cafÃ©!", greet("cafÃ©"))
  assert_eq_string("Hello, Ã±oÃ±o!", greet("Ã±oÃ±o"))
  assert_eq_string("Hello, ĞœĞ¾ÑĞºĞ²Ğ°!", greet("ĞœĞ¾ÑĞºĞ²Ğ°"))
  
  // ç‰¹æ®Šå­—ç¬¦æµ‹è¯•
  assert_eq_string("Hello, test@example.com!", greet("test@example.com"))
  assert_eq_string("Hello, 123!", greet("123"))
  assert_eq_string("Hello, A+B=C!", greet("A+B=C"))
  assert_eq_string("Hello, spaced name!", greet("spaced name"))
  
  // è¾¹ç•Œæƒ…å†µæµ‹è¯•
  assert_eq_string("Hello, !", greet(""))
  assert_eq_string("Hello,   !", greet("  "))
}

test "real_world_business_calculations" {
  // æµ‹è¯•çœŸå®ä¸–ç•Œçš„ä¸šåŠ¡è®¡ç®—åœºæ™¯
  // è®¢å•æ€»ä»·è®¡ç®—
  let unit_price = 85
  let quantity = 12
  let tax_rate = 8  // 8%
  let shipping = 25
  
  let subtotal = multiply(unit_price, quantity)
  let tax_amount = divide_with_ceil(multiply(subtotal, tax_rate), 100)
  let total = add(add(subtotal, tax_amount), shipping)
  
  assert_eq(1020, subtotal)
  assert_eq(82, tax_amount)  // ceil(1020 * 8 / 100) = ceil(81.6) = 82
  assert_eq(1127, total)
  
  // æŠ˜æ‰£è®¡ç®—
  let discount_threshold = 1000
  let discount_amount = 50
  let final_total = if total > discount_threshold {
    add(total, -discount_amount)
  } else {
    total
  }
  
  assert_eq(1077, final_total)
}

test "inventory_and_packaging_optimization" {
  // æµ‹è¯•åº“å­˜å’ŒåŒ…è£…ä¼˜åŒ–è®¡ç®—
  let product_a_qty = 150
  let product_b_qty = 87
  let product_c_qty = 234
  
  let box_capacity = 25
  
  // è®¡ç®—æ¯ç§äº§å“éœ€è¦çš„åŒ…è£…ç®±æ•°é‡
  let boxes_a = divide_with_ceil(product_a_qty, box_capacity)
  let boxes_b = divide_with_ceil(product_b_qty, box_capacity)
  let boxes_c = divide_with_ceil(product_c_qty, box_capacity)
  
  assert_eq(6, boxes_a)   // ceil(150/25) = 6
  assert_eq(4, boxes_b)   // ceil(87/25) = 4
  assert_eq(10, boxes_c)  // ceil(234/25) = 10
  
  // è®¡ç®—æ€»ç®±æ•°å’Œå‰©ä½™å®¹é‡
  let total_boxes = add(add(boxes_a, boxes_b), boxes_c)
  let total_capacity = multiply(total_boxes, box_capacity)
  let total_items = add(add(product_a_qty, product_b_qty), product_c_qty)
  let unused_capacity = add(total_capacity, -total_items)
  
  assert_eq(20, total_boxes)
  assert_eq(500, total_capacity)
  assert_eq(471, total_items)
  assert_eq(29, unused_capacity)
}

test "energy_consumption_analysis" {
  // æµ‹è¯•èƒ½æºæ¶ˆè€—åˆ†æè®¡ç®—
  let daily_consumption_kwh = 120
  let days_in_month = 30
  let peak_hours_percentage = 40
  let off_peak_rate = 8
  let peak_rate = 15
  
  // è®¡ç®—æœˆåº¦æ€»æ¶ˆè€—
  let monthly_consumption = multiply(daily_consumption_kwh, days_in_month)
  
  // è®¡ç®—å³°å€¼å’Œéå³°å€¼çš„æ¶ˆè€—é‡
  let peak_consumption = divide_with_ceil(multiply(monthly_consumption, peak_hours_percentage), 100)
  let off_peak_consumption = add(monthly_consumption, -peak_consumption)
  
  // è®¡ç®—ç”µè´¹
  let peak_cost = multiply(peak_consumption, peak_rate)
  let off_peak_cost = multiply(off_peak_consumption, off_peak_rate)
  let total_cost = add(peak_cost, off_peak_cost)
  
  assert_eq(3600, monthly_consumption)
  assert_eq(1440, peak_consumption)   // ceil(3600 * 40 / 100) = ceil(1440) = 1440
  assert_eq(2160, off_peak_consumption)
  assert_eq(21600, peak_cost)         // 1440 * 15
  assert_eq(17280, off_peak_cost)     // 2160 * 8
  assert_eq(38880, total_cost)
}

test "mathematical_sequence_calculations" {
  // æµ‹è¯•æ•°å­¦åºåˆ—è®¡ç®—
  // ç­‰å·®æ•°åˆ—æ±‚å’Œï¼š1 + 3 + 5 + ... + 19 (10ä¸ªå¥‡æ•°)
  let first_term = 1
  let common_difference = 2
  let number_of_terms = 10
  
  // ä½¿ç”¨å…¬å¼ï¼šS = n/2 * (2a + (n-1)d)
  let sum_formula = divide_with_ceil(
    multiply(number_of_terms, add(multiply(2, first_term), multiply(number_of_terms - 1, common_difference))),
    2
  )
  
  // éªŒè¯ç»“æœï¼š1 + 3 + 5 + 7 + 9 + 11 + 13 + 15 + 17 + 19 = 100
  assert_eq(100, sum_formula)
  
  // ç­‰æ¯”æ•°åˆ—æ±‚å’Œï¼š2 + 4 + 8 + 16 + 32
  let geometric_sum = add(add(add(add(2, 4), 8), 16), 32)
  assert_eq(62, geometric_sum)
  
  // é˜¶ä¹˜è®¡ç®—ï¼š5! = 5 * 4 * 3 * 2 * 1
  let factorial_5 = multiply(5, multiply(4, multiply(3, multiply(2, 1))))
  assert_eq(120, factorial_5)
}

test "error_handling_and_boundary_conditions" {
  // æµ‹è¯•é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæ¡ä»¶
  // æå€¼æµ‹è¯•
  let large_positive = 1000000
  let large_negative = -1000000
  
  assert_eq(2000000, add(large_positive, large_positive))
  assert_eq(-2000000, add(large_negative, large_negative))
  assert_eq(0, add(large_positive, large_negative))
  
  assert_eq(1000000000000, multiply(large_positive, large_positive))
  assert_eq(1000000000000, multiply(large_negative, large_negative))
  assert_eq(-1000000000000, multiply(large_positive, large_negative))
  
  // é™¤æ³•çš„è¾¹ç•Œæƒ…å†µ
  assert_eq(0, divide_with_ceil(0, 100))
  assert_eq(0, divide_with_ceil(100, 0))
  assert_eq(0, divide_with_ceil(0, 0))
  assert_eq(1, divide_with_ceil(1, 1))
  assert_eq(1000000, divide_with_ceil(large_positive, 1))
  
  // å­—ç¬¦ä¸²è¾¹ç•Œæµ‹è¯•
  assert_eq_string("Hello, A!", greet("A"))  // å•å­—ç¬¦
  let very_long_name = "This is a very long name that might cause issues in some systems"
  assert_eq_string("Hello, " + very_long_name + "!", greet(very_long_name))
}

test "performance_and_efficiency_metrics" {
  // æµ‹è¯•æ€§èƒ½å’Œæ•ˆç‡æŒ‡æ ‡è®¡ç®—
  let base_operations = 1000
  let optimization_factor = 3
  let overhead_percentage = 15
  let target_improvement = 250
  
  // è®¡ç®—ä¼˜åŒ–åçš„æ€§èƒ½
  let optimized_operations = multiply(base_operations, optimization_factor)
  
  // è®¡ç®—ç³»ç»Ÿå¼€é”€
  let system_overhead = divide_with_ceil(multiply(optimized_operations, overhead_percentage), 100)
  
  // è®¡ç®—å®é™…æ€§èƒ½
  let actual_performance = add(optimized_operations, -system_overhead)
  
  // è®¡ç®—æ€§èƒ½æ”¹è¿›ç™¾åˆ†æ¯”
  let improvement_percentage = divide_with_ceil(multiply(actual_performance - base_operations, 100), base_operations)
  
  // éªŒè¯æ˜¯å¦è¾¾åˆ°ç›®æ ‡
  let target_met = if actual_performance >= target_improvement { 1 } else { 0 }
  
  assert_eq(3000, optimized_operations)
  assert_eq(450, system_overhead)  // ceil(3000 * 15 / 100) = 450
  assert_eq(2550, actual_performance)
  assert_eq(155, improvement_percentage)  // ceil((2550-1000) * 100 / 1000) = 155
  assert_eq(1, target_met)  // ç›®æ ‡è¾¾æˆ
}