// Azimuth Telemetry System - Comprehensive Internationalization Tests
// ç»¼åˆå›½é™…åŒ–æµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•ç³»ç»Ÿçš„å¤šè¯­è¨€å’Œæœ¬åœ°åŒ–æ”¯æŒ

test "å¤šè¯­è¨€æ–‡æœ¬å¤„ç†æµ‹è¯•" {
  // æµ‹è¯•ä¸­æ–‡æ–‡æœ¬å¤„ç†
  let chinese_text = "é¥æµ‹ç³»ç»Ÿç›‘æ§æ•°æ®"
  assert_eq(chinese_text.length(), 8)
  assert_eq(chinese_text.char_at(0), "é¥")
  assert_eq(chinese_text.char_at(7), "æ®")
  
  // æµ‹è¯•æ—¥æ–‡æ–‡æœ¬å¤„ç†
  let japanese_text = "ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚·ã‚¹ãƒ†ãƒ "
  assert_eq(japanese_text.length(), 8)
  assert_eq(japanese_text.char_at(0), "ãƒ†")
  assert_eq(japanese_text.char_at(7), "ãƒ ")
  
  // æµ‹è¯•éŸ©æ–‡æ–‡æœ¬å¤„ç†
  let korean_text = "ì›ê²© ì¸¡ì • ì‹œìŠ¤í…œ"
  assert_eq(korean_text.length(), 8)
  assert_eq(korean_text.char_at(0), "ì›")
  assert_eq(korean_text.char_at(7), "í…œ")
  
  // æµ‹è¯•é˜¿æ‹‰ä¼¯æ–‡æ–‡æœ¬å¤„ç†
  let arabic_text = "Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ Ø¹Ù† Ø¨Ø¹Ø¯"
  assert_eq(arabic_text.length(), 16)
  
  // æµ‹è¯•ä¿„æ–‡æ–‡æœ¬å¤„ç†
  let russian_text = "Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸"
  assert_eq(russian_text.length(), 17)
  
  // æµ‹è¯•æ··åˆè¯­è¨€æ–‡æœ¬å¤„ç†
  let mixed_text = "Azimuthé¥æµ‹ç³»ç»Ÿãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼"
  assert_eq(mixed_text.length(), 16)
  
  // æµ‹è¯•Unicodeç¼–ç è½¬æ¢
  let unicode_text = "ğŸŒğŸ“ŠğŸ“ˆğŸ“‰"
  assert_eq(unicode_text.length(), 4)
  assert_eq(unicode_text.code_point_at(0), 127757) // ğŸŒ
  assert_eq(unicode_text.code_point_at(1), 128202) // ğŸ“Š
  assert_eq(unicode_text.code_point_at(2), 128200) // ğŸ“ˆ
  assert_eq(unicode_text.code_point_at(3), 128201) // ğŸ“‰
}

test "æœ¬åœ°åŒ–æ•°å­—å’Œæ—¥æœŸæ ¼å¼æµ‹è¯•" {
  // æµ‹è¯•æ•°å­—æ ¼å¼åŒ–
  let number = 1234567.89
  
  // ç¾å›½æ ¼å¼
  let us_format = azimuth::Locale::format_number(number, "en-US")
  assert_eq(us_format, "1,234,567.89")
  
  // å¾·å›½æ ¼å¼
  let de_format = azimuth::Locale::format_number(number, "de-DE")
  assert_eq(de_format, "1.234.567,89")
  
  // æ³•å›½æ ¼å¼
  let fr_format = azimuth::Locale::format_number(number, "fr-FR")
  assert_eq(fr_format, "1 234 567,89")
  
  // ä¸­å›½æ ¼å¼
  let zh_format = azimuth::Locale::format_number(number, "zh-CN")
  assert_eq(zh_format, "1,234,567.89")
  
  // å°åº¦æ ¼å¼
  let hi_format = azimuth::Locale::format_number(number, "hi-IN")
  assert_eq(hi_format, "12,34,567.89")
  
  // æµ‹è¯•æ—¥æœŸæ ¼å¼åŒ–
  let date = azimuth::DateTime::new(2024, 1, 15, 14, 30, 0)
  
  // ç¾å›½æ ¼å¼
  let us_date = azimuth::Locale::format_date(date, "en-US")
  assert_eq(us_date, "1/15/2024, 2:30 PM")
  
  // è‹±å›½æ ¼å¼
  let uk_date = azimuth::Locale::format_date(date, "en-GB")
  assert_eq(uk_date, "15/01/2024, 14:30")
  
  // ä¸­å›½æ ¼å¼
  let zh_date = azimuth::Locale::format_date(date, "zh-CN")
  assert_eq(zh_date, "2024/1/15 ä¸‹åˆ2:30")
  
  // æ—¥æœ¬æ ¼å¼
  let ja_date = azimuth::Locale::format_date(date, "ja-JP")
  assert_eq(ja_date, "2024/1/15 14:30")
  
  // å¾·å›½æ ¼å¼
  let de_date = azimuth::Locale::format_date(date, "de-DE")
  assert_eq(de_date, "15.1.2024, 14:30")
}

test "å¤šè¯­è¨€é”™è¯¯æ¶ˆæ¯æµ‹è¯•" {
  // åˆ›å»ºå¤šè¯­è¨€é”™è¯¯å¤„ç†å™¨
  let error_handler = azimuth::I18nErrorHandler::new()
  
  // æ·»åŠ é”™è¯¯æ¶ˆæ¯ç¿»è¯‘
  error_handler.add_translation("en", "connection_failed", "Connection to server failed")
  error_handler.add_translation("zh", "connection_failed", "è¿æ¥æœåŠ¡å™¨å¤±è´¥")
  error_handler.add_translation("ja", "connection_failed", "ã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ")
  error_handler.add_translation("ko", "connection_failed", "ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")
  error_handler.add_translation("fr", "connection_failed", "La connexion au serveur a Ã©chouÃ©")
  
  error_handler.add_translation("en", "invalid_credentials", "Invalid username or password")
  error_handler.add_translation("zh", "invalid_credentials", "ç”¨æˆ·åæˆ–å¯†ç æ— æ•ˆ")
  error_handler.add_translation("ja", "invalid_credentials", "ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒç„¡åŠ¹ã§ã™")
  error_handler.add_translation("ko", "invalid_credentials", "ì‚¬ìš©ì ì´ë¦„ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤")
  error_handler.add_translation("fr", "invalid_credentials", "Nom d'utilisateur ou mot de passe invalide")
  
  // æµ‹è¯•è‹±è¯­é”™è¯¯æ¶ˆæ¯
  let en_error1 = error_handler.get_message("en", "connection_failed")
  assert_eq(en_error1, "Connection to server failed")
  
  let en_error2 = error_handler.get_message("en", "invalid_credentials")
  assert_eq(en_error2, "Invalid username or password")
  
  // æµ‹è¯•ä¸­æ–‡é”™è¯¯æ¶ˆæ¯
  let zh_error1 = error_handler.get_message("zh", "connection_failed")
  assert_eq(zh_error1, "è¿æ¥æœåŠ¡å™¨å¤±è´¥")
  
  let zh_error2 = error_handler.get_message("zh", "invalid_credentials")
  assert_eq(zh_error2, "ç”¨æˆ·åæˆ–å¯†ç æ— æ•ˆ")
  
  // æµ‹è¯•æ—¥æ–‡é”™è¯¯æ¶ˆæ¯
  let ja_error1 = error_handler.get_message("ja", "connection_failed")
  assert_eq(ja_error1, "ã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ")
  
  let ja_error2 = error_handler.get_message("ja", "invalid_credentials")
  assert_eq(ja_error2, "ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒç„¡åŠ¹ã§ã™")
  
  // æµ‹è¯•éŸ©æ–‡é”™è¯¯æ¶ˆæ¯
  let ko_error1 = error_handler.get_message("ko", "connection_failed")
  assert_eq(ko_error1, "ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")
  
  let ko_error2 = error_handler.get_message("ko", "invalid_credentials")
  assert_eq(ko_error2, "ì‚¬ìš©ì ì´ë¦„ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤")
  
  // æµ‹è¯•æ³•æ–‡é”™è¯¯æ¶ˆæ¯
  let fr_error1 = error_handler.get_message("fr", "connection_failed")
  assert_eq(fr_error1, "La connexion au serveur a Ã©chouÃ©")
  
  let fr_error2 = error_handler.get_message("fr", "invalid_credentials")
  assert_eq(fr_error2, "Nom d'utilisateur ou mot de passe invalide")
  
  // æµ‹è¯•å›é€€åˆ°é»˜è®¤è¯­è¨€
  let fallback_error = error_handler.get_message("es", "connection_failed") // è¥¿ç­ç‰™è¯­æœªå®šä¹‰
  assert_eq(fallback_error, "Connection to server failed") // å›é€€åˆ°è‹±è¯­
}

test "æ–‡åŒ–ç‰¹å®šæ’åºæµ‹è¯•" {
  // æµ‹è¯•ä¸åŒè¯­è¨€çš„å­—ç¬¦ä¸²æ’åº
  let strings = ["apple", "banana", "cherry", "date"]
  
  // è‹±è¯­æ’åº
  let en_sorted = azimuth::Locale::sort_strings(strings, "en-US")
  assert_eq(en_sorted, ["apple", "banana", "cherry", "date"])
  
  // æµ‹è¯•ä¸­æ–‡æ’åº
  let chinese_strings = ["è‹¹æœ", "é¦™è•‰", "æ¨±æ¡ƒ", "æ£"]
  let zh_sorted = azimuth::Locale::sort_strings(chinese_strings, "zh-CN")
  assert_eq(zh_sorted, ["æ£", "è‹¹æœ", "æ¨±æ¡ƒ", "é¦™è•‰"])
  
  // æµ‹è¯•æ—¥æ–‡æ’åº
  let japanese_strings = ["ã‚Šã‚“ã”", "ã°ãªãª", "ã•ãã‚‰ã‚“ã¼", "ãªã¤ã‚"]
  let ja_sorted = azimuth::Locale::sort_strings(japanese_strings, "ja-JP")
  assert_eq(ja_sorted, ["ã°ãªãª", "ã•ãã‚‰ã‚“ã¼", "ãªã¤ã‚", "ã‚Šã‚“ã”"])
  
  // æµ‹è¯•å¾·è¯­ç‰¹æ®Šå­—ç¬¦æ’åº
  let german_strings = ["Ã¤pfel", "bananen", "kirschen", "datteln"]
  let de_sorted = azimuth::Locale::sort_strings(german_strings, "de-DE")
  assert_eq(de_sorted, ["Ã¤pfel", "bananen", "datteln", "kirschen"])
  
  // æµ‹è¯•è¥¿ç­ç‰™è¯­ç‰¹æ®Šå­—ç¬¦æ’åº
  let spanish_strings = ["manzana", "banana", "cereza", "dÃ¡til"]
  let es_sorted = azimuth::Locale::sort_strings(spanish_strings, "es-ES")
  assert_eq(es_sorted, ["banana", "cereza", "dÃ¡til", "manzana"])
}

test "æ—¶åŒºå’Œæ—¶é—´è½¬æ¢æµ‹è¯•" {
  // åˆ›å»ºUTCæ—¶é—´
  let utc_time = azimuth::DateTime::from_utc(2024, 1, 15, 12, 0, 0)
  
  // è½¬æ¢ä¸ºä¸åŒæ—¶åŒº
  let us_eastern = utc_time.to_timezone("America/New_York")
  assert_eq(us_eastern.hour(), 7) // UTC-5 (æ ‡å‡†æ—¶é—´)
  assert_eq(us_eastern.minute(), 0)
  
  let us_pacific = utc_time.to_timezone("America/Los_Angeles")
  assert_eq(us_pacific.hour(), 4) // UTC-8 (æ ‡å‡†æ—¶é—´)
  assert_eq(us_pacific.minute(), 0)
  
  let europe_london = utc_time.to_timezone("Europe/London")
  assert_eq(europe_london.hour(), 12) // UTC+0 (æ ‡å‡†æ—¶é—´)
  assert_eq(europe_london.minute(), 0)
  
  let europe_paris = utc_time.to_timezone("Europe/Paris")
  assert_eq(europe_paris.hour(), 13) // UTC+1 (æ ‡å‡†æ—¶é—´)
  assert_eq(europe_paris.minute(), 0)
  
  let asia_tokyo = utc_time.to_timezone("Asia/Tokyo")
  assert_eq(asia_tokyo.hour(), 21) // UTC+9
  assert_eq(asia_tokyo.minute(), 0)
  
  let asia_shanghai = utc_time.to_timezone("Asia/Shanghai")
  assert_eq(asia_shanghai.hour(), 20) // UTC+8
  assert_eq(asia_shanghai.minute(), 0)
  
  let australia_sydney = utc_time.to_timezone("Australia/Sydney")
  assert_eq(australia_sydney.hour(), 23) // UTC+11
  assert_eq(australia_sydney.minute(), 0)
  
  // æµ‹è¯•å¤ä»¤æ—¶è½¬æ¢
  let summer_utc = azimuth::DateTime::from_utc(2024, 7, 15, 12, 0, 0)
  let summer_eastern = summer_utc.to_timezone("America/New_York")
  assert_eq(summer_eastern.hour(), 8) // UTC-4 (å¤ä»¤æ—¶)
  
  // æµ‹è¯•æ—¶åŒºæ ¼å¼åŒ–
  let formatted_utc = utc_time.format_with_timezone("en-US", "UTC")
  assert_eq(formatted_utc, "1/15/2024, 12:00 PM UTC")
  
  let formatted_eastern = us_eastern.format_with_timezone("en-US", "EST")
  assert_eq(formatted_eastern, "1/15/2024, 7:00 AM EST")
  
  let formatted_tokyo = asia_tokyo.format_with_timezone("ja-JP", "JST")
  assert_eq(formatted_tokyo, "2024/1/15 21:00 JST")
}

test "è´§å¸å’Œåº¦é‡è¡¡æœ¬åœ°åŒ–æµ‹è¯•" {
  // æµ‹è¯•è´§å¸æ ¼å¼åŒ–
  let amount = 1234.56
  
  // ç¾å…ƒ
  let usd = azimuth::Locale::format_currency(amount, "en-US", "USD")
  assert_eq(usd, "$1,234.56")
  
  // æ¬§å…ƒ
  let eur = azimuth::Locale::format_currency(amount, "de-DE", "EUR")
  assert_eq(eur, "1.234,56 â‚¬")
  
  // äººæ°‘å¸
  let cny = azimuth::Locale::format_currency(amount, "zh-CN", "CNY")
  assert_eq(cny, "Â¥1,234.56")
  
  // æ—¥å…ƒ
  let jpy = azimuth::Locale::format_currency(amount, "ja-JP", "JPY")
  assert_eq(jpy, "Â¥1,235") // æ—¥å…ƒé€šå¸¸ä¸æ˜¾ç¤ºå°æ•°
  
  // è‹±é•‘
  let gbp = azimuth::Locale::format_currency(amount, "en-GB", "GBP")
  assert_eq(gbp, "Â£1,234.56")
  
  // éŸ©å…ƒ
  let krw = azimuth::Locale::format_currency(amount, "ko-KR", "KRW")
  assert_eq(krw, "â‚©1,235") // éŸ©å…ƒé€šå¸¸ä¸æ˜¾ç¤ºå°æ•°
  
  // æµ‹è¯•åº¦é‡è¡¡å•ä½è½¬æ¢
  let distance = 100.0 // è‹±é‡Œ
  
  // è½¬æ¢ä¸ºå…¬é‡Œï¼ˆå…¬åˆ¶ï¼‰
  let km = azimuth::Locale::convert_distance(distance, "mi", "km")
  assert_true((km - 160.934).abs() < 0.001)
  
  // è½¬æ¢ä¸ºå…¬é‡Œï¼ˆç¾å›½æœ¬åœ°åŒ–ï¼‰
  let us_km = azimuth::Locale::format_distance(distance, "mi", "km", "en-US")
  assert_eq(us_km, "160.934 km")
  
  // è½¬æ¢ä¸ºè‹±é‡Œï¼ˆç¾å›½æœ¬åœ°åŒ–ï¼‰
  let us_mi = azimuth::Locale::format_distance(km, "km", "mi", "en-US")
  assert_eq(us_mi, "100.0 mi")
  
  // è½¬æ¢ä¸ºå…¬é‡Œï¼ˆä¸­å›½æœ¬åœ°åŒ–ï¼‰
  let cn_km = azimuth::Locale::format_distance(distance, "mi", "km", "zh-CN")
  assert_eq(cn_km, "160.934å…¬é‡Œ")
  
  // æµ‹è¯•é‡é‡å•ä½è½¬æ¢
  let weight = 100.0 // ç£…
  
  // è½¬æ¢ä¸ºå…¬æ–¤
  let kg = azimuth::Locale::convert_weight(weight, "lb", "kg")
  assert_true((kg - 45.359).abs() < 0.001)
  
  // æ ¼å¼åŒ–é‡é‡ï¼ˆç¾å›½æœ¬åœ°åŒ–ï¼‰
  let us_kg = azimuth::Locale::format_weight(weight, "lb", "kg", "en-US")
  assert_eq(us_kg, "45.359 kg")
  
  // æ ¼å¼åŒ–é‡é‡ï¼ˆä¸­å›½æœ¬åœ°åŒ–ï¼‰
  let cn_kg = azimuth::Locale::format_weight(weight, "lb", "kg", "zh-CN")
  assert_eq(cn_kg, "45.359å…¬æ–¤")
}

test "å¤šè¯­è¨€UIå…ƒç´ æµ‹è¯•" {
  // åˆ›å»ºå¤šè¯­è¨€UIç®¡ç†å™¨
  let ui_manager = azimuth::I18nUIManager::new()
  
  // æ·»åŠ UIå…ƒç´ ç¿»è¯‘
  ui_manager.add_translation("en", "button_submit", "Submit")
  ui_manager.add_translation("zh", "button_submit", "æäº¤")
  ui_manager.add_translation("ja", "button_submit", "é€ä¿¡")
  ui_manager.add_translation("ko", "button_submit", "ì œì¶œ")
  ui_manager.add_translation("fr", "button_submit", "Soumettre")
  
  ui_manager.add_translation("en", "button_cancel", "Cancel")
  ui_manager.add_translation("zh", "button_cancel", "å–æ¶ˆ")
  ui_manager.add_translation("ja", "button_cancel", "ã‚­ãƒ£ãƒ³ã‚»ãƒ«")
  ui_manager.add_translation("ko", "button_cancel", "ì·¨ì†Œ")
  ui_manager.add_translation("fr", "button_cancel", "Annuler")
  
  ui_manager.add_translation("en", "menu_dashboard", "Dashboard")
  ui_manager.add_translation("zh", "menu_dashboard", "ä»ªè¡¨æ¿")
  ui_manager.add_translation("ja", "menu_dashboard", "ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰")
  ui_manager.add_translation("ko", "menu_dashboard", "ëŒ€ì‹œë³´ë“œ")
  ui_manager.add_translation("fr", "menu_dashboard", "Tableau de bord")
  
  // æµ‹è¯•è‹±è¯­UIå…ƒç´ 
  let en_submit = ui_manager.get_text("en", "button_submit")
  assert_eq(en_submit, "Submit")
  
  let en_cancel = ui_manager.get_text("en", "button_cancel")
  assert_eq(en_cancel, "Cancel")
  
  let en_dashboard = ui_manager.get_text("en", "menu_dashboard")
  assert_eq(en_dashboard, "Dashboard")
  
  // æµ‹è¯•ä¸­æ–‡UIå…ƒç´ 
  let zh_submit = ui_manager.get_text("zh", "button_submit")
  assert_eq(zh_submit, "æäº¤")
  
  let zh_cancel = ui_manager.get_text("zh", "button_cancel")
  assert_eq(zh_cancel, "å–æ¶ˆ")
  
  let zh_dashboard = ui_manager.get_text("zh", "menu_dashboard")
  assert_eq(zh_dashboard, "ä»ªè¡¨æ¿")
  
  // æµ‹è¯•æ—¥æ–‡UIå…ƒç´ 
  let ja_submit = ui_manager.get_text("ja", "button_submit")
  assert_eq(ja_submit, "é€ä¿¡")
  
  let ja_cancel = ui_manager.get_text("ja", "button_cancel")
  assert_eq(ja_cancel, "ã‚­ãƒ£ãƒ³ã‚»ãƒ«")
  
  let ja_dashboard = ui_manager.get_text("ja", "menu_dashboard")
  assert_eq(ja_dashboard, "ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰")
  
  // æµ‹è¯•éŸ©æ–‡UIå…ƒç´ 
  let ko_submit = ui_manager.get_text("ko", "button_submit")
  assert_eq(ko_submit, "ì œì¶œ")
  
  let ko_cancel = ui_manager.get_text("ko", "button_cancel")
  assert_eq(ko_cancel, "ì·¨ì†Œ")
  
  let ko_dashboard = ui_manager.get_text("ko", "menu_dashboard")
  assert_eq(ko_dashboard, "ëŒ€ì‹œë³´ë“œ")
  
  // æµ‹è¯•æ³•æ–‡UIå…ƒç´ 
  let fr_submit = ui_manager.get_text("fr", "button_submit")
  assert_eq(fr_submit, "Soumettre")
  
  let fr_cancel = ui_manager.get_text("fr", "button_cancel")
  assert_eq(fr_cancel, "Annuler")
  
  let fr_dashboard = ui_manager.get_text("fr", "menu_dashboard")
  assert_eq(fr_dashboard, "Tableau de bord")
  
  // æµ‹è¯•å‚æ•°åŒ–æ–‡æœ¬
  ui_manager.add_translation("en", "welcome_message", "Welcome, {name}!")
  ui_manager.add_translation("zh", "welcome_message", "æ¬¢è¿ï¼Œ{name}ï¼")
  ui_manager.add_translation("ja", "welcome_message", "ã‚ˆã†ã“ãã€{name}ã•ã‚“ï¼")
  
  let en_welcome = ui_manager.get_formatted_text("en", "welcome_message", [("name", "å¼ ä¸‰")])
  assert_eq(en_welcome, "Welcome, å¼ ä¸‰!")
  
  let zh_welcome = ui_manager.get_formatted_text("zh", "welcome_message", [("name", "å¼ ä¸‰")])
  assert_eq(zh_welcome, "æ¬¢è¿ï¼Œå¼ ä¸‰ï¼")
  
  let ja_welcome = ui_manager.get_formatted_text("ja", "welcome_message", [("name", "å¼ ä¸‰")])
  assert_eq(ja_welcome, "ã‚ˆã†ã“ãã€å¼ ä¸‰ã•ã‚“ï¼")
}

test "æ–‡æœ¬æ–¹å‘å’Œå¸ƒå±€æµ‹è¯•" {
  // æµ‹è¯•ä»å·¦åˆ°å³çš„æ–‡æœ¬æ–¹å‘
  let ltr_text = "Hello World"
  assert_eq(azimuth::Locale::get_text_direction("en"), "ltr")
  assert_eq(azimuth::Locale::get_text_direction("fr"), "ltr")
  assert_eq(azimuth::Locale::get_text_direction("de"), "ltr")
  
  // æµ‹è¯•ä»å³åˆ°å·¦çš„æ–‡æœ¬æ–¹å‘
  assert_eq(azimuth::Locale::get_text_direction("ar"), "rtl")
  assert_eq(azimuth::Locale::get_text_direction("he"), "rtl")
  assert_eq(azimuth::Locale::get_text_direction("fa"), "rtl")
  
  // æµ‹è¯•é˜¿æ‹‰ä¼¯è¯­æ–‡æœ¬
  let arabic_text = "Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…"
  let arabic_formatted = azimuth::Locale::format_text_with_direction(arabic_text, "ar")
  assert_eq(arabic_formatted, "Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…") // æ–‡æœ¬åº”è¯¥ä¿æŒåŸæ ·ï¼Œä½†å¸ƒå±€åº”è¯¥ä»å³åˆ°å·¦
  
  // æµ‹è¯•å¸Œä¼¯æ¥è¯­æ–‡æœ¬
  let hebrew_text = "×©×œ×•× ×¢×•×œ×"
  let hebrew_formatted = azimuth::Locale::format_text_with_direction(hebrew_text, "he")
  assert_eq(hebrew_formatted, "×©×œ×•× ×¢×•×œ×")
  
  // æµ‹è¯•æ··åˆæ–¹å‘æ–‡æœ¬
  let mixed_text = "Hello Ù…Ø±Ø­Ø¨Ø§ World"
  let mixed_formatted = azimuth::Locale::format_text_with_direction(mixed_text, "en")
  assert_eq(mixed_formatted, "Hello Ù…Ø±Ø­Ø¨Ø§ World")
  
  // æµ‹è¯•å¸ƒå±€é•œåƒ
  let layout_elements = ["button", "text", "icon"]
  let ltr_layout = azimuth::Locale::mirror_layout_if_needed(layout_elements, "en")
  assert_eq(ltr_layout, ["button", "text", "icon"]) // ä¸éœ€è¦é•œåƒ
  
  let rtl_layout = azimuth::Locale::mirror_layout_if_needed(layout_elements, "ar")
  assert_eq(rtl_layout, ["icon", "text", "button"]) // éœ€è¦é•œåƒ
}

test "æ–‡åŒ–ç‰¹å®šæ•°æ®å¤„ç†æµ‹è¯•" {
  // æµ‹è¯•å§“åæ ¼å¼åŒ–
  let person = {
    "first_name": "å¼ ",
    "last_name": "ä¸‰",
    "title": "å…ˆç”Ÿ"
  }
  
  // è¥¿æ–¹æ ¼å¼
  let western_name = azimuth::Locale::format_name(person, "en-US")
  assert_eq(western_name, "Mr. San Zhang")
  
  // ä¸­æ–‡æ ¼å¼
  let chinese_name = azimuth::Locale::format_name(person, "zh-CN")
  assert_eq(chinese_name, "å¼ ä¸‰å…ˆç”Ÿ")
  
  // æ—¥æ–‡æ ¼å¼
  let japanese_name = azimuth::Locale::format_name(person, "ja-JP")
  assert_eq(japanese_name, "å¼µä¸‰æ§˜")
  
  // éŸ©æ–‡æ ¼å¼
  let korean_name = azimuth::Locale::format_name(person, "ko-KR")
  assert_eq(korean_name, "ì¥ ì‚¼ ì”¨")
  
  // æµ‹è¯•åœ°å€æ ¼å¼åŒ–
  let address = {
    "street": "123 Main St",
    "city": "Beijing",
    "state": "Beijing",
    "postal_code": "100000",
    "country": "China"
  }
  
  // ç¾å›½æ ¼å¼
  let us_address = azimuth::Locale::format_address(address, "en-US")
  assert_eq(us_address, "123 Main St\nBeijing, 100000\nChina")
  
  // ä¸­æ–‡æ ¼å¼
  let cn_address = azimuth::Locale::format_address(address, "zh-CN")
  assert_eq(cn_address, "ä¸­å›½åŒ—äº¬å¸‚\né‚®ç¼–ï¼š100000\nMain St 123å·")
  
  // æµ‹è¯•ç”µè¯å·ç æ ¼å¼åŒ–
  let phone_number = "+8613812345678"
  
  // ç¾å›½æ ¼å¼
  let us_phone = azimuth::Locale::format_phone_number(phone_number, "en-US")
  assert_eq(us_phone, "+86 138-1234-5678")
  
  // ä¸­æ–‡æ ¼å¼
  let cn_phone = azimuth::Locale::format_phone_number(phone_number, "zh-CN")
  assert_eq(cn_phone, "+86 138 1234 5678")
  
  // æµ‹è¯•æ–‡åŒ–ç‰¹å®šåˆ—è¡¨æ ¼å¼åŒ–
  let list_items = ["è‹¹æœ", "é¦™è•‰", "æ¨±æ¡ƒ"]
  
  // è‹±è¯­åˆ—è¡¨æ ¼å¼
  let en_list = azimuth::Locale::format_list(list_items, "en-US")
  assert_eq(en_list, "apples, bananas, and cherries")
  
  // ä¸­æ–‡åˆ—è¡¨æ ¼å¼
  let zh_list = azimuth::Locale::format_list(list_items, "zh-CN")
  assert_eq(zh_list, "è‹¹æœã€é¦™è•‰å’Œæ¨±æ¡ƒ")
  
  // æ—¥æ–‡åˆ—è¡¨æ ¼å¼
  let ja_list = azimuth::Locale::format_list(list_items, "ja-JP")
  assert_eq(ja_list, "ãƒªãƒ³ã‚´ã€ãƒãƒŠãƒŠã€ãƒã‚§ãƒªãƒ¼")
}