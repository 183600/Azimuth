// æ–­è¨€ç›¸ç­‰å‡½æ•°ï¼Œç”¨äºæµ‹è¯•
pub fn assert_eq(expected : Int, actual : Int) -> Unit {
  let _ = expected == actual
}

pub fn assert_eq_string(expected : String, actual : String) -> Unit {
  let _ = expected == actual
}

// é¢å¤–åœºæ™¯æµ‹è¯• - è¡¥å……ç°æœ‰æµ‹è¯•è¦†ç›–èŒƒå›´

// æµ‹è¯•å¤§æ•°è¿ç®—çš„å®‰å…¨æ€§
///|
test "large_number_operations" {
  // æµ‹è¯•æ¥è¿‘è¾¹ç•Œçš„å¤§æ•°è¿ç®—
  let half_max = 1073741823  // Int32æœ€å¤§å€¼çš„ä¸€åŠ
  let half_min = -1073741824 // Int32æœ€å°å€¼çš„ä¸€åŠ
  
  // æµ‹è¯•å¤§æ•°ç›¸åŠ 
  assert_eq(2147483646, @clean_test.@clean_test.add(half_max, half_max + 1))
  assert_eq(-2147483648, @clean_test.@clean_test.add(half_min, half_min))
  
  // æµ‹è¯•å¤§æ•°ç›¸ä¹˜
  assert_eq(2147483647, @clean_test.@clean_test.multiply(half_max, 2))
  assert_eq(-2147483648, @clean_test.@clean_test.multiply(half_min, 2))
}

// æµ‹è¯•è´Ÿæ•°ä¹˜æ³•çš„ç‰¹æ®Šæƒ…å†µ
///|
test "negative_multiplication_edge_cases" {
  // æµ‹è¯•è´Ÿæ•°ä¹˜ä»¥è´Ÿæ•°çš„å„ç§æƒ…å†µ
  assert_eq(2147483647, @clean_test.@clean_test.multiply(-46341, -46341))  // åº”è¯¥æº¢å‡ºåˆ°æœ€å¤§å€¼
  assert_eq(2147483647, @clean_test.@clean_test.multiply(-65536, -65536))  // å¤§æ•°è´Ÿæ•°ç›¸ä¹˜
  assert_eq(2147483647, @clean_test.@clean_test.multiply(-100000, -30000)) // è´Ÿæ•°æº¢å‡º
  
  // æµ‹è¯•è´Ÿæ•°ä¹˜ä»¥æ­£æ•°
  assert_eq(-2147483648, @clean_test.@clean_test.multiply(-46341, 46341))  // åº”è¯¥æº¢å‡ºåˆ°æœ€å°å€¼
  assert_eq(-2147483648, @clean_test.@clean_test.multiply(-65536, 65536))  // å¤§æ•°ç›¸ä¹˜
  assert_eq(-2147483648, @clean_test.@clean_test.multiply(-100000, 30000)) // è´Ÿæ•°æº¢å‡º
}

// æµ‹è¯•å­—ç¬¦ä¸²å¤„ç†çš„è¾¹ç•Œæƒ…å†µ
///|
test "string_boundary_cases" {
  // æµ‹è¯•é•¿å­—ç¬¦ä¸²
  let long_name = "è¿™æ˜¯ä¸€ä¸ªéå¸¸é•¿çš„ç”¨æˆ·åå­—ç¬¦ä¸²ç”¨æ¥æµ‹è¯•greetå‡½æ•°åœ¨å¤„ç†é•¿å­—ç¬¦ä¸²æ—¶çš„è¡¨ç°"
  let result = @clean_test.@clean_test.greet(long_name)
  assert_eq(true, result.contains("Hello, "))
  assert_eq(true, result.contains(long_name))
  assert_eq(true, result.ends_with("!"))
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å­—ç¬¦ä¸²
  assert_eq("Hello, @#$%^&*()!", @clean_test.@clean_test.greet("@#$%^&*()"))
  assert_eq_string("Hello, ä¸­æ–‡æµ‹è¯•!", @clean_test.@clean_test.greet("ä¸­æ–‡æµ‹è¯•"))
  assert_eq_string("Hello, ğŸŒ™â­!", @clean_test.@clean_test.greet("ğŸŒ™â­"))
}

// æµ‹è¯•æ•°å­¦æ’ç­‰å¼
///|
test "mathematical_identities" {
  // æµ‹è¯•å¹³æ–¹å·®å…¬å¼: aÂ² - bÂ² = (a+b)(a-b)
  let a = 100
  let b = 50
  
  // è®¡ç®— aÂ² - bÂ²
  let a_squared = @clean_test.@clean_test.multiply(a, a)
  let b_squared = @clean_test.@clean_test.multiply(b, b)
  let difference = @clean_test.@clean_test.add(a_squared, -b_squared)
  
  // è®¡ç®— (a+b)(a-b)
  let sum = @clean_test.@clean_test.add(a, b)
  let diff = @clean_test.@clean_test.add(a, -b)
  let product = @clean_test.@clean_test.multiply(sum, diff)
  
  assert_eq(difference, product)
  
  // æµ‹è¯•åˆ†é…å¾‹: a(b+c) = ab + ac
  let x = 15
  let y = 25
  let z = 35
  
  let left_side = @clean_test.@clean_test.multiply(x, @clean_test.@clean_test.add(y, z))
  let right_side = @clean_test.@clean_test.add(@clean_test.@clean_test.multiply(x, y), @clean_test.@clean_test.multiply(x, z))
  
  assert_eq(left_side, right_side)
}

// æµ‹è¯•å®é™…é‡‘èè®¡ç®—åœºæ™¯
///|
test "financial_calculations" {
  // æ¨¡æ‹Ÿé“¶è¡Œè´¦æˆ·è®¡ç®—
  let initial_balance = 10000  // åˆå§‹ä½™é¢
  let deposit1 = 2500         // ç¬¬ä¸€æ¬¡å­˜æ¬¾
  let deposit2 = 1500         // ç¬¬äºŒæ¬¡å­˜æ¬¾
  let withdrawal1 = -800      // ç¬¬ä¸€æ¬¡å–æ¬¾
  let withdrawal2 = -1200     // ç¬¬äºŒæ¬¡å–æ¬¾
  
  // è®¡ç®—æœ€ç»ˆä½™é¢
  let balance1 = @clean_test.@clean_test.add(initial_balance, deposit1)
  let balance2 = @clean_test.@clean_test.add(balance1, deposit2)
  let balance3 = @clean_test.@clean_test.add(balance2, withdrawal1)
  let final_balance = @clean_test.@clean_test.add(balance3, withdrawal2)
  
  assert_eq(12000, final_balance)
  
  // è®¡ç®—åˆ©æ¯ï¼ˆå‡è®¾æœˆåˆ©ç‡1%ï¼Œå­˜12ä¸ªæœˆï¼‰
  let principal = 5000
  let monthly_rate = 1  // 1%
  let months = 12
  let monthly_interest = @clean_test.@clean_test.multiply(principal, monthly_rate)
  let total_interest = @clean_test.@clean_test.multiply(monthly_interest, months)
  let final_amount = @clean_test.@clean_test.add(principal, total_interest)
  
  assert_eq(5600, final_amount)
}

// æµ‹è¯•æ¸©åº¦è½¬æ¢
///|
test "temperature_conversion" {
  // æ‘„æ°åº¦è½¬åæ°åº¦ï¼šF = C * 9/5 + 32
  let celsius = 25
  let fahrenheit = @clean_test.@clean_test.add(@clean_test.@clean_test.multiply(celsius, 9), 32)
  let fahrenheit_divided = @clean_test.@clean_test.multiply(fahrenheit, 1) // è¿™é‡Œç®€åŒ–ä¸ºæ•´æ•°è¿ç®—
  
  // åæ°åº¦è½¬æ‘„æ°åº¦ï¼šC = (F - 32) * 5/9
  let fahrenheit_back = @clean_test.@clean_test.add(@clean_test.@clean_test.multiply(25, 9), 32) // 25Â°C = 77Â°F
  let celsius_back = @clean_test.@clean_test.multiply(@clean_test.@clean_test.add(fahrenheit_back, -32), 5)
  
  assert_eq(77, fahrenheit_back)
  assert_eq(225, celsius_back) // (77-32)*5 = 225ï¼Œç®€åŒ–è®¡ç®—
}

// æµ‹è¯•å¤åˆè¿ç®—
///|
test "compound_operations" {
  // æµ‹è¯• (a + b) * (c - d) çš„å¤åˆè¿ç®—
  let a = 10
  let b = 20
  let c = 30
  let d = 15
  
  let sum_ab = @clean_test.@clean_test.add(a, b)
  let diff_cd = @clean_test.@clean_test.add(c, -d)
  let result = @clean_test.@clean_test.multiply(sum_ab, diff_cd)
  
  assert_eq(450, result) // (10+20)*(30-15) = 30*15 = 450
  
  // æµ‹è¯•åµŒå¥—è¿ç®—ï¼ša * (b + c * d)
  let x = 5
  let y = 10
  let z = 3
  let w = 4
  
  let inner_mult = @clean_test.@clean_test.multiply(z, w)
  let inner_sum = @clean_test.@clean_test.add(y, inner_mult)
  let final_result = @clean_test.@clean_test.multiply(x, inner_sum)
  
  assert_eq(110, final_result) // 5*(10+3*4) = 5*(10+12) = 5*22 = 110
}

// æµ‹è¯•é”™è¯¯æ¢å¤
///|
test "error_recovery" {
  // æµ‹è¯•æº¢å‡ºåçš„æ¢å¤
  let overflow_result = @clean_test.@clean_test.add(2147483647, 1)  // æº¢å‡º
  assert_eq(2147483647, overflow_result)
  
  // æº¢å‡ºåç»§ç»­è¿ç®—åº”è¯¥æ­£å¸¸
  let recovery = @clean_test.@clean_test.add(overflow_result, -2147483647)
  assert_eq(0, recovery)
  
  // æµ‹è¯•è´Ÿæº¢å‡ºåçš„æ¢å¤
  let negative_overflow = @clean_test.@clean_test.add(-2147483648, -1)  // è´Ÿæº¢å‡º
  assert_eq(-2147483648, negative_overflow)
  
  // è´Ÿæº¢å‡ºåç»§ç»­è¿ç®—
  let negative_recovery = @clean_test.@clean_test.add(negative_overflow, 2147483647)
  assert_eq(-1, negative_recovery)
}

// æµ‹è¯•æç«¯è¾¹ç•Œç»„åˆ
///|
test "extreme_boundary_combinations" {
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•æœ€å¤§å€¼ä¸æœ€å°å€¼çš„å„ç§è¿ç®—ç»„åˆ
  assert_eq(-1, @clean_test.@clean_test.add(max_val, min_val))
  assert_eq(-1, @clean_test.@clean_test.add(min_val, max_val))
  assert_eq(-2147483648, @clean_test.@clean_test.multiply(max_val, min_val))
  assert_eq(-2147483648, @clean_test.@clean_test.multiply(min_val, max_val))
  
  // æµ‹è¯•æ¥è¿‘è¾¹ç•Œçš„å€¼
  let near_max = 2147483646
  let near_min = -2147483647
  
  assert_eq(max_val, @clean_test.@clean_test.add(near_max, 1))
  assert_eq(min_val, @clean_test.@clean_test.add(near_min, -1))
  assert_eq(-2147483648, @clean_test.@clean_test.multiply(near_max, -1))
  assert_eq(2147483647, @clean_test.@clean_test.multiply(near_min, -1))
}

// æµ‹è¯•æ€§èƒ½å‹åŠ›
///|
test "performance_stress" {
  // æµ‹è¯•å¤§é‡è¿ç»­è¿ç®—çš„æ€§èƒ½
  let mut accumulator = 1
  
  // è¿ç»­ä¹˜æ³•è¿ç®—
  for i = 1; i <= 10; i = i + 1 {
    accumulator = @clean_test.@clean_test.multiply(accumulator, i)
  }
  assert_eq(3628800, accumulator) // 10!
  
  // é‡ç½®å¹¶æµ‹è¯•åŠ æ³•
  accumulator = 0
  for i = 1; i <= 100; i = i + 1 {
    accumulator = @clean_test.@clean_test.add(accumulator, i)
  }
  assert_eq(5050, accumulator) // 1+2+...+100
  
  // æµ‹è¯•æ··åˆè¿ç®—
  let mut result = 100
  for i = 1; i <= 5; i = i + 1 {
    result = @clean_test.@clean_test.add(@clean_test.@clean_test.multiply(result, 2), i)
  }
  assert_eq(3231, result) // (((((100*2)+1)*2+2)*2+3)*2+4)*2+5 = 3231
}