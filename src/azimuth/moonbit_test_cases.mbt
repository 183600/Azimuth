// æ–°å¢çš„ MoonBit æµ‹è¯•ç”¨ä¾‹
// è¿™äº›æµ‹è¯•ç”¨ä¾‹æä¾›äº†å¯¹ azimuth åº“çš„é¢å¤–éªŒè¯ï¼Œè¦†ç›–äº†ä¸€äº›æ–°çš„åœºæ™¯

// æµ‹è¯•é˜¶ä¹˜è®¡ç®—ï¼ˆä½¿ç”¨ä¹˜æ³•å®ç°ï¼‰
test "factorial_calculation" {
  // è®¡ç®— 5! = 5 * 4 * 3 * 2 * 1 = 120
  let fact1 = @azimuth.multiply(5, @azimuth.multiply(4, @azimuth.multiply(3, @azimuth.multiply(2, 1))))
  @azimuth.assert_eq(120, fact1)
  
  // è®¡ç®— 4! = 4 * 3 * 2 * 1 = 24
  let fact2 = @azimuth.multiply(4, @azimuth.multiply(3, @azimuth.multiply(2, 1)))
  @azimuth.assert_eq(24, fact2)
  
  // è®¡ç®— 3! = 3 * 2 * 1 = 6
  let fact3 = @azimuth.multiply(3, @azimuth.multiply(2, 1))
  @azimuth.assert_eq(6, fact3)
}

// æµ‹è¯•æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆä½¿ç”¨åŠ æ³•å®ç°ï¼‰
test "fibonacci_sequence" {
  // æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼šF(0)=0, F(1)=1, F(n)=F(n-1)+F(n-2)
  let f0 = 0
  let f1 = 1
  let f2 = @azimuth.add(f1, f0)  // 1
  let f3 = @azimuth.add(f2, f1)  // 2
  let f4 = @azimuth.add(f3, f2)  // 3
  let f5 = @azimuth.add(f4, f3)  // 5
  let f6 = @azimuth.add(f5, f4)  // 8
  let f7 = @azimuth.add(f6, f5)  // 13
  let f8 = @azimuth.add(f7, f6)  // 21
  let f9 = @azimuth.add(f8, f7)  // 34
  let f10 = @azimuth.add(f9, f8) // 55
  
  @azimuth.assert_eq(0, f0)
  @azimuth.assert_eq(1, f1)
  @azimuth.assert_eq(1, f2)
  @azimuth.assert_eq(2, f3)
  @azimuth.assert_eq(3, f4)
  @azimuth.assert_eq(5, f5)
  @azimuth.assert_eq(8, f6)
  @azimuth.assert_eq(13, f7)
  @azimuth.assert_eq(21, f8)
  @azimuth.assert_eq(34, f9)
  @azimuth.assert_eq(55, f10)
}

// æµ‹è¯•å¹³æ–¹å’Œç«‹æ–¹è®¡ç®—
test "power_calculations" {
  // å¹³æ–¹è®¡ç®—ï¼šn^2 = n * n
  @azimuth.assert_eq(0, @azimuth.multiply(0, 0))
  @azimuth.assert_eq(1, @azimuth.multiply(1, 1))
  @azimuth.assert_eq(4, @azimuth.multiply(2, 2))
  @azimuth.assert_eq(9, @azimuth.multiply(3, 3))
  @azimuth.assert_eq(16, @azimuth.multiply(4, 4))
  @azimuth.assert_eq(25, @azimuth.multiply(5, 5))
  @azimuth.assert_eq(100, @azimuth.multiply(10, 10))
  @azimuth.assert_eq(10000, @azimuth.multiply(100, 100))
  
  // ç«‹æ–¹è®¡ç®—ï¼šn^3 = n * n * n
  @azimuth.assert_eq(0, @azimuth.multiply(@azimuth.multiply(0, 0), 0))
  @azimuth.assert_eq(1, @azimuth.multiply(@azimuth.multiply(1, 1), 1))
  @azimuth.assert_eq(8, @azimuth.multiply(@azimuth.multiply(2, 2), 2))
  @azimuth.assert_eq(27, @azimuth.multiply(@azimuth.multiply(3, 3), 3))
  @azimuth.assert_eq(64, @azimuth.multiply(@azimuth.multiply(4, 4), 4))
  @azimuth.assert_eq(125, @azimuth.multiply(@azimuth.multiply(5, 5), 5))
}

// æµ‹è¯•å¹³å‡æ•°è®¡ç®—
test "average_calculation" {
  // è®¡ç®—ä¸¤ä¸ªæ•°çš„å¹³å‡æ•°ï¼š(a + b) / 2
  let avg1 = @azimuth.add(10, 20) / 2
  @azimuth.assert_eq(15, avg1)
  
  let avg2 = @azimuth.add(5, 9) / 2
  @azimuth.assert_eq(7, avg2)  // æ•´æ•°é™¤æ³•ï¼Œå‘ä¸‹å–æ•´
  
  let avg3 = @azimuth.add(-5, 5) / 2
  @azimuth.assert_eq(0, avg3)
  
  // è®¡ç®—ä¸‰ä¸ªæ•°çš„å¹³å‡æ•°ï¼š(a + b + c) / 3
  let avg4 = @azimuth.add(@azimuth.add(10, 20), 30) / 3
  @azimuth.assert_eq(20, avg4)
  
  let avg5 = @azimuth.add(@azimuth.add(1, 2), 3) / 3
  @azimuth.assert_eq(2, avg5)
}

// æµ‹è¯•å­—ç¬¦ä¸²é•¿åº¦å’Œå¤æ‚åº¦
test "string_complexity_tests" {
  // æµ‹è¯•å•å­—ç¬¦å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, A!", @azimuth.greet("A"))
  @azimuth.assert_eq_string("Hello, a!", @azimuth.greet("a"))
  @azimuth.assert_eq_string("Hello, 1!", @azimuth.greet("1"))
  @azimuth.assert_eq_string("Hello, !", @azimuth.greet("!"))
  
  // æµ‹è¯•åŒ…å«å„ç§ç‰¹æ®Šå­—ç¬¦çš„å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, ğŸš€!", @azimuth.greet("ğŸš€"))
  @azimuth.assert_eq_string("Hello, \n!", @azimuth.greet("\n"))
  @azimuth.assert_eq_string("Hello, \t!", @azimuth.greet("\t"))
  @azimuth.assert_eq_string("Hello, \\!", @azimuth.greet("\\"))
  
  // æµ‹è¯•åŒ…å«æ•°å­—å’Œå­—æ¯æ··åˆçš„å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, abc123!", @azimuth.greet("abc123"))
  @azimuth.assert_eq_string("Hello, 123abc!", @azimuth.greet("123abc"))
  @azimuth.assert_eq_string("Hello, a1b2c3!", @azimuth.greet("a1b2c3"))
}

// æµ‹è¯•é€’å½’è®¡ç®—åœºæ™¯ï¼ˆæ¨¡æ‹Ÿé€’å½’ï¼‰
test "recursive_calculation_simulation" {
  // æ¨¡æ‹Ÿé€’å½’è®¡ç®—ï¼šsum(n) = n + sum(n-1), sum(0) = 0
  // è®¡ç®— sum(5) = 5 + 4 + 3 + 2 + 1 + 0 = 15
  let sum5 = @azimuth.add(5, @azimuth.add(4, @azimuth.add(3, @azimuth.add(2, @azimuth.add(1, 0)))))
  @azimuth.assert_eq(15, sum5)
  
  // è®¡ç®— sum(4) = 4 + 3 + 2 + 1 + 0 = 10
  let sum4 = @azimuth.add(4, @azimuth.add(3, @azimuth.add(2, @azimuth.add(1, 0))))
  @azimuth.assert_eq(10, sum4)
  
  // æ¨¡æ‹Ÿé€’å½’è®¡ç®—ï¼špow(n, m) = n * pow(n, m-1), pow(n, 0) = 1
  // è®¡ç®— pow(2, 4) = 2 * 2 * 2 * 2 * 1 = 16
  let pow2_4 = @azimuth.multiply(2, @azimuth.multiply(2, @azimuth.multiply(2, @azimuth.multiply(2, 1))))
  @azimuth.assert_eq(16, pow2_4)
  
  // è®¡ç®— pow(3, 3) = 3 * 3 * 3 * 1 = 27
  let pow3_3 = @azimuth.multiply(3, @azimuth.multiply(3, @azimuth.multiply(3, 1)))
  @azimuth.assert_eq(27, pow3_3)
}

// æµ‹è¯•æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰è®¡ç®—ï¼ˆæ¬§å‡ é‡Œå¾—ç®—æ³•æ¨¡æ‹Ÿï¼‰
test "gcd_calculation" {
  // GCD(48, 18) = GCD(18, 48 % 18) = GCD(18, 12) = GCD(12, 6) = GCD(6, 0) = 6
  // ç”±äºæˆ‘ä»¬æ²¡æœ‰æ¨¡è¿ç®—ï¼Œæˆ‘ä»¬ä½¿ç”¨å‡æ³•æ¨¡æ‹Ÿ
  let a = 48
  let b = 18
  // 48 - 18*2 = 12
  let remainder = @azimuth.add(a, @azimuth.multiply(-2, b))
  // 18 - 12 = 6
  let remainder2 = @azimuth.add(b, -remainder)
  @azimuth.assert_eq(6, remainder2)
  
  // GCD(60, 25) = GCD(25, 60 % 25) = GCD(25, 10) = GCD(10, 5) = GCD(5, 0) = 5
  let c = 60
  let d = 25
  // 60 - 25*2 = 10
  let remainder3 = @azimuth.add(c, @azimuth.multiply(-2, d))
  // 25 - 10*2 = 5
  let remainder4 = @azimuth.add(d, @azimuth.multiply(-2, remainder3))
  @azimuth.assert_eq(5, remainder4)
}

// æµ‹è¯•ç™¾åˆ†æ¯”å’Œæ¯”ä¾‹è®¡ç®—
test "percentage_and_ratio_calculations" {
  // è®¡ç®—ç™¾åˆ†æ¯”ï¼švalue * percentage / 100
  let value = 500
  let percentage = 20  // 20%
  let result = @azimuth.multiply(value, percentage) / 100
  @azimuth.assert_eq(100, result)  // 500 * 20 / 100 = 100
  
  // è®¡ç®—å¦ä¸€ä¸ªç™¾åˆ†æ¯”
  let value2 = 1200
  let percentage2 = 15  // 15%
  let result2 = @azimuth.multiply(value2, percentage2) / 100
  @azimuth.assert_eq(180, result2)  // 1200 * 15 / 100 = 180
  
  // è®¡ç®—æ¯”ä¾‹ï¼ša / b = c / d => a * d = b * c
  // å¦‚æœ 3/4 = x/20ï¼Œé‚£ä¹ˆ x = 3 * 20 / 4 = 15
  let a = 3
  let b = 4
  let d = 20
  let x = @azimuth.multiply(a, d) / b
  @azimuth.assert_eq(15, x)
}

// æµ‹è¯•åˆ©æ¯è®¡ç®—ï¼ˆé‡‘èåº”ç”¨ï¼‰
test "interest_calculation" {
  // ç®€å•åˆ©æ¯ï¼šæœ¬é‡‘ * åˆ©ç‡ * æ—¶é—´
  let principal = 1000  // æœ¬é‡‘
  let rate = 5  // å¹´åˆ©ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰
  let time = 3  // å¹´æ•°
  
  // è®¡ç®—åˆ©æ¯ï¼š1000 * 5% * 3 = 1000 * 5 / 100 * 3 = 150
  let interest = @azimuth.multiply(@azimuth.multiply(principal, rate) / 100, time)
  @azimuth.assert_eq(150, interest)
  
  // è®¡ç®—æœ¬æ¯å’Œï¼šæœ¬é‡‘ + åˆ©æ¯
  let total = @azimuth.add(principal, interest)
  @azimuth.assert_eq(1150, total)
  
  // å¤åˆ©è®¡ç®—ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼šæœ¬æ¯å’Œ = æœ¬é‡‘ * (1 + åˆ©ç‡)^æ—¶é—´
  // å¯¹äº3å¹´ï¼Œæœ¬æ¯å’Œ = æœ¬é‡‘ * (1 + åˆ©ç‡) * (1 + åˆ©ç‡) * (1 + åˆ©ç‡)
  // è¿™é‡Œæˆ‘ä»¬ç®€åŒ–è®¡ç®—ï¼Œä¸ä½¿ç”¨çœŸæ­£çš„å¤åˆ©å…¬å¼
  let compound_interest = @azimuth.multiply(principal, 105) / 100  // ç¬¬ä¸€å¹´
  let compound_interest2 = @azimuth.multiply(compound_interest, 105) / 100  // ç¬¬äºŒå¹´
  let compound_interest3 = @azimuth.multiply(compound_interest2, 105) / 100  // ç¬¬ä¸‰å¹´
  @azimuth.assert_eq(1157, compound_interest3)  // å‘ä¸‹å–æ•´
}