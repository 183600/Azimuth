// é¢å¤–çš„è¾¹ç•Œæƒ…å†µæµ‹è¯• - è¡¥å……ç°æœ‰æµ‹è¯•çš„è¦†ç›–èŒƒå›´

///|
test "add_chained_operations" {
  // æµ‹è¯•è¿ç»­åŠ æ³•æ“ä½œçš„ç¨³å®šæ€§
  let mut result = 1000
  result = add(result, 2000)  // 3000
  result = add(result, -1000) // 2000
  result = add(result, 47)    // 2047
  result = add(result, -48)   // 1999
  assert_eq(1999, result)
}

///|
test "multiply_chained_operations" {
  // æµ‹è¯•è¿ç»­ä¹˜æ³•æ“ä½œçš„ç¨³å®šæ€§
  let mut result = 2
  result = multiply(result, 3)   // 6
  result = multiply(result, 4)   // 24
  result = multiply(result, 5)   // 120
  result = multiply(result, 0)   // 0
  result = multiply(result, 100) // 0
  assert_eq(0, result)
}

///|
test "mixed_operations_stability" {
  // æµ‹è¯•æ··åˆè¿ç®—çš„ç¨³å®šæ€§
  let a = add(100, 200)        // 300
  let b = multiply(a, 2)       // 600
  let c = add(b, -100)         // 500
  let d = multiply(c, 0)       // 0
  let e = add(d, 42)           // 42
  assert_eq(42, e)
}

///|
test "greet_long_string" {
  // æµ‹è¯•é•¿å­—ç¬¦ä¸²çš„å¤„ç†
  let long_name = "ThisIsAVeryLongNameThatMightCauseIssuesInSomeSystemsButShouldWorkFineInMoonBit"
  let expected = "Hello, " + long_name + "!"
  assert_eq(expected, greet(long_name))
}

///|
test "greet_unicode_and_emoji" {
  // æµ‹è¯•Unicodeå’Œemojiå­—ç¬¦
  assert_eq("Hello, ğŸŒ™!", greet("ğŸŒ™"))
  assert_eq("Hello, ğŸš€!", greet("ğŸš€"))
  assert_eq("Hello, Ã±Ã¡Ã©Ã­Ã³Ãº!", greet("Ã±Ã¡Ã©Ã­Ã³Ãº"))
}

///|
test "add_extreme_boundary_combinations" {
  // æµ‹è¯•æç«¯è¾¹ç•Œå€¼çš„ç»„åˆ
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æœ€å¤§å€¼å‡å»è‡ªèº«
  assert_eq(0, add(max_val, -max_val))
  
  // æœ€å°å€¼å‡å»è‡ªèº«
  assert_eq(-1, add(min_val, 2147483647)) // -2147483648 + 2147483647 = -1
  
  // æ¥è¿‘è¾¹ç•Œçš„å€¼
  assert_eq(2147483646, add(1073741823, 1073741823))
  assert_eq(-2147483647, add(-1073741824, -1073741823))
}

///|
test "multiply_power_of_two" {
  // æµ‹è¯•2çš„å¹‚æ¬¡æ–¹ä¹˜æ³•
  assert_eq(2, multiply(1, 2))
  assert_eq(4, multiply(2, 2))
  assert_eq(8, multiply(4, 2))
  assert_eq(16, multiply(8, 2))
  assert_eq(32, multiply(16, 2))
  
  // æµ‹è¯•2çš„å¹‚æ¬¡æ–¹çš„æº¢å‡º
  assert_eq(2147483647, multiply(1073741824, 2))
  assert_eq(2147483647, multiply(1073741824, 3))
}

///|
test "multiply_negative_power_patterns" {
  // æµ‹è¯•è´Ÿæ•°çš„ä¹˜æ³•æ¨¡å¼
  assert_eq(1, multiply(-1, -1))
  assert_eq(-1, multiply(-1, 1))
  assert_eq(-1, multiply(1, -1))
  
  // è´Ÿæ•°çš„è¿ç»­ä¹˜æ³•
  let mut result = -2
  result = multiply(result, -2)  // 4
  result = multiply(result, -2)  // -8
  result = multiply(result, -2)  // 16
  assert_eq(16, result)
}

///|
test "greet_whitespace_handling" {
  // æµ‹è¯•å„ç§ç©ºç™½å­—ç¬¦çš„å¤„ç†
  assert_eq("Hello, \t!", greet("\t"))
  assert_eq("Hello, \n!", greet("\n"))
  assert_eq("Hello, \r!", greet("\r"))
  assert_eq("Hello,  \t !", greet(" \t "))
  assert_eq("Hello,  leading!", greet(" leading"))
  assert_eq("Hello, trailing !", greet("trailing "))
}

///|
test "stress_test_repeated_operations" {
  // å‹åŠ›æµ‹è¯•ï¼šé‡å¤æ“ä½œ
  let mut sum = 0
  // é‡å¤åŠ 1ç„¶åå‡1
  for i = 0; i < 100; i = i + 1 {
    sum = add(sum, 1)
    sum = add(sum, -1)
  }
  assert_eq(0, sum)
  
  // é‡å¤ä¹˜2ç„¶åé™¤2ï¼ˆé€šè¿‡ä¹˜0.5çš„æ•´æ•°è¿‘ä¼¼ï¼‰
  let mut product = 100
  product = multiply(product, 2)    // 200
  product = multiply(product, 0)    // 0
  product = multiply(product, 100)  // 0
  assert_eq(0, product)
}