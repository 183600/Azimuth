// é™„åŠ çš„ MoonBit æµ‹è¯•ç”¨ä¾‹
// ä¸º azimuth é¡¹ç›®æ·»åŠ é¢å¤–çš„æµ‹è¯•è¦†ç›–

test "sequence_operations_test" {
  // æµ‹è¯•åºåˆ—æ“ä½œ
  // è®¡ç®—ç­‰å·®æ•°åˆ—å‰né¡¹å’Œ
  let n = 10
  let first_term = 1
  let common_diff = 2
  
  // ä½¿ç”¨å…¬å¼ï¼šn/2 * (2a1 + (n-1)d)
  let sum = @azimuth.multiply(n, @azimuth.add(@azimuth.multiply(2, first_term), @azimuth.multiply(n - 1, common_diff))) / 2
  @azimuth.assert_eq(100, sum)  // 1+3+5+...+19 = 100
  
  // è®¡ç®—ç­‰æ¯”æ•°åˆ—å‰né¡¹ç§¯ï¼ˆç®€åŒ–ç‰ˆï¼‰
  let ratio = 2
  let product = @azimuth.multiply(@azimuth.multiply(@azimuth.multiply(2, 4), 8), 16)
  @azimuth.assert_eq(1024, product)  // 2*4*8*16 = 1024
}

test "string_processing_advanced" {
  // æµ‹è¯•é«˜çº§å­—ç¬¦ä¸²å¤„ç†
  // æµ‹è¯•å„ç§ç‰¹æ®Šå­—ç¬¦ç»„åˆ
  @azimuth.assert_eq_string("Hello, \"John\"!", @azimuth.greet("\"John\""))
  @azimuth.assert_eq_string("Hello, O'Reilly!", @azimuth.greet("O'Reilly"))
  @azimuth.assert_eq_string("Hello, C:\\Program Files!", @azimuth.greet("C:\\Program Files"))
  
  // æµ‹è¯•å¤šè¯­è¨€å­—ç¬¦
  @azimuth.assert_eq_string("Hello, ĞœĞ¾ÑĞºĞ²Ğ°!", @azimuth.greet("ĞœĞ¾ÑĞºĞ²Ğ°"))
  @azimuth.assert_eq_string("Hello, æ±äº¬!", @azimuth.greet("æ±äº¬"))
  @azimuth.assert_eq_string("Hello, ğŸš€ğŸŒŸ!", @azimuth.greet("ğŸš€ğŸŒŸ"))
  
  // æµ‹è¯•é•¿å­—ç¬¦ä¸²
  let long_string = "ThisIsAVeryLongStringThatTestsTheGreetFunctionsWithExtendedInputLength"
  let expected = "Hello, " + long_string + "!"
  @azimuth.assert_eq_string(expected, @azimuth.greet(long_string))
}

test "financial_calculations" {
  // æµ‹è¯•é‡‘èè®¡ç®—åœºæ™¯
  // ç®€å•åˆ©æ¯è®¡ç®—ï¼šæœ¬é‡‘ Ã— å¹´åˆ©ç‡ Ã— å¹´æ•°
  let principal = 10000
  let annual_rate = 5  // 5%
  let years = 3
  
  let simple_interest = @azimuth.multiply(@azimuth.multiply(principal, annual_rate), years)
  let total_amount = @azimuth.add(principal, simple_interest)
  @azimuth.assert_eq(160000, total_amount)  // 10000 + 10000*5*3 = 160000
  
  // åˆ†æœŸä»˜æ¬¾è®¡ç®—
  let loan_amount = 12000
  let months = 12
  let monthly_payment = @azimuth.divide_with_ceil(loan_amount, months)
  @azimuth.assert_eq(1000, monthly_payment)
  
  // å®é™…æ”¯ä»˜æ€»é¢ï¼ˆå‘ä¸Šå–æ•´å¯èƒ½å¯¼è‡´é¢å¤–æ”¯ä»˜ï¼‰
  let actual_total = @azimuth.multiply(monthly_payment, months)
  @azimuth.assert_eq(12000, actual_total)
}

test "geometry_calculations_extended" {
  // æµ‹è¯•æ‰©å±•å‡ ä½•è®¡ç®—
  // æ¢¯å½¢é¢ç§¯ï¼š(ä¸Šåº• + ä¸‹åº•) Ã— é«˜ Ã· 2
  let top_base = 8
  let bottom_base = 12
  let height = 5
  
  let trapezoid_area = @azimuth.multiply(@azimuth.add(top_base, bottom_base), height) / 2
  @azimuth.assert_eq(50, trapezoid_area)  // (8+12)*5/2 = 50
  
  // åœ†æŸ±ä½“ç§¯ï¼ˆç®€åŒ–ï¼‰ï¼šåº•é¢ç§¯ Ã— é«˜ï¼Œå…¶ä¸­åº•é¢ç§¯ = Ï€ Ã— rÂ² â‰ˆ 3 Ã— rÂ²
  let radius = 4
  let cylinder_height = 10
  
  let base_area = @azimuth.multiply(3, @azimuth.multiply(radius, radius))
  let volume = @azimuth.multiply(base_area, cylinder_height)
  @azimuth.assert_eq(480, volume)  // 3*16*10 = 480
  
  // è¡¨é¢ç§¯è®¡ç®—ï¼ˆç®€åŒ–ï¼‰
  let surface_area = @azimuth.add(@azimuth.multiply(2, base_area), @azimuth.multiply(@azimuth.multiply(2, 3), radius))
  @azimuth.assert_eq(144, surface_area)  // 2*48 + 2*3*4 = 96 + 24 = 120
}

test "algorithmic_patterns" {
  // æµ‹è¯•ç®—æ³•æ¨¡å¼
  // æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—ï¼ˆå‰å‡ é¡¹ï¼‰
  let fib1 = 1
  let fib2 = 1
  let fib3 = @azimuth.add(fib1, fib2)  // 2
  let fib4 = @azimuth.add(fib2, fib3)  // 3
  let fib5 = @azimuth.add(fib3, fib4)  // 5
  let fib6 = @azimuth.add(fib4, fib5)  // 8
  
  @azimuth.assert_eq(2, fib3)
  @azimuth.assert_eq(3, fib4)
  @azimuth.assert_eq(5, fib5)
  @azimuth.assert_eq(8, fib6)
  
  // æœ€å¤§å…¬çº¦æ•°æ¨¡æ‹Ÿï¼ˆæ¬§å‡ é‡Œå¾—ç®—æ³•ç®€åŒ–ç‰ˆï¼‰
  let a = 48
  let b = 18
  // 48 % 18 = 12, 18 % 12 = 6, 12 % 6 = 0ï¼Œæ‰€ä»¥GCDæ˜¯6
  let gcd = 6  // é¢„è®¡ç®—ç»“æœ
  @azimuth.assert_eq(6, gcd)
  
  // éªŒè¯å…¬çº¦æ•°æ€§è´¨
  @azimuth.assert_eq(0, a % gcd)
  @azimuth.assert_eq(0, b % gcd)
}

test "data_structure_operations" {
  // æµ‹è¯•æ•°æ®ç»“æ„æ“ä½œæ¨¡æ‹Ÿ
  // æ ˆæ“ä½œæ¨¡æ‹Ÿï¼ˆä½¿ç”¨æ•°ç»„ç´¢å¼•ï¼‰
  let stack_size = 5
  let push_count = 3
  let pop_count = 2
  
  let final_size = @azimuth.add(stack_size, push_count - pop_count)
  @azimuth.assert_eq(6, final_size)  // 5 + 3 - 2 = 6
  
  // é˜Ÿåˆ—æ“ä½œæ¨¡æ‹Ÿ
  let queue_capacity = 10
  let enqueue_count = 7
  let dequeue_count = 4
  
  let queue_size = @azimuth.add(enqueue_count, -dequeue_count)
  @azimuth.assert_true(queue_size <= queue_capacity)
  @azimuth.assert_eq(3, queue_size)  // 7 - 4 = 3
  
  // å“ˆå¸Œè¡¨è´Ÿè½½å› å­è®¡ç®—
  let table_size = 16
  let entries = 12
  let load_factor = @azimuth.multiply(entries, 100) / table_size
  @azimuth.assert_eq(75, load_factor)  // 12*100/16 = 75
}

test "performance_optimization_scenarios" {
  // æµ‹è¯•æ€§èƒ½ä¼˜åŒ–åœºæ™¯
  // æ‰¹é‡æ“ä½œä¼˜åŒ–
  let batch_size = 100
  let operation_count = 1000
  let optimized_operations = operation_count / batch_size
  
  @azimuth.assert_eq(10, optimized_operations)
  
  // ç¼“å­˜å‘½ä¸­ç‡è®¡ç®—
  let cache_requests = 1000
  let cache_hits = 850
  let hit_rate = @azimuth.multiply(cache_hits, 100) / cache_requests
  @azimuth.assert_eq(85, hit_rate)
  
  // å†…å­˜ä½¿ç”¨è®¡ç®—
  let object_size = 24
  let object_count = 1000
  let total_memory = @azimuth.multiply(object_size, object_count)
  @azimuth.assert_eq(24000, total_memory)
  
  // åˆ†é¡µè®¡ç®—
  let total_items = 258
  let page_size = 50
  let total_pages = @azimuth.divide_with_ceil(total_items, page_size)
  @azimuth.assert_eq(6, total_pages)  // 258/50 = 5.16ï¼Œå‘ä¸Šå–æ•´ä¸º6
}

test "error_boundary_conditions" {
  // æµ‹è¯•é”™è¯¯è¾¹ç•Œæ¡ä»¶
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æå€¼åŠ æ³•ç»„åˆ
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, max_val))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, min_val))
  @azimuth.assert_eq(-1, @azimuth.add(max_val, min_val))
  
  // æå€¼ä¹˜æ³•ç»„åˆ
  @azimuth.assert_eq(max_val, @azimuth.multiply(max_val, 1))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 1))
  @azimuth.assert_eq(min_val, @azimuth.multiply(max_val, -1))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, -1))
  
  // é™¤é›¶ä¿æŠ¤ï¼ˆé€šè¿‡divide_with_ceilå‡½æ•°ï¼‰
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(0, 1))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(0, 100))
  
  // è´Ÿæ•°é™¤æ³•å‘ä¸Šå–æ•´
  @azimuth.assert_eq(-2, @azimuth.divide_with_ceil(-5, 3))
  @azimuth.assert_eq(-1, @azimuth.divide_with_ceil(-2, 3))
}

test "integration_composite_test" {
  // æµ‹è¯•é›†æˆå¤åˆåœºæ™¯
  // ç”µå•†è®¢å•å¤„ç†å®Œæ•´æµç¨‹
  let product_price = 199
  let quantity = 3
  let customer_level = 2  // VIPç­‰çº§
  let base_shipping = 15
  
  // è®¡ç®—å•†å“æ€»ä»·
  let subtotal = @azimuth.multiply(product_price, quantity)
  
  // æ ¹æ®VIPç­‰çº§è®¡ç®—æŠ˜æ‰£
  let discount_rate = @azimuth.multiply(customer_level, 5)  // æ¯çº§5%æŠ˜æ‰£
  let discount_amount = @azimuth.multiply(subtotal, discount_rate) / 100
  let discounted_price = @azimuth.add(subtotal, -discount_amount)
  
  // è®¡ç®—è¿è´¹ï¼ˆVIPå…è¿è´¹ï¼‰
  let shipping = if (customer_level >= 2) { 0 } else { base_shipping }
  
  // è®¡ç®—ç¨è´¹ï¼ˆç®€åŒ–ä¸º8%ï¼‰
  let tax_rate = 8
  let tax_amount = @azimuth.multiply(discounted_price, tax_rate) / 100
  
  // è®¡ç®—æœ€ç»ˆæ€»ä»·
  let final_total = @azimuth.add(@azimuth.add(discounted_price, tax_amount), shipping)
  
  // éªŒè¯ç»“æœï¼š199*3 = 597ï¼ŒVIP2çº§10%æŠ˜æ‰£ = 59.7ï¼Œå®ä»˜537.3ï¼Œç¨è´¹42.984ï¼Œå…è¿è´¹ï¼Œæ€»è®¡çº¦580
  @azimuth.assert_eq(580, final_total)
  
  // æµ‹è¯•æ™®é€šç”¨æˆ·ï¼ˆæ— æŠ˜æ‰£ï¼Œæœ‰è¿è´¹ï¼‰
  let normal_total = @azimuth.add(@azimuth.add(subtotal, @azimuth.multiply(subtotal, tax_rate) / 100), base_shipping)
  @azimuth.assert_eq(663, normal_total)
}

test "state_machine_simulation" {
  // æµ‹è¯•çŠ¶æ€æœºæ¨¡æ‹Ÿ
  // ç®€å•çš„è®¢å•çŠ¶æ€æœºï¼šå¾…å¤„ç† -> å¤„ç†ä¸­ -> å·²å®Œæˆ -> å·²è¯„ä»·
  
  let state_pending = 0
  let state_processing = 1
  let state_completed = 2
  let state_reviewed = 3
  
  // çŠ¶æ€è½¬æ¢
  let current_state = state_pending
  
  // å¾…å¤„ç† -> å¤„ç†ä¸­
  current_state = if (current_state == state_pending) { state_processing } else { current_state }
  @azimuth.assert_eq(state_processing, current_state)
  
  // å¤„ç†ä¸­ -> å·²å®Œæˆ
  current_state = if (current_state == state_processing) { state_completed } else { current_state }
  @azimuth.assert_eq(state_completed, current_state)
  
  // å·²å®Œæˆ -> å·²è¯„ä»·
  current_state = if (current_state == state_completed) { state_reviewed } else { current_state }
  @azimuth.assert_eq(state_reviewed, current_state)
  
  // æµ‹è¯•çŠ¶æ€è®¡æ•°
  let total_states = 4
  let completed_states = @azimuth.add(current_state, 1)  // çŠ¶æ€ä»0å¼€å§‹ï¼Œæ‰€ä»¥+1
  @azimuth.assert_eq(total_states, completed_states)
  
  // æµ‹è¯•çŠ¶æ€è½¬æ¢æ¡ä»¶
  let can_review = (current_state == state_completed)
  let can_cancel = (current_state == state_pending || current_state == state_processing)
  
  @azimuth.assert_false(can_review)  // å·²ç»è¯„ä»·ï¼Œä¸èƒ½å†è¯„ä»·
  @azimuth.assert_false(can_cancel)  // å·²ç»è¯„ä»·ï¼Œä¸èƒ½å–æ¶ˆ
}