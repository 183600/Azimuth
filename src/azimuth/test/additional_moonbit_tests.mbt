// é¢å¤–çš„ MoonBit æµ‹è¯•ç”¨ä¾‹
// æµ‹è¯• azimuth åŒ…çš„å„ç§åŠŸèƒ½

test "integer_overflow_protection" {
  // æµ‹è¯•æ•´æ•°æº¢å‡ºä¿æŠ¤
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•åŠ æ³•æº¢å‡ºä¿æŠ¤
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, 1))
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, max_val))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, -1))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, min_val))
  
  // æµ‹è¯•ä¹˜æ³•æº¢å‡ºä¿æŠ¤
  @azimuth.assert_eq(max_val, @azimuth.multiply(max_val, 2))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 2))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, -1))
}

test "mathematical_properties_validation" {
  // æµ‹è¯•æ•°å­¦æ€§è´¨éªŒè¯
  let a = 15
  let b = 7
  let c = 3
  
  // åŠ æ³•äº¤æ¢å¾‹
  @azimuth.assert_eq(@azimuth.add(a, b), @azimuth.add(b, a))
  
  // ä¹˜æ³•äº¤æ¢å¾‹
  @azimuth.assert_eq(@azimuth.multiply(a, b), @azimuth.multiply(b, a))
  
  // åŠ æ³•ç»“åˆå¾‹
  @azimuth.assert_eq(@azimuth.add(@azimuth.add(a, b), c), @azimuth.add(a, @azimuth.add(b, c)))
  
  // ä¹˜æ³•ç»“åˆå¾‹
  @azimuth.assert_eq(@azimuth.multiply(@azimuth.multiply(a, b), c), @azimuth.multiply(a, @azimuth.multiply(b, c)))
  
  // åˆ†é…å¾‹
  @azimuth.assert_eq(@azimuth.multiply(a, @azimuth.add(b, c)), @azimuth.add(@azimuth.multiply(a, b), @azimuth.multiply(a, c)))
}

test "string_processing_edge_cases" {
  // æµ‹è¯•å­—ç¬¦ä¸²å¤„ç†çš„è¾¹ç•Œæƒ…å†µ
  // ç©ºå­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, !", @azimuth.greet(""))
  
  // å•å­—ç¬¦
  @azimuth.assert_eq_string("Hello, A!", @azimuth.greet("A"))
  
  // é•¿å­—ç¬¦ä¸²
  let long_name = "ThisIsAVeryLongNameThatTestsStringHandlingCapabilities"
  @azimuth.assert_eq_string("Hello, " + long_name + "!", @azimuth.greet(long_name))
  
  // åŒ…å«ç‰¹æ®Šå­—ç¬¦
  @azimuth.assert_eq_string("Hello, @#$%^&*()!", @azimuth.greet("@#$%^&*()"))
  
  // åŒ…å«Unicodeå­—ç¬¦
  @azimuth.assert_eq_string("Hello, ğŸŒ!", @azimuth.greet("ğŸŒ"))
  @azimuth.assert_eq_string("Hello, æµ‹è¯•!", @azimuth.greet("æµ‹è¯•"))
}

test "financial_calculations" {
  // æµ‹è¯•å®é™…é‡‘èè®¡ç®—åœºæ™¯
  // è´·æ¬¾è®¡ç®—ï¼šæœˆä¾› = (æœ¬é‡‘ Ã— æœˆåˆ©ç‡ Ã— (1 + æœˆåˆ©ç‡)^æœˆæ•°) / ((1 + æœˆåˆ©ç‡)^æœˆæ•° - 1)
  // ç®€åŒ–ç‰ˆæœ¬ï¼šæœˆä¾› = æœ¬é‡‘ / æœˆæ•° + åˆ©æ¯
  let principal = 120000  // æœ¬é‡‘
  let months = 360        // 30å¹´ = 360ä¸ªæœˆ
  let annual_rate = 5     // å¹´åˆ©ç‡5%
  let monthly_rate = annual_rate / 12  // æœˆåˆ©ç‡ï¼ˆç®€åŒ–ï¼‰
  
  // ç®€åŒ–çš„æœˆä¾›è®¡ç®—
  let monthly_principal = principal / months
  let first_month_interest = principal * monthly_rate / 100
  let first_month_payment = @azimuth.add(monthly_principal, first_month_interest)
  
  @azimuth.assert_eq(233, first_month_payment)  // 120000/360 + 120000*5/1200 = 333 + 500 = 833, å–æ•´æ•°éƒ¨åˆ†
  
  // æ€»è¿˜æ¬¾é¢ï¼ˆç®€åŒ–ï¼‰
  let total_payment = @azimuth.multiply(first_month_payment, months)
  @azimuth.assert_eq(83880, total_payment)
}

test "physics_simulation" {
  // æµ‹è¯•ç‰©ç†æ¨¡æ‹Ÿè®¡ç®—
  // è‡ªç”±è½ä½“è¿åŠ¨ï¼šh = h0 - 0.5 * g * t^2
  // ç®€åŒ–ç‰ˆæœ¬ï¼šh = h0 - g * t^2ï¼ˆé¿å…å°æ•°ï¼‰
  let initial_height = 1000  // åˆå§‹é«˜åº¦
  let gravity = 10           // é‡åŠ›åŠ é€Ÿåº¦ï¼ˆç®€åŒ–ï¼‰
  let time = 5               // æ—¶é—´
  
  let time_squared = @azimuth.multiply(time, time)  // t^2 = 25
  let distance_fallen = @azimuth.multiply(gravity, time_squared)  // g * t^2 = 250
  let current_height = @azimuth.add(initial_height, -distance_fallen)  // h0 - g * t^2 = 750
  
  @azimuth.assert_eq(750, current_height)
  
  // é€Ÿåº¦è®¡ç®—ï¼šv = g * t
  let velocity = @azimuth.multiply(gravity, time)
  @azimuth.assert_eq(50, velocity)
  
  // åŠ¨èƒ½è®¡ç®—ï¼šE = 0.5 * m * v^2
  // ç®€åŒ–ç‰ˆæœ¬ï¼šE = m * v^2
  let mass = 10
  let kinetic_energy = @azimuth.multiply(mass, @azimuth.multiply(velocity, velocity))
  @azimuth.assert_eq(25000, kinetic_energy)
}

test "data_structure_operations" {
  // æµ‹è¯•æ•°æ®ç»“æ„æ“ä½œï¼ˆæ¨¡æ‹Ÿï¼‰
  // æ ˆæ“ä½œï¼špush, pop
  let mut stack_size = 0
  
  // pushæ“ä½œ
  stack_size = @azimuth.add(stack_size, 1)  // push value1
  @azimuth.assert_eq(1, stack_size)
  
  stack_size = @azimuth.add(stack_size, 1)  // push value2
  @azimuth.assert_eq(2, stack_size)
  
  stack_size = @azimuth.add(stack_size, 1)  // push value3
  @azimuth.assert_eq(3, stack_size)
  
  // popæ“ä½œ
  stack_size = @azimuth.add(stack_size, -1)  // pop value3
  @azimuth.assert_eq(2, stack_size)
  
  stack_size = @azimuth.add(stack_size, -1)  // pop value2
  @azimuth.assert_eq(1, stack_size)
  
  stack_size = @azimuth.add(stack_size, -1)  // pop value1
  @azimuth.assert_eq(0, stack_size)
}

test "statistical_analysis" {
  // æµ‹è¯•ç»Ÿè®¡åˆ†æå‡½æ•°
  // æ•°æ®é›†ï¼š15, 25, 35, 45, 55, 65, 75, 85, 95
  
  // è®¡ç®—æ€»å’Œ
  let sum = @azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(15, 25), 35), 45), 55), 65), 75), 85), 95)
  @azimuth.assert_eq(495, sum)
  
  // è®¡ç®—å¹³å‡å€¼
  let count = 9
  let mean = sum / count
  @azimuth.assert_eq(55, mean)
  
  // è®¡ç®—ä¸­ä½æ•°ï¼ˆå¥‡æ•°ä¸ªæ•°æ®ç‚¹ï¼‰
  let median = 55
  @azimuth.assert_eq(55, median)
  
  // è®¡ç®—èŒƒå›´
  let min_val = 15
  let max_val = 95
  let range = @azimuth.add(max_val, -min_val)
  @azimuth.assert_eq(80, range)
}

test "game_mechanics" {
  // æµ‹è¯•æ¸¸æˆæœºåˆ¶æ¨¡æ‹Ÿ
  // RPGæ¸¸æˆä¼¤å®³è®¡ç®—
  let base_damage = 100
  let weapon_damage = 50
  let strength = 20
  let enemy_defense = 30
  
  // åŸºç¡€ä¼¤å®³è®¡ç®—
  let total_damage = @azimuth.add(@azimuth.add(base_damage, weapon_damage), strength)
  @azimuth.assert_eq(170, total_damage)
  
  // è€ƒè™‘é˜²å¾¡çš„å®é™…ä¼¤å®³
  let actual_damage = @azimuth.add(total_damage, -enemy_defense)
  @azimuth.assert_eq(140, actual_damage)
  
  // ç»éªŒå€¼è®¡ç®—
  let base_exp = 200
  let level_multiplier = 3
  let exp_gained = @azimuth.multiply(base_exp, level_multiplier)
  @azimuth.assert_eq(600, exp_gained)
  
  // å‡çº§æ‰€éœ€ç»éªŒ
  let current_level = 5
  let exp_to_next_level = @azimuth.multiply(current_level, 1000)
  @azimuth.assert_eq(5000, exp_to_next_level)
}

test "encryption_simulation" {
  // æµ‹è¯•åŠ å¯†æ¨¡æ‹Ÿï¼ˆç®€åŒ–ç‰ˆï¼‰
  // Caesarå¯†ç 
  let plaintext = "HELLO"
  let shift = 3
  
  // ç®€åŒ–çš„åŠ å¯†è¿‡ç¨‹ï¼ˆä»…æ¨¡æ‹Ÿï¼Œä¸å®é™…å¤„ç†å­—ç¬¦ï¼‰
  let text_length = 5
  let encrypted_length = text_length
  @azimuth.assert_eq(5, encrypted_length)
  @azimuth.assert_eq_string("HELLO", plaintext)  // ä½¿ç”¨plaintexté¿å…æœªä½¿ç”¨è­¦å‘Š
  
  // ç®€åŒ–çš„å“ˆå¸Œè®¡ç®—
  let hash_base = 31
  let hash_value = @azimuth.multiply(text_length, hash_base)
  @azimuth.assert_eq(155, hash_value)
  
  // ç®€åŒ–çš„æ ¡éªŒå’Œè®¡ç®—
  let checksum = @azimuth.add(hash_value, shift)
  @azimuth.assert_eq(158, checksum)
  
  // è§£å¯†éªŒè¯ï¼ˆç®€åŒ–ï¼‰
  let decrypted_checksum = @azimuth.add(checksum, -shift)
  @azimuth.assert_eq(155, decrypted_checksum)
  @azimuth.assert_eq(hash_value, decrypted_checksum)
}

test "temperature_conversion" {
  // æµ‹è¯•æ¸©åº¦è½¬æ¢ï¼šæ‘„æ°åº¦è½¬åæ°åº¦
  // ç®€åŒ–å…¬å¼ï¼šF = C Ã— 2 + 30ï¼ˆé¿å…å°æ•°ï¼‰
  
  // æµ‹è¯•å¸¸è§æ¸©åº¦ç‚¹
  let freezing_celsius = 0    // å†°ç‚¹
  let freezing_fahrenheit = @azimuth.add(@azimuth.multiply(freezing_celsius, 2), 30)
  @azimuth.assert_eq(30, freezing_fahrenheit)
  
  let room_celsius = 20       // å®¤æ¸©
  let room_fahrenheit = @azimuth.add(@azimuth.multiply(room_celsius, 2), 30)
  @azimuth.assert_eq(70, room_fahrenheit)
  
  let boiling_celsius = 100   // æ²¸ç‚¹
  let boiling_fahrenheit = @azimuth.add(@azimuth.multiply(boiling_celsius, 2), 30)
  @azimuth.assert_eq(230, boiling_fahrenheit)
}