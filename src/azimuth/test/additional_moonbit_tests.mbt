// é¢å¤–çš„ MoonBit æµ‹è¯•ç”¨ä¾‹
// æµ‹è¯• Azimuth é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½

test "integer_overflow_protection" {
  // æµ‹è¯•æ•´æ•°æº¢å‡ºä¿æŠ¤
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•åŠ æ³•æº¢å‡ºä¿æŠ¤
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, 1))
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, 100))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, -1))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, -100))
  
  // æµ‹è¯•ä¹˜æ³•æº¢å‡ºä¿æŠ¤
  @azimuth.assert_eq(max_val, @azimuth.multiply(max_val, 2))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 2))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, -1))
}

test "string_unicode_handling" {
  // æµ‹è¯•å­—ç¬¦ä¸² Unicode å¤„ç†
  // æµ‹è¯•åŸºæœ¬ Unicode å­—ç¬¦
  @azimuth.assert_eq_string("Hello, ä¸–ç•Œ!", @azimuth.greet("ä¸–ç•Œ"))
  @azimuth.assert_eq_string("Hello, ğŸŒŸ!", @azimuth.greet("ğŸŒŸ"))
  
  // æµ‹è¯•æ··åˆå­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, Helloä¸–ç•Œ!", @azimuth.greet("Helloä¸–ç•Œ"))
  @azimuth.assert_eq_string("Hello, Test123æµ‹è¯•!", @azimuth.greet("Test123æµ‹è¯•"))
  
  // æµ‹è¯•ç‰¹æ®Š Unicode å­—ç¬¦
  @azimuth.assert_eq_string("Hello, Â©Â®â„¢!", @azimuth.greet("Â©Â®â„¢"))
  @azimuth.assert_eq_string("Hello, ğ•ğ•ğ•‘!", @azimuth.greet("ğ•ğ•ğ•‘"))
}

test "mathematical_series_calculations" {
  // æµ‹è¯•æ•°å­¦çº§æ•°è®¡ç®—
  // è®¡ç®—ç­‰å·®æ•°åˆ—å‰ n é¡¹å’Œï¼š1 + 2 + 3 + ... + n = n Ã— (n + 1) / 2
  let n = 100
  let arithmetic_sum = @azimuth.multiply(n, @azimuth.add(n, 1)) / 2
  @azimuth.assert_eq(5050, arithmetic_sum)
  
  // è®¡ç®—ç­‰æ¯”æ•°åˆ—å‰ n é¡¹å’Œï¼š1 + 2 + 4 + ... + 2^(n-1) = 2^n - 1
  // è®¡ç®— 2^5 - 1
  let power_of_2 = @azimuth.multiply(@azimuth.multiply(2, 2), @azimuth.multiply(2, 2))  // 2^4 = 16
  let geometric_sum = @azimuth.multiply(power_of_2, 2) - 1  // 2^5 - 1 = 31
  @azimuth.assert_eq(31, geometric_sum)
  
  // è®¡ç®—å¹³æ–¹å’Œï¼š1Â² + 2Â² + 3Â² + ... + nÂ²
  let n2 = 5
  let square_sum = @azimuth.add(@azimuth.add(@azimuth.add(@azimuth.multiply(1, 1), 
                   @azimuth.multiply(2, 2)), @azimuth.multiply(3, 3)), 
                   @azimuth.add(@azimuth.multiply(4, 4), @azimuth.multiply(5, 5)))
  @azimuth.assert_eq(55, square_sum)
}

test "real_world_financial_calculations" {
  // æµ‹è¯•å®é™…é‡‘èè®¡ç®—åœºæ™¯
  // å¤åˆåˆ©æ¯è®¡ç®—ï¼šA = P(1 + r/n)^(nt)
  // ç®€åŒ–è®¡ç®—ï¼šA = P Ã— (1 + r Ã— t)
  let principal = 10000  // æœ¬é‡‘
  let rate = 5           // å¹´åˆ©ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰
  let time = 3           // å¹´æ•°
  
  let growth_factor = @azimuth.add(1, @azimuth.multiply(rate, time))
  let amount = @azimuth.multiply(principal, growth_factor)
  @azimuth.assert_eq(160000, amount)
  
  // æŠ˜æ‰£è®¡ç®—ï¼šæŠ˜åä»·æ ¼ = åŸä»· Ã— (1 - æŠ˜æ‰£ç‡)
  let original_price = 200
  let discount_rate = 20  // 20% æŠ˜æ‰£
  let discounted_price = @azimuth.multiply(original_price, @azimuth.add(100, -discount_rate)) / 100
  @azimuth.assert_eq(160, discounted_price)
  
  // ç¨è´¹è®¡ç®—ï¼šå«ç¨ä»·æ ¼ = åŸä»· Ã— (1 + ç¨ç‡)
  let base_price = 500
  let tax_rate = 8  // 8% ç¨ç‡
  let total_price = @azimuth.multiply(base_price, @azimuth.add(100, tax_rate)) / 100
  @azimuth.assert_eq(540, total_price)
}

test "geometry_and_physics_calculations" {
  // æµ‹è¯•å‡ ä½•å’Œç‰©ç†è®¡ç®—
  // åœ†çš„å‘¨é•¿å’Œé¢ç§¯ï¼ˆç®€åŒ–è®¡ç®—ï¼ŒÏ€ â‰ˆ 3ï¼‰
  let radius = 10
  let circumference = @azimuth.multiply(2, @azimuth.multiply(3, radius))  // 2Ï€r â‰ˆ 6r
  let area = @azimuth.multiply(3, @azimuth.multiply(radius, radius))  // Ï€rÂ² â‰ˆ 3rÂ²
  @azimuth.assert_eq(60, circumference)
  @azimuth.assert_eq(300, area)
  
  // çƒä½“ä½“ç§¯ï¼ˆç®€åŒ–è®¡ç®—ï¼ŒÏ€ â‰ˆ 3ï¼‰ï¼šV = 4/3 Ã— Ï€ Ã— rÂ³ â‰ˆ 4 Ã— rÂ³
  let sphere_radius = 5
  let volume = @azimuth.multiply(4, @azimuth.multiply(sphere_radius, 
                   @azimuth.multiply(sphere_radius, sphere_radius)))
  @azimuth.assert_eq(500, volume)
  
  // ç®€å•è¿åŠ¨å­¦ï¼šè·ç¦» = é€Ÿåº¦ Ã— æ—¶é—´
  let velocity = 60  // km/h
  let time_hours = 2  // å°æ—¶
  let distance = @azimuth.multiply(velocity, time_hours)
  @azimuth.assert_eq(120, distance)
}

test "algorithm_efficiency_tests" {
  // æµ‹è¯•ç®—æ³•æ•ˆç‡ç›¸å…³è®¡ç®—
  // çº¿æ€§æœç´¢æ—¶é—´å¤æ‚åº¦æ¨¡æ‹Ÿ
  let array_size = 1000
  let average_comparisons = array_size / 2
  @azimuth.assert_eq(500, average_comparisons)
  
  // äºŒåˆ†æœç´¢æ—¶é—´å¤æ‚åº¦æ¨¡æ‹Ÿï¼ˆç®€åŒ–è®¡ç®—ï¼‰
  // logâ‚‚(1024) â‰ˆ 10
  let binary_search_size = 1024
  let max_comparisons = 10
  @azimuth.assert_eq(10, max_comparisons)
  
  // å†’æ³¡æ’åºæ¯”è¾ƒæ¬¡æ•°ï¼šn Ã— (n-1) / 2
  let sort_size = 20
  let bubble_comparisons = @azimuth.multiply(sort_size, @azimuth.add(sort_size, -1)) / 2
  @azimuth.assert_eq(190, bubble_comparisons)
}

test "data_structure_operations" {
  // æµ‹è¯•æ•°æ®ç»“æ„æ“ä½œæ¨¡æ‹Ÿ
  // æ ˆæ“ä½œæ¨¡æ‹Ÿ
  let stack_size = 10
  let push_operations = 5
  let pop_operations = 3
  let final_stack_size = @azimuth.add(stack_size, @azimuth.add(push_operations, -pop_operations))
  @azimuth.assert_eq(12, final_stack_size)
  
  // é˜Ÿåˆ—æ“ä½œæ¨¡æ‹Ÿ
  let queue_size = 8
  let enqueue_operations = 6
  let dequeue_operations = 4
  let final_queue_size = @azimuth.add(queue_size, @azimuth.add(enqueue_operations, -dequeue_operations))
  @azimuth.assert_eq(10, final_queue_size)
  
  // å“ˆå¸Œè¡¨è´Ÿè½½å› å­è®¡ç®—
  let table_capacity = 16
  let elements_stored = 12
  let load_factor = @azimuth.multiply(elements_stored, 100) / table_capacity
  @azimuth.assert_eq(75, load_factor)
}

test "error_boundary_conditions" {
  // æµ‹è¯•é”™è¯¯è¾¹ç•Œæ¡ä»¶
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•æå€¼è¿ç®—ç»„åˆ
  @azimuth.assert_eq(-1, @azimuth.add(max_val, min_val))
  @azimuth.assert_eq(0, @azimuth.multiply(max_val, 0))
  @azimuth.assert_eq(0, @azimuth.multiply(min_val, 0))
  
  // æµ‹è¯•è¿ç»­è¿ç®—çš„è¾¹ç•Œæƒ…å†µ
  let result1 = @azimuth.add(@azimuth.add(max_val, -1), 1)
  @azimuth.assert_eq(max_val, result1)
  
  let result2 = @azimuth.multiply(@azimuth.multiply(min_val, -1), -1)
  @azimuth.assert_eq(min_val, result2)
  
  // æµ‹è¯•æ–­è¨€å‡½æ•°çš„è¾¹ç•Œæƒ…å†µ
  @azimuth.assert_true(@azimuth.add(max_val, min_val) == -1)
  @azimuth.assert_false(@azimuth.add(max_val, min_val) == 0)
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 1))
}

test "statistical_calculations" {
  // æµ‹è¯•ç»Ÿè®¡è®¡ç®—
  // è®¡ç®—å¹³å‡å€¼
  let values_sum = @azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(10, 20), 30), 40), 50)
  let count = 5
  let average = values_sum / count
  @azimuth.assert_eq(30, average)
  
  // è®¡ç®—æ–¹å·®ï¼ˆç®€åŒ–ç‰ˆï¼‰
  let mean = 30
  let diff1 = @azimuth.add(10, -mean)  // -20
  let diff2 = @azimuth.add(20, -mean)  // -10
  let diff3 = @azimuth.add(30, -mean)  // 0
  let diff4 = @azimuth.add(40, -mean)  // 10
  let diff5 = @azimuth.add(50, -mean)  // 20
  
  let variance = @azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(
                   @azimuth.multiply(diff1, diff1), @azimuth.multiply(diff2, diff2)), 
                   @azimuth.multiply(diff3, diff3)), @azimuth.add(@azimuth.multiply(diff4, diff4), 
                   @azimuth.multiply(diff5, diff5))) / count
  @azimuth.assert_eq(200, variance)
  
  // è®¡ç®—æ ‡å‡†å·®ï¼ˆç®€åŒ–ä¸ºæ•´æ•°ï¼‰
  let standard_deviation = 14  // âˆš200 â‰ˆ 14.14ï¼Œå–æ•´æ•°éƒ¨åˆ†
  @azimuth.assert_true(standard_deviation == 14)
}

test "complex_string_operations" {
  // æµ‹è¯•å¤æ‚å­—ç¬¦ä¸²æ“ä½œ
  // æµ‹è¯•å„ç§ç‰¹æ®Šå­—ç¬¦ç»„åˆ
  @azimuth.assert_eq_string("Hello, a+b=c!", @azimuth.greet("a+b=c"))
  @azimuth.assert_eq_string("Hello, x*y=z!", @azimuth.greet("x*y=z"))
  @azimuth.assert_eq_string("Hello, a/b=c!", @azimuth.greet("a/b=c"))
  
  // æµ‹è¯•åŒ…å«ç©ºæ ¼çš„å¤æ‚å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, Multiple Words Test!", @azimuth.greet("Multiple Words Test"))
  @azimuth.assert_eq_string("Hello,   Leading and trailing spaces   !", 
                            @azimuth.greet("  Leading and trailing spaces  "))
  
  // æµ‹è¯•åŒ…å«å¼•å·çš„å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, \"Quoted Text\"!", @azimuth.greet("\"Quoted Text\""))
  @azimuth.assert_eq_string("Hello, 'Single Quotes'!", @azimuth.greet("'Single Quotes'"))
  
  // æµ‹è¯•æ¢è¡Œç¬¦å’Œåˆ¶è¡¨ç¬¦
  @azimuth.assert_eq_string("Hello, Line1\nLine2!", @azimuth.greet("Line1\nLine2"))
  @azimuth.assert_eq_string("Hello, Col1\tCol2!", @azimuth.greet("Col1\tCol2"))
}