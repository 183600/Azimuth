// Enhanced MoonBit æµ‹è¯•ç”¨ä¾‹
// ä¸º Azimuth é¡¹ç›®æ–°å¢žçš„10ä¸ªæ ‡å‡†æµ‹è¯•ç”¨ä¾‹

test "add_function_comprehensive_boundary_test" {
  // å…¨é¢æµ‹è¯• add å‡½æ•°çš„è¾¹ç•Œæ¡ä»¶å’Œç‰¹æ®Šæƒ…å†µ
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•æ­£æ•°æº¢å‡ºè¾¹ç•Œ
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, 1))
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, 100))
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, max_val))
  
  // æµ‹è¯•è´Ÿæ•°æº¢å‡ºè¾¹ç•Œ
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, -1))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, -100))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, min_val))
  
  // æµ‹è¯•é›¶å€¼ç‰¹æ€§
  @azimuth.assert_eq(0, @azimuth.add(0, 0))
  @azimuth.assert_eq(123, @azimuth.add(0, 123))
  @azimuth.assert_eq(-456, @azimuth.add(-456, 0))
  
  // æµ‹è¯•å¯¹ç§°æ€§
  @azimuth.assert_eq(@azimuth.add(100, 200), @azimuth.add(200, 100))
  @azimuth.assert_eq(@azimuth.add(-100, 200), @azimuth.add(200, -100))
}

test "multiply_function_mathematical_properties" {
  // æµ‹è¯• multiply å‡½æ•°çš„æ•°å­¦æ€§è´¨
  // æµ‹è¯•ä¹˜æ³•äº¤æ¢å¾‹ï¼ša * b = b * a
  @azimuth.assert_eq(@azimuth.multiply(7, 13), @azimuth.multiply(13, 7))
  @azimuth.assert_eq(@azimuth.multiply(-8, 15), @azimuth.multiply(15, -8))
  @azimuth.assert_eq(@azimuth.multiply(-12, -9), @azimuth.multiply(-9, -12))
  
  // æµ‹è¯•ä¹˜æ³•ç»“åˆå¾‹ï¼š(a * b) * c = a * (b * c)
  let a = 3
  let b = 4
  let c = 5
  @azimuth.assert_eq(@azimuth.multiply(@azimuth.multiply(a, b), c), @azimuth.multiply(a, @azimuth.multiply(b, c)))
  
  // æµ‹è¯•åˆ†é…å¾‹ï¼ša * (b + c) = a * b + a * c
  @azimuth.assert_eq(@azimuth.multiply(3, @azimuth.add(4, 5)), @azimuth.add(@azimuth.multiply(3, 4), @azimuth.multiply(3, 5)))
  
  // æµ‹è¯•ç‰¹æ®Šå€¼
  @azimuth.assert_eq(0, @azimuth.multiply(0, 12345))
  @azimuth.assert_eq(12345, @azimuth.multiply(1, 12345))
  @azimuth.assert_eq(-12345, @azimuth.multiply(-1, 12345))
  
  // æµ‹è¯•è¾¹ç•Œå€¼
  let max_val = 2147483647
  let min_val = -2147483648
  @azimuth.assert_eq(0, @azimuth.multiply(max_val, 0))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 1))
}

test "greet_function_string_processing_comprehensive" {
  // å…¨é¢æµ‹è¯• greet å‡½æ•°çš„å­—ç¬¦ä¸²å¤„ç†èƒ½åŠ›
  // æµ‹è¯•åŸºæœ¬å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, World!", @azimuth.greet("World"))
  @azimuth.assert_eq_string("Hello, MoonBit!", @azimuth.greet("MoonBit"))
  
  // æµ‹è¯•ç©ºå­—ç¬¦ä¸²å’Œå•å­—ç¬¦
  @azimuth.assert_eq_string("Hello, !", @azimuth.greet(""))
  @azimuth.assert_eq_string("Hello, A!", @azimuth.greet("A"))
  
  // æµ‹è¯•æ•°å­—å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, 123!", @azimuth.greet("123"))
  @azimuth.assert_eq_string("Hello, 2023!", @azimuth.greet("2023"))
  
  // æµ‹è¯•ç‰¹æ®Šå­—ç¬¦
  @azimuth.assert_eq_string("Hello, @#$%^&*()!", @azimuth.greet("@#$%^&*()"))
  @azimuth.assert_eq_string("Hello, ä¸­æ–‡æµ‹è¯•!", @azimuth.greet("ä¸­æ–‡æµ‹è¯•"))
  @azimuth.assert_eq_string("Hello, ðŸŒ!", @azimuth.greet("ðŸŒ"))
  
  // æµ‹è¯•åŒ…å«ç©ºæ ¼çš„å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, John Doe!", @azimuth.greet("John Doe"))
  @azimuth.assert_eq_string("Hello,  Leading and trailing  !", @azimuth.greet(" Leading and trailing  "))
}

test "complex_computation_scenarios" {
  // æµ‹è¯•å¤æ‚è®¡ç®—åœºæ™¯
  // åœºæ™¯1ï¼šè®¡ç®—å¤šé¡¹å¼å€¼ axÂ² + bx + c
  let x = 5
  let a = 2
  let b = 3
  let c = 7
  let x_squared = @azimuth.multiply(x, x)
  let ax_squared = @azimuth.multiply(a, x_squared)
  let bx = @azimuth.multiply(b, x)
  let polynomial_result = @azimuth.add(@azimuth.add(ax_squared, bx), c)
  @azimuth.assert_eq(72, polynomial_result)  // 2*25 + 3*5 + 7 = 50 + 15 + 7 = 72
  
  // åœºæ™¯2ï¼šè®¡ç®—åœ†çš„é¢ç§¯å’Œå‘¨é•¿ï¼ˆç®€åŒ–Ï€=3ï¼‰
  let radius = 8
  let circumference = @azimuth.multiply(@azimuth.multiply(2, 3), radius)  // 2Ï€r
  let area = @azimuth.multiply(3, @azimuth.multiply(radius, radius))      // Ï€rÂ²
  @azimuth.assert_eq(48, circumference)  // 2 * 3 * 8 = 48
  @azimuth.assert_eq(192, area)          // 3 * 8 * 8 = 192
  
  // åœºæ™¯3ï¼šè®¡ç®—å¹³å‡æ•°
  let sum = @azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(85, 92), 78), 96), 89)
  let average = sum / 5
  @azimuth.assert_eq(440, sum)      // 85 + 92 + 78 + 96 + 89 = 440
  @azimuth.assert_eq(88, average)   // 440 / 5 = 88
}

test "practical_business_calculations" {
  // æµ‹è¯•å®žé™…ä¸šåŠ¡è®¡ç®—åœºæ™¯
  // åœºæ™¯1ï¼šè´­ç‰©è½¦æ€»ä»·è®¡ç®—
  let item1_price = 299
  let item1_qty = 2
  let item2_price = 199
  let item2_qty = 3
  let item3_price = 99
  let item3_qty = 1
  let shipping_fee = 15
  let tax_rate = 8
  
  let subtotal1 = @azimuth.multiply(item1_price, item1_qty)
  let subtotal2 = @azimuth.multiply(item2_price, item2_qty)
  let subtotal3 = @azimuth.multiply(item3_price, item3_qty)
  let items_total = @azimuth.add(@azimuth.add(subtotal1, subtotal2), subtotal3)
  let tax_amount = @azimuth.multiply(items_total, tax_rate) / 100
  let final_total = @azimuth.add(@azimuth.add(items_total, tax_amount), shipping_fee)
  
  @azimuth.assert_eq(1294, items_total)  // 299*2 + 199*3 + 99*1 = 598 + 597 + 99 = 1294
  @azimuth.assert_eq(103, tax_amount)    // 1294 * 8 / 100 = 103.52 â‰ˆ 103
  @azimuth.assert_eq(1412, final_total)  // 1294 + 103 + 15 = 1412
  
  // åœºæ™¯2ï¼šè´·æ¬¾åˆ©æ¯è®¡ç®—
  let principal = 10000
  let monthly_rate = 5
  let months = 12
  let total_interest = @azimuth.multiply(principal, @azimuth.multiply(monthly_rate, months)) / 100
  let total_payment = @azimuth.add(principal, total_interest)
  
  @azimuth.assert_eq(6000, total_interest)  // 10000 * 5 * 12 / 100 = 6000
  @azimuth.assert_eq(16000, total_payment)  // 10000 + 6000 = 16000
}

test "error_handling_and_edge_cases" {
  // æµ‹è¯•é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•æº¢å‡ºä¿æŠ¤
  @azimuth.assert_eq(@azimuth.add(max_val, 1, true) == max_val)
  @azimuth.assert_eq(@azimuth.add(min_val, -1, true) == min_val)
  @azimuth.assert_eq(@azimuth.multiply(max_val, 2, true) == max_val)
  @azimuth.assert_eq(@azimuth.multiply(min_val, -1, true) == min_val)
  
  // æµ‹è¯•æ–­è¨€å‡½æ•°
  @azimuth.assert_eq(1, 1)
  @azimuth.assert_eq(1, 1)
  @azimuth.assert_eq(42, 42)
  @azimuth.assert_eq_string("test", "test")
  
  // æµ‹è¯•é™¤é›¶ä¿æŠ¤ï¼ˆé€šè¿‡ divide_with_ceil å‡½æ•°ï¼‰
  @azimuth.assert_eq(5, @azimuth.divide_with_ceil(10, 2))
  @azimuth.assert_eq(4, @azimuth.divide_with_ceil(9, 2))
  @azimuth.assert_eq(-4, @azimuth.divide_with_ceil(-9, 2))
  
  // æµ‹è¯•ç‰¹æ®Šæ•°å­¦è¿ç®—
  @azimuth.assert_eq(0, @azimuth.multiply(12345, 0))
  @azimuth.assert_eq(12345, @azimuth.multiply(12345, 1))
  @azimuth.assert_eq(-12345, @azimuth.multiply(12345, -1))
  
  // æµ‹è¯•æœ€å°å€¼ç‰¹æ®Šå¤„ç†
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 1))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, -1))
}

test "algorithm_implementation_tests" {
  // æµ‹è¯•åŸºæœ¬ç®—æ³•å®žçŽ°
  // ç®—æ³•1ï¼šè®¡ç®—é˜¶ä¹˜ n! = n Ã— (n-1) Ã— ... Ã— 1
  let n = 5
  let factorial = @azimuth.multiply(n, @azimuth.multiply(n - 1, @azimuth.multiply(n - 2, @azimuth.multiply(n - 3, n - 4))))
  @azimuth.assert_eq(120, factorial)  // 5! = 120
  
  // ç®—æ³•2ï¼šè®¡ç®—å¹‚è¿ç®— 2^10 = 1024
  let power_of_2 = @azimuth.multiply(@azimuth.multiply(@azimuth.multiply(@azimuth.multiply(@azimuth.multiply(2, 2), 2), 2), 2), 
                             @azimuth.multiply(@azimuth.multiply(@azimuth.multiply(@azimuth.multiply(@azimuth.multiply(2, 2), 2), 2), 2), 2))
  @azimuth.assert_eq(1024, power_of_2)
  
  // ç®—æ³•3ï¼šè®¡ç®—ç­‰å·®æ•°åˆ—å’Œ 1 + 3 + 5 + ... + 19 (å‰10ä¸ªå¥‡æ•°)
  let first_term = 1
  let last_term = 19
  let num_terms = 10
  let arithmetic_sum = @azimuth.multiply(num_terms, @azimuth.add(first_term, last_term)) / 2
  @azimuth.assert_eq(100, arithmetic_sum)  // 10 * (1 + 19) / 2 = 100
  
  // ç®—æ³•4ï¼šè®¡ç®—ç­‰æ¯”æ•°åˆ—å’Œ 2 + 4 + 8 + 16 + 32 (å‰5é¡¹)
  let ratio = 2
  let terms = 5
  let geo_sum = @azimuth.multiply(2, @azimuth.multiply(@azimuth.multiply(@azimuth.multiply(@azimuth.multiply(1, ratio), ratio), ratio), ratio))
  @azimuth.assert_eq(62, geo_sum)  // 2 + 4 + 8 + 16 + 32 = 62
}

test "data_conversion_and_formatting" {
  // æµ‹è¯•æ•°æ®è½¬æ¢å’Œæ ¼å¼åŒ–åœºæ™¯
  // åœºæ™¯1ï¼šæ¨¡æ‹Ÿæ•°å­—åˆ°å­—ç¬¦ä¸²çš„è½¬æ¢
  let year_str = "2023"
  let month_str = "12"
  let day_str = "25"
  let formatted_date = year_str + "-" + month_str + "-" + day_str
  @azimuth.assert_eq_string("2023-12-25", formatted_date)
  
  // åœºæ™¯2ï¼šæ¨¡æ‹Ÿè´§å¸æ ¼å¼åŒ–
  let amount_str = "1234"
  let formatted_currency = "$" + amount_str + ".00"
  @azimuth.assert_eq_string("$1234.00", formatted_currency)
  
  // åœºæ™¯3ï¼šæ¨¡æ‹Ÿç™¾åˆ†æ¯”æ ¼å¼
  let percentage_str = "75"
  let formatted_percentage = percentage_str + "%"
  @azimuth.assert_eq_string("75%", formatted_percentage)
  
  // æµ‹è¯• greet å‡½æ•°ä½œä¸ºæ ¼å¼åŒ–å·¥å…·
  @azimuth.assert_eq_string("Hello, 2023!", @azimuth.greet("2023"))
  @azimuth.assert_eq_string("Hello, $1234.00!", @azimuth.greet("$1234.00"))
  @azimuth.assert_eq_string("Hello, 75%!", @azimuth.greet("75%"))
}

test "performance_and_optimization_tests" {
  // æµ‹è¯•æ€§èƒ½ç›¸å…³çš„è®¡ç®—å’Œä¼˜åŒ–åœºæ™¯
  // åœºæ™¯1ï¼šæ‰¹é‡è®¡ç®—ä¼˜åŒ–
  let base_value = 100
  let iterations = 10
  
  // ä½¿ç”¨å…¬å¼ä¼˜åŒ–ï¼šn Ã— (n + 1) / 2 è®¡ç®—è¿žç»­å’Œ
  let optimized_sum = @azimuth.multiply(base_value, @azimuth.multiply(iterations, @azimuth.add(iterations, 1)) / 2)
  @azimuth.assert_eq(5500, optimized_sum)  // 100 * 10 * 11 / 2 = 5500
  
  // åœºæ™¯2ï¼šå¹‚è¿ç®—ä¼˜åŒ–
  // è®¡ç®— x^8 å¯ä»¥é€šè¿‡ (x^2)^4 ä¼˜åŒ–
  let x = 3
  let x_squared = @azimuth.multiply(x, x)
  let x_to_4th = @azimuth.multiply(x_squared, x_squared)
  let x_to_8th = @azimuth.multiply(x_to_4th, x_to_4th)
  @azimuth.assert_eq(6561, x_to_8th)  // 3^8 = 6561
  
  // åœºæ™¯3ï¼šé‡å¤è®¡ç®—ç¼“å­˜
  let common_factor = @azimuth.multiply(7, 13)  // 91
  let result1 = @azimuth.multiply(common_factor, 5)   // 455
  let result2 = @azimuth.multiply(common_factor, 8)   // 728
  let result3 = @azimuth.multiply(common_factor, 12)  // 1092
  
  @azimuth.assert_eq(455, result1)
  @azimuth.assert_eq(728, result2)
  @azimuth.assert_eq(1092, result3)
  
  // åœºæ™¯4ï¼šå¤§æ•°è¿ç®—ä¼˜åŒ–
  let large_num = 1000000
  let optimized_large_mult = @azimuth.multiply(large_num, 1234)
  @azimuth.assert_eq(1234000000, optimized_large_mult)
}

test "complex_business_logic_simulation" {
  // æµ‹è¯•å¤æ‚ä¸šåŠ¡é€»è¾‘æ¨¡æ‹Ÿ
  // åœºæ™¯1ï¼šåº“å­˜ç®¡ç†ç³»ç»Ÿ
  let initial_stock = 1000
  let sales_day1 = 150
  let sales_day2 = 200
  let sales_day3 = 175
  let restock_day2 = 300
  let restock_day3 = 500
  
  // è®¡ç®—æ¯æ—¥åº“å­˜å˜åŒ–
  let stock_after_day1 = @azimuth.add(initial_stock, -sales_day1)
  let stock_after_day2_before_restock = @azimuth.add(stock_after_day1, -sales_day2)
  let stock_after_day2_after_restock = @azimuth.add(stock_after_day2_before_restock, restock_day2)
  let stock_after_day3_before_restock = @azimuth.add(stock_after_day2_after_restock, -sales_day3)
  let final_stock = @azimuth.add(stock_after_day3_before_restock, restock_day3)
  
  @azimuth.assert_eq(850, stock_after_day1)           // 1000 - 150 = 850
  @azimuth.assert_eq(650, stock_after_day2_before_restock)  // 850 - 200 = 650
  @azimuth.assert_eq(950, stock_after_day2_after_restock)  // 650 + 300 = 950
  @azimuth.assert_eq(775, stock_after_day3_before_restock)  // 950 - 175 = 775
  @azimuth.assert_eq(1275, final_stock)               // 775 + 500 = 1275
  
  // åœºæ™¯2ï¼šä¼šå‘˜ç§¯åˆ†ç³»ç»Ÿ
  let base_points = 100
  let purchase_amount = 500
  let tier_multiplier = 2
  let bonus_threshold = 1000
  let bonus_points = 200
  
  let regular_points = @azimuth.multiply(purchase_amount, base_points) / 100
  let tier_points = @azimuth.multiply(regular_points, tier_multiplier)
  let total_points = if (regular_points > bonus_threshold) {
    @azimuth.add(tier_points, bonus_points)
  } else {
    tier_points
  }
  
  @azimuth.assert_eq(500, regular_points)  // 500 * 100 / 100 = 500
  @azimuth.assert_eq(1000, tier_points)    // 500 * 2 = 1000
  @azimuth.assert_eq(1000, total_points)   // 500 <= 1000ï¼Œæ‰€ä»¥ä¸åŠ å¥–åŠ±ç§¯åˆ†
  
  // åœºæ™¯3ï¼šæŠ˜æ‰£è®¡ç®—ç³»ç»Ÿ
  let original_price = 1000
  let quantity = 5
  let bulk_discount_threshold = 3
  let bulk_discount_rate = 10
  let vip_discount_rate = 5
  
  let subtotal = @azimuth.multiply(original_price, quantity)
  let bulk_discount = if (quantity > bulk_discount_threshold) {
    @azimuth.multiply(subtotal, bulk_discount_rate) / 100
  } else {
    0
  }
  
  let vip_discount = @azimuth.multiply(subtotal, vip_discount_rate) / 100
  let final_price = @azimuth.add(subtotal, @azimuth.add(-bulk_discount, -vip_discount))
  
  @azimuth.assert_eq(5000, subtotal)      // 1000 * 5 = 5000
  @azimuth.assert_eq(500, bulk_discount)  // 5000 * 10 / 100 = 500
  @azimuth.assert_eq(250, vip_discount)   // 5000 * 5 / 100 = 250
  @azimuth.assert_eq(4250, final_price)   // 5000 - 500 - 250 = 4250
}