// æ–°å¢æµ‹è¯•ç”¨ä¾‹ - è¡¥å……å°šæœªè¦†ç›–çš„æµ‹è¯•åœºæ™¯

///|
test "associative_property_add" {
  // æµ‹è¯•åŠ æ³•ç»“åˆå¾‹
  let a = 100
  let b = 200
  let c = 300
  
  // (a + b) + c = a + (b + c)
  let left_assoc = add(add(a, b), c)
  let right_assoc = add(a, add(b, c))
  assert_eq(left_assoc, right_assoc)
}

///|
test "associative_property_multiply" {
  // æµ‹è¯•ä¹˜æ³•ç»“åˆå¾‹
  let a = 10
  let b = 20
  let c = 30
  
  // (a * b) * c = a * (b * c)
  let left_assoc = multiply(multiply(a, b), c)
  let right_assoc = multiply(a, multiply(b, c))
  assert_eq(left_assoc, right_assoc)
}

///|
test "distributive_property" {
  // æµ‹è¯•åˆ†é…å¾‹
  let a = 5
  let b = 10
  let c = 20
  
  // a * (b + c) = a * b + a * c
  let left_side = multiply(a, add(b, c))
  let right_side = add(multiply(a, b), multiply(a, c))
  assert_eq(left_side, right_side)
}

///|
test "power_of_two_operations" {
  // æµ‹è¯•2çš„å¹‚æ¬¡è¿ç®—
  let two_to_10 = 1024
  let two_to_15 = 32768
  let two_to_20 = 1048576
  
  // æµ‹è¯•2çš„å¹‚æ¬¡ç›¸åŠ 
  assert_eq(2048, add(two_to_10, two_to_10))
  assert_eq(65536, add(two_to_15, two_to_15))
  
  // æµ‹è¯•2çš„å¹‚æ¬¡ç›¸ä¹˜
  assert_eq(33554432, multiply(two_to_15, two_to_10))
  assert_eq(1073741824, multiply(two_to_20, two_to_10)) // 1048576 * 1024 = 1073741824
}

///|
test "sequential_overflow_handling" {
  // æµ‹è¯•è¿ç»­æº¢å‡ºå¤„ç†
  let mut value = 1000000
  
  // è¿ç»­åŠ æ³•ç›´åˆ°æº¢å‡º
  value = add(value, 1000000)  // 2000000
  value = add(value, 1000000)  // 3000000
  value = add(value, 1000000)  // 4000000
  value = add(value, 1800000000)  // 1804000000
  value = add(value, 343483647)  // 2147483647 (è¾¾åˆ°æœ€å¤§å€¼)
  value = add(value, 1)  // åº”è¯¥ä¿æŒæœ€å¤§å€¼
  assert_eq(2147483647, value)
}

///|
test "string_unicode_handling" {
  // æµ‹è¯•Unicodeå­—ç¬¦ä¸²å¤„ç†
  assert_eq("Hello, ğŸŒ™!", greet("ğŸŒ™"))
  assert_eq("Hello, ğŸš€!", greet("ğŸš€"))
  assert_eq("Hello, Ã©mojis!", greet("Ã©mojis"))
  assert_eq("Hello, ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦!", greet("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"))
  assert_eq("Hello, ğ”˜ğ”«ğ”¦ğ” ğ”¬ğ”¡ğ”¢!", greet("ğ”˜ğ”«ğ”¦ğ” ğ”¬ğ”¡ğ”¢"))
}

///|
test "negative_zero_handling" {
  // æµ‹è¯•è´Ÿé›¶å¤„ç†ï¼ˆè™½ç„¶Intæ²¡æœ‰è´Ÿé›¶ï¼Œä½†æµ‹è¯•ç›¸å…³è¾¹ç•Œï¼‰
  let zero = 0
  let neg_zero = -0
  
  assert_eq(zero, neg_zero)
  assert_eq(5, add(zero, 5))
  assert_eq(5, add(neg_zero, 5))
  assert_eq(0, multiply(zero, 5))
  assert_eq(0, multiply(neg_zero, 5))
}

///|
test "alternating_operations" {
  // æµ‹è¯•äº¤æ›¿åŠ å‡ä¹˜é™¤è¿ç®—
  let mut result = 100
  
  // äº¤æ›¿è¿ç®—ï¼š+ * - *
  result = add(result, 50)     // 150
  result = multiply(result, 2) // 300
  result = add(result, -100)   // 200
  result = multiply(result, 3) // 600
  
  assert_eq(600, result)
}

///|
test "nested_operations" {
  // æµ‹è¯•åµŒå¥—è¿ç®—
  let a = 10
  let b = 20
  let c = 30
  let d = 40
  
  // å¤æ‚åµŒå¥—ï¼š(a + b) * (c + d)
  let result1 = multiply(add(a, b), add(c, d))
  
  // å¦ä¸€ç§åµŒå¥—ï¼ša * c + b * d
  let result2 = add(multiply(a, c), multiply(b, d))
  
  // æµ‹è¯•ç‰¹å®šåµŒå¥—æ¨¡å¼
  assert_eq(2100, result1)  // (10+20)*(30+40) = 30*70 = 2100
  assert_eq(1100, result2)  // 10*30 + 20*40 = 300 + 800 = 1100
}

///|
test "boundary_sequence_tests" {
  // æµ‹è¯•è¾¹ç•Œå€¼åºåˆ—
  let max_val = 2147483647
  
  // ä»æœ€å¤§å€¼é€’å‡åˆ°æœ€å°å€¼çš„åºåˆ—æµ‹è¯•
  let mut value = max_val
  value = add(value, -1)  // 2147483646
  value = add(value, -1)  // 2147483645
  value = add(value, -100)  // 2147483545
  value = add(value, -1000000)  // 2147482545
  value = add(value, -2000000000)  // 147482545
  value = add(value, -147482546)  // -1
  value = add(value, -1)  // -2
  value = add(value, -2147483646)  // åº”è¯¥è¾¾åˆ°æœ€å°å€¼
  assert_eq(-2147483648, value)
}