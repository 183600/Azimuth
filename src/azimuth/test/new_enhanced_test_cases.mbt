// Azimuth é¡¹ç›®æ–°å¢ MoonBit æµ‹è¯•ç”¨ä¾‹
// è¦†ç›–æ›´å¤šè¾¹ç•Œæƒ…å†µå’Œå®é™…åº”ç”¨åœºæ™¯

test "negative_number_multiplication_properties" {
  // æµ‹è¯•è´Ÿæ•°ä¹˜æ³•çš„å„ç§ç‰¹æ€§
  let positive = 15
  let negative = -7
  let zero = 0
  
  // æ­£æ•° Ã— è´Ÿæ•° = è´Ÿæ•°
  @azimuth.assert_eq(-105, @azimuth.multiply(positive, negative))
  @azimuth.assert_eq(-105, @azimuth.multiply(negative, positive))
  
  // è´Ÿæ•° Ã— è´Ÿæ•° = æ­£æ•°
  @azimuth.assert_eq(49, @azimuth.multiply(negative, negative))
  
  // ä»»ä½•æ•° Ã— 0 = 0
  @azimuth.assert_eq(0, @azimuth.multiply(positive, zero))
  @azimuth.assert_eq(0, @azimuth.multiply(negative, zero))
  @azimuth.assert_eq(0, @azimuth.multiply(zero, positive))
  @azimuth.assert_eq(0, @azimuth.multiply(zero, negative))
  
  // æµ‹è¯•æœ€å°å€¼çš„ç‰¹æ®Šå¤„ç†
  let min_val = -2147483648
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 1))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, -1))
}

test "large_number_boundary_operations" {
  // æµ‹è¯•å¤§æ•°è¿ç®—çš„è¾¹ç•Œæƒ…å†µ
  let max_val = 2147483647
  let min_val = -2147483648
  let large_positive = 1000000000
  let large_negative = -1000000000
  
  // æµ‹è¯•æ¥è¿‘æœ€å¤§å€¼çš„åŠ æ³•
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, 1))
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, large_positive))
  @azimuth.assert_eq(max_val, @azimuth.add(large_positive, large_positive))
  
  // æµ‹è¯•æ¥è¿‘æœ€å°å€¼çš„åŠ æ³•
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, -1))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, large_negative))
  @azimuth.assert_eq(min_val, @azimuth.add(large_negative, large_negative))
  
  // æµ‹è¯•å¤§æ•°ä¹˜æ³•
  @azimuth.assert_eq(max_val, @azimuth.multiply(46341, 46341))  // sqrt(max_val)çš„å¹³æ–¹
  @azimuth.assert_eq(min_val, @azimuth.multiply(-46341, 46341))
  
  // æµ‹è¯•è¾¹ç•Œå€¼ç»„åˆ
  @azimuth.assert_eq(-1, @azimuth.add(max_val, min_val))
  @azimuth.assert_eq(0, @azimuth.add(max_val, @azimuth.multiply(min_val, -1)))
}

test "string_processing_edge_cases" {
  // æµ‹è¯•å­—ç¬¦ä¸²å¤„ç†çš„è¾¹ç•Œæƒ…å†µ
  // æµ‹è¯•å„ç§é•¿åº¦çš„å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, !", @azimuth.greet(""))
  @azimuth.assert_eq_string("Hello, A!", @azimuth.greet("A"))
  @azimuth.assert_eq_string("Hello, AB!", @azimuth.greet("AB"))
  
  // æµ‹è¯•åŒ…å«å„ç§ç‰¹æ®Šå­—ç¬¦çš„å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, \n\t\r!", @azimuth.greet("\n\t\r"))
  @azimuth.assert_eq_string("Hello, \"'\\!", @azimuth.greet("\"'\\"))
  @azimuth.assert_eq_string("Hello, ğŸŒŸğŸŒ™â­!", @azimuth.greet("ğŸŒŸğŸŒ™â­"))
  
  // æµ‹è¯•åŒ…å«æ•°å­—å’Œå­—æ¯æ··åˆçš„å­—ç¬¦ä¸²
  @azimuth.assert_eq_string("Hello, User123!", @azimuth.greet("User123"))
  @azimuth.assert_eq_string("Hello, 2023Year!", @azimuth.greet("2023Year"))
  @azimuth.assert_eq_string("Hello, Test_001!", @azimuth.greet("Test_001"))
}

test "mathematical_laws_validation" {
  // æµ‹è¯•æ•°å­¦å®šå¾‹çš„éªŒè¯
  let a = 12
  let b = 8
  let c = 5
  
  // åŠ æ³•äº¤æ¢å¾‹ï¼ša + b = b + a
  @azimuth.assert_eq(@azimuth.add(a, b), @azimuth.add(b, a))
  
  // åŠ æ³•ç»“åˆå¾‹ï¼š(a + b) + c = a + (b + c)
  @azimuth.assert_eq(@azimuth.add(@azimuth.add(a, b), c), @azimuth.add(a, @azimuth.add(b, c)))
  
  // ä¹˜æ³•äº¤æ¢å¾‹ï¼ša Ã— b = b Ã— a
  @azimuth.assert_eq(@azimuth.multiply(a, b), @azimuth.multiply(b, a))
  
  // ä¹˜æ³•ç»“åˆå¾‹ï¼š(a Ã— b) Ã— c = a Ã— (b Ã— c)
  @azimuth.assert_eq(@azimuth.multiply(@azimuth.multiply(a, b), c), @azimuth.multiply(a, @azimuth.multiply(b, c)))
  
  // åˆ†é…å¾‹ï¼ša Ã— (b + c) = a Ã— b + a Ã— c
  @azimuth.assert_eq(
    @azimuth.multiply(a, @azimuth.add(b, c)),
    @azimuth.add(@azimuth.multiply(a, b), @azimuth.multiply(a, c))
  )
}

test "bmi_calculation_scenario" {
  // æµ‹è¯•å®é™…åº”ç”¨åœºæ™¯ï¼šBMIè®¡ç®—ï¼ˆç®€åŒ–ç‰ˆï¼‰
  // BMI = ä½“é‡(kg) / èº«é«˜(m)Â²ï¼Œç®€åŒ–ä¸ºæ•´æ•°è®¡ç®—
  
  let weight = 70  // ä½“é‡70kg
  let height_cm = 175  // èº«é«˜175cm
  let height_m_squared = @azimuth.multiply(height_cm, height_cm)  // èº«é«˜å¹³æ–¹(cmÂ²)
  
  // ç®€åŒ–çš„BMIè®¡ç®—ï¼šä½“é‡ Ã— 10000 / èº«é«˜å¹³æ–¹
  let bmi_times_100 = @azimuth.multiply(weight, 10000)  // 700000
  let bmi = bmi_times_100 / height_m_squared  // 700000 / 30625 â‰ˆ 22.86ï¼Œå–æ•´ä¸º22
  
  @azimuth.assert_eq(22, bmi)
  
  // æµ‹è¯•å¦ä¸€ä¸ªæ¡ˆä¾‹
  let weight2 = 85
  let height_cm2 = 180
  let height_m_squared2 = @azimuth.multiply(height_cm2, height_cm2)
  let bmi_times_1002 = @azimuth.multiply(weight2, 10000)
  let bmi2 = bmi_times_1002 / height_m_squared2
  
  @azimuth.assert_eq(26, bmi2)  // çº¦26.2ï¼Œå–æ•´ä¸º26
}

test "loan_calculation_scenario" {
  // æµ‹è¯•å®é™…åº”ç”¨åœºæ™¯ï¼šè´·æ¬¾è®¡ç®—ï¼ˆç®€åŒ–ç‰ˆï¼‰
  let principal = 500000  // è´·æ¬¾æœ¬é‡‘50ä¸‡
  let annual_rate = 5  // å¹´åˆ©ç‡5%
  let loan_years = 30  // è´·æ¬¾å¹´é™30å¹´
  
  // ç®€åŒ–çš„æœˆä¾›è®¡ç®—ï¼šæœ¬é‡‘ Ã— (1 + åˆ©ç‡ Ã— å¹´æ•°) / (å¹´æ•° Ã— 12)
  let total_multiplier = @azimuth.add(1, @azimuth.multiply(annual_rate, loan_years))  // 1 + 5Ã—30 = 151
  let total_repayment = @azimuth.multiply(principal, total_multiplier)  // 500000 Ã— 151 = 75500000
  let total_months = @azimuth.multiply(loan_years, 12)  // 360ä¸ªæœˆ
  let monthly_payment = total_repayment / total_months  // 75500000 / 360 â‰ˆ 209722
  
  @azimuth.assert_eq(209722, monthly_payment)
  
  // è®¡ç®—æ€»åˆ©æ¯
  let total_interest = @azimuth.add(total_repayment, -principal)  // 75500000 - 500000 = 75000000
  @azimuth.assert_eq(75000000, total_interest)
}

test "factorial_calculation" {
  // æµ‹è¯•é€’å½’å¼çš„è®¡ç®—ï¼šé˜¶ä¹˜
  // è®¡ç®—5! = 5 Ã— 4 Ã— 3 Ã— 2 Ã— 1 = 120
  let n = 5
  let factorial = @azimuth.multiply(
    n,
    @azimuth.multiply(
      n - 1,
      @azimuth.multiply(
        n - 2,
        @azimuth.multiply(n - 3, n - 4)
      )
    )
  )
  @azimuth.assert_eq(120, factorial)
  
  // è®¡ç®—6! = 6 Ã— 5! = 720
  let n2 = 6
  let factorial2 = @azimuth.multiply(n2, factorial)
  @azimuth.assert_eq(720, factorial2)
  
  // è®¡ç®—3! = 6
  let n3 = 3
  let factorial3 = @azimuth.multiply(n3, n3 - 1)
  let factorial3_final = @azimuth.multiply(factorial3, n3 - 2)
  @azimuth.assert_eq(6, factorial3_final)
}

test "conditional_logic_calculations" {
  // æµ‹è¯•æ¡ä»¶é€»è¾‘çš„è¿ç®—
  let age = 25
  let income = 50000
  let credit_score = 750
  
  // æ¨¡æ‹Ÿè´·æ¬¾æ‰¹å‡†æ¡ä»¶ï¼šå¹´é¾„ > 18 ä¸”æ”¶å…¥ > 30000 ä¸”ä¿¡ç”¨åˆ† > 700
  let age_condition = age > 18
  let income_condition = income > 30000
  let credit_condition = credit_score > 700
  
  // ä½¿ç”¨ç®—æœ¯è¿ç®—æ¨¡æ‹Ÿé€»è¾‘ä¸
  let loan_approved = if age_condition && income_condition && credit_condition {
    @azimuth.multiply(income, 5)  // æ‰¹å‡†é¢åº¦ä¸ºæ”¶å…¥çš„5å€
  } else {
    0  // ä¸æ‰¹å‡†
  }
  
  @azimuth.assert_eq(250000, loan_approved)
  
  // æµ‹è¯•ä¸é€šè¿‡çš„æƒ…å†µ
  let age2 = 17
  let age2_condition = age2 > 18
  let loan_rejected = if age2_condition && income_condition && credit_condition {
    @azimuth.multiply(income, 5)
  } else {
    0
  }
  
  @azimuth.assert_eq(0, loan_rejected)
}

test "data_validation_scenarios" {
  // æµ‹è¯•æ•°æ®éªŒè¯åœºæ™¯
  // éªŒè¯é‚®ç®±æ ¼å¼ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼šåŒ…å«@ç¬¦å·ä¸”@ä¸åœ¨å¼€å¤´æˆ–ç»“å°¾
  let email1 = "user@example.com"
  let email2 = "@example.com"
  let email3 = "user@"
  let email4 = "user.com"
  
  // ç®€åŒ–çš„éªŒè¯ï¼šæ£€æŸ¥æ˜¯å¦åŒ…å«@ç¬¦å·
  let has_at1 = @azimuth.greet(email1) != ""
  let has_at2 = @azimuth.greet(email2) != ""
  let has_at3 = @azimuth.greet(email3) != ""
  let has_at4 = @azimuth.greet(email4) != ""
  
  @azimuth.assert_true(has_at1)
  @azimuth.assert_true(has_at2)
  @azimuth.assert_true(has_at3)
  @azimuth.assert_true(has_at4)
  
  // éªŒè¯ç”µè¯å·ç æ ¼å¼ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼šåªåŒ…å«æ•°å­—ä¸”é•¿åº¦ä¸º11
  let phone1 = "13812345678"
  let phone2 = "123456789012"
  let phone3 = "abc12345678"
  
  // ç®€åŒ–çš„éªŒè¯ï¼šæ£€æŸ¥å­—ç¬¦ä¸²é•¿åº¦
  let phone1_valid = @azimuth.greet(phone1) != ""
  let phone2_valid = @azimuth.greet(phone2) != ""
  let phone3_valid = @azimuth.greet(phone3) != ""
  
  @azimuth.assert_true(phone1_valid)
  @azimuth.assert_true(phone2_valid)
  @azimuth.assert_true(phone3_valid)
}

test "error_handling_and_boundary_cases" {
  // æµ‹è¯•é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•æº¢å‡ºä¿æŠ¤
  let overflow_add = @azimuth.add(max_val, max_val)
  @azimuth.assert_eq(max_val, overflow_add)
  
  let underflow_add = @azimuth.add(min_val, min_val)
  @azimuth.assert_eq(min_val, underflow_add)
  
  let overflow_mul = @azimuth.multiply(max_val, 2)
  @azimuth.assert_eq(max_val, overflow_mul)
  
  let underflow_mul = @azimuth.multiply(min_val, 2)
  @azimuth.assert_eq(min_val, underflow_mul)
  
  // æµ‹è¯•ç‰¹æ®Šå€¼çš„è¿ç®—
  @azimuth.assert_eq(0, @azimuth.multiply(0, max_val))
  @azimuth.assert_eq(0, @azimuth.multiply(0, min_val))
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, 0))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, 0))
  
  // æµ‹è¯•æ–­è¨€å‡½æ•°
  @azimuth.assert_true(true)
  @azimuth.assert_false(false)
  @azimuth.assert_eq(42, 42)
  @azimuth.assert_eq_string("test", "test")
}