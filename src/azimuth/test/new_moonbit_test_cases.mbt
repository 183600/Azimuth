// æ–°å¢ MoonBit æµ‹è¯•ç”¨ä¾‹
// æµ‹è¯• azimuth åŒ…çš„é¢å¤–åŠŸèƒ½å’Œåœºæ™¯

test "temperature_conversion_calculations" {
  // æµ‹è¯•æ¸©åº¦è½¬æ¢è®¡ç®—
  // æ‘„æ°åº¦è½¬åæ°åº¦ï¼ˆç®€åŒ–å…¬å¼ï¼šF = C Ã— 2 + 30ï¼‰
  let celsius = 25
  let fahrenheit = @azimuth.add(@azimuth.multiply(celsius, 2), 30)
  @azimuth.assert_eq(80, fahrenheit)
  
  // åæ°åº¦è½¬æ‘„æ°åº¦ï¼ˆç®€åŒ–å…¬å¼ï¼šC = (F - 30) Ã· 2ï¼‰
  let fahrenheit_back = 80
  let celsius_back = @azimuth.add(fahrenheit_back, -30) / 2
  @azimuth.assert_eq(25, celsius_back)
  
  // æµ‹è¯•å†°ç‚¹å’Œæ²¸ç‚¹
  @azimuth.assert_eq(30, @azimuth.add(@azimuth.multiply(0, 2), 30))  // 0Â°C â†’ 30Â°F
  @azimuth.assert_eq(230, @azimuth.add(@azimuth.multiply(100, 2), 30))  // 100Â°C â†’ 230Â°F
}

test "shopping_cart_advanced_calculations" {
  // æµ‹è¯•é«˜çº§è´­ç‰©è½¦è®¡ç®—
  let item1_price = 299
  let item1_quantity = 2
  let item2_price = 199
  let item2_quantity = 3
  let discount_threshold = 800
  let discount_rate = 10
  let shipping = 25
  let tax_rate = 8
  
  // è®¡ç®—å•†å“æ€»ä»·
  let subtotal1 = @azimuth.multiply(item1_price, item1_quantity)
  let subtotal2 = @azimuth.multiply(item2_price, item2_quantity)
  let subtotal = @azimuth.add(subtotal1, subtotal2)
  
  // è®¡ç®—æŠ˜æ‰£
  let discount = if (subtotal > discount_threshold) {
    @azimuth.multiply(subtotal, discount_rate) / 100
  } else {
    0
  }
  
  // è®¡ç®—æœ€ç»ˆä»·æ ¼
  let discounted_total = @azimuth.add(subtotal, -discount)
  let tax = @azimuth.multiply(discounted_total, tax_rate) / 100
  let final_total = @azimuth.add(@azimuth.add(discounted_total, tax), shipping)
  
  @azimuth.assert_eq(1294, final_total)
}

test "geometry_area_calculations" {
  // æµ‹è¯•å‡ ä½•é¢ç§¯è®¡ç®—
  // çŸ©å½¢é¢ç§¯
  let length = 12
  let width = 8
  let rectangle_area = @azimuth.multiply(length, width)
  @azimuth.assert_eq(96, rectangle_area)
  
  // ä¸‰è§’å½¢é¢ç§¯
  let base = 10
  let height = 6
  let triangle_area = @azimuth.multiply(base, height) / 2
  @azimuth.assert_eq(30, triangle_area)
  
  // æ¢¯å½¢é¢ç§¯
  let top_base = 5
  let bottom_base = 9
  let trapezoid_height = 4
  let trapezoid_area = @azimuth.multiply(@azimuth.add(top_base, bottom_base), trapezoid_height) / 2
  @azimuth.assert_eq(28, trapezoid_area)
}

test "financial_compound_interest" {
  // æµ‹è¯•å¤åˆ©è®¡ç®—
  let principal = 1000
  let rate_percent = 5
  let years = 3
  
  // ç®€åŒ–çš„å¤åˆ©è®¡ç®—ï¼šæœ¬æ¯å’Œ = æœ¬é‡‘ Ã— (1 + åˆ©ç‡)^å¹´æ•°
  // è¿‘ä¼¼ä¸ºï¼šæœ¬é‡‘ Ã— (1 + åˆ©ç‡ Ã— å¹´æ•°)
  let growth_factor = @azimuth.add(100, @azimuth.multiply(rate_percent, years))
  let total = @azimuth.multiply(principal, growth_factor)
  @azimuth.assert_eq(115000, total)  // 1000 Ã— 115 = 115000
  
  // è®¡ç®—åˆ©æ¯
  let interest = @azimuth.add(total, -principal)
  @azimuth.assert_eq(114000, interest)
}

test "statistics_calculations" {
  // æµ‹è¯•ç»Ÿè®¡è®¡ç®—
  // è®¡ç®—ä¸€ç»„æ•°çš„æ€»å’Œã€å¹³å‡å€¼ã€ä¸­ä½æ•°
  let values_sum = @azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(85, 90), 78), 92), 95)
  @azimuth.assert_eq(440, values_sum)
  
  // è®¡ç®—å¹³å‡å€¼
  let count = 5
  let average = values_sum / count
  @azimuth.assert_eq(88, average)
  
  // è®¡ç®—æ–¹å·®ï¼ˆç®€åŒ–ç‰ˆï¼‰
  let diff1 = @azimuth.add(85, -88)
  let diff2 = @azimuth.add(90, -88)
  let diff3 = @azimuth.add(78, -88)
  let diff4 = @azimuth.add(92, -88)
  let diff5 = @azimuth.add(95, -88)
  
  let variance_sum = @azimuth.add(@azimuth.add(@azimuth.add(@azimuth.add(
    @azimuth.multiply(diff1, diff1), 
    @azimuth.multiply(diff2, diff2)), 
    @azimuth.multiply(diff3, diff3)), 
    @azimuth.multiply(diff4, diff4)), 
    @azimuth.multiply(diff5, diff5))
  
  let variance = variance_sum / count
  @azimuth.assert_eq(34, variance)
}

test "time_calculations" {
  // æµ‹è¯•æ—¶é—´è®¡ç®—
  // æ—¶é—´è½¬æ¢ï¼šå°æ—¶ã€åˆ†é’Ÿã€ç§’
  let hours = 2
  let minutes = 45
  let seconds = 30
  
  // è½¬æ¢ä¸ºæ€»ç§’æ•°
  let total_seconds = @azimuth.add(@azimuth.add(
    @azimuth.multiply(hours, 3600), 
    @azimuth.multiply(minutes, 60)), 
    seconds)
  @azimuth.assert_eq(9930, total_seconds)
  
  // è®¡ç®—æ—¶é—´å·®
  let start_hour = 9
  let start_minute = 30
  let end_hour = 14
  let end_minute = 45
  
  let start_total = @azimuth.add(@azimuth.multiply(start_hour, 60), start_minute)
  let end_total = @azimuth.add(@azimuth.multiply(end_hour, 60), end_minute)
  let duration = @azimuth.add(end_total, -start_total)
  @azimuth.assert_eq(315, duration)  // 5å°æ—¶15åˆ†é’Ÿ = 315åˆ†é’Ÿ
}

test "game_score_calculations" {
  // æµ‹è¯•æ¸¸æˆå¾—åˆ†è®¡ç®—
  let base_score = 1000
  let level_multiplier = 3
  let combo_bonus = 500
  let time_bonus = 200
  let penalty = 150
  
  // è®¡ç®—åŸºç¡€å¾—åˆ†
  let level_score = @azimuth.multiply(base_score, level_multiplier)
  
  // è®¡ç®—æ€»å¾—åˆ†
  let total_score = @azimuth.add(@azimuth.add(@azimuth.add(level_score, combo_bonus), time_bonus), -penalty)
  @azimuth.assert_eq(3550, total_score)
  
  // è®¡ç®—æ’ååŠ åˆ†ï¼ˆå‰10%é¢å¤–åŠ 20%ï¼‰
  let rank_bonus = @azimuth.multiply(total_score, 20) / 100
  let final_score = @azimuth.add(total_score, rank_bonus)
  @azimuth.assert_eq(4260, final_score)
}

test "unit_conversion_calculations" {
  // æµ‹è¯•å•ä½è½¬æ¢è®¡ç®—
  // é•¿åº¦è½¬æ¢ï¼šå˜ç±³è½¬è‹±å¯¸ï¼ˆ1è‹±å¯¸ â‰ˆ 2.54å˜ç±³ï¼Œç®€åŒ–ä¸º5/2ï¼‰
  let centimeters = 100
  let inches = centimeters * 2 / 5  // 100 * 2 / 5 = 40
  @azimuth.assert_eq(40, inches)
  
  // é‡é‡è½¬æ¢ï¼šåƒå…‹è½¬ç£…ï¼ˆ1åƒå…‹ â‰ˆ 2.2ç£…ï¼Œç®€åŒ–ä¸º22/10ï¼‰
  let kilograms = 10
  let pounds = @azimuth.multiply(kilograms, 22) / 10  // 10 * 22 / 10 = 22
  @azimuth.assert_eq(22, pounds)
  
  // é€Ÿåº¦è½¬æ¢ï¼šå…¬é‡Œ/æ—¶è½¬ç±³/ç§’ï¼ˆ1å…¬é‡Œ/æ—¶ â‰ˆ 0.278ç±³/ç§’ï¼Œç®€åŒ–ä¸º1/4ï¼‰
  let km_per_hour = 60
  let m_per_second = km_per_hour / 4  // 60 / 4 = 15
  @azimuth.assert_eq(15, m_per_second)
}

test "string_pattern_processing" {
  // æµ‹è¯•å­—ç¬¦ä¸²æ¨¡å¼å¤„ç†
  // æµ‹è¯•å„ç§å­—ç¬¦ä¸²æ ¼å¼
  @azimuth.assert_eq_string("Hello, John_Doe!", @azimuth.greet("John_Doe"))
  @azimuth.assert_eq_string("Hello, user123!", @azimuth.greet("user123"))
  @azimuth.assert_eq_string("Hello, test@example.com!", @azimuth.greet("test@example.com"))
  @azimuth.assert_eq_string("Hello, API_KEY!", @azimuth.greet("API_KEY"))
  @azimuth.assert_eq_string("Hello, ä¸­æ–‡æµ‹è¯•!", @azimuth.greet("ä¸­æ–‡æµ‹è¯•"))
  @azimuth.assert_eq_string("Hello, ğŸŒŸ!", @azimuth.greet("ğŸŒŸ"))
  @azimuth.assert_eq_string("Hello, a+b=c!", @azimuth.greet("a+b=c"))
  @azimuth.assert_eq_string("Hello, $100!", @azimuth.greet("$100"))
}

test "mathematical_sequence_calculations" {
  // æµ‹è¯•æ•°å­¦åºåˆ—è®¡ç®—
  // è®¡ç®—ç­‰å·®æ•°åˆ—ï¼š3, 7, 11, 15, 19ï¼ˆå…¬å·®ä¸º4ï¼‰
  let a1 = 3
  let d = 4
  let n = 5
  let an = @azimuth.add(a1, @azimuth.multiply(d, n - 1))
  @azimuth.assert_eq(19, an)
  
  // è®¡ç®—ç­‰å·®æ•°åˆ—å‰né¡¹å’Œ
  let sum_arithmetic = @azimuth.multiply(n, @azimuth.add(a1, an)) / 2
  @azimuth.assert_eq(55, sum_arithmetic)
  
  // è®¡ç®—ç­‰æ¯”æ•°åˆ—ï¼š2, 6, 18, 54ï¼ˆå…¬æ¯”ä¸º3ï¼‰
  let g1 = 2
  let r = 3
  let gm = @azimuth.multiply(g1, @azimuth.multiply(r, @azimuth.multiply(r, r)))
  @azimuth.assert_eq(54, gm)
  
  // è®¡ç®—ç­‰æ¯”æ•°åˆ—å‰mé¡¹å’Œï¼ˆç®€åŒ–è®¡ç®—ï¼‰
  let sum_geometric = @azimuth.add(@azimuth.add(@azimuth.add(2, 6), 18), 54)
  @azimuth.assert_eq(80, sum_geometric)
}