// æ–°å¢çš„æ ‡å‡† MoonBit æµ‹è¯•ç”¨ä¾‹
// é’ˆå¯¹ azimuth åº“çš„æ ¸å¿ƒåŠŸèƒ½è¿›è¡Œè¡¥å……æµ‹è¯•

// æµ‹è¯•ç”¨ä¾‹ 1: æ•°å€¼æº¢å‡ºè¾¹ç•Œæµ‹è¯•
test "numeric_overflow_boundary_test" {
  // æµ‹è¯•æ¥è¿‘ Int ç±»å‹è¾¹ç•Œå€¼çš„è¿ç®—
  let large_positive = 2147483640
  let small_positive = 7
  let large_negative = -2147483640
  let small_negative = -7
  
  // æµ‹è¯•å¤§æ•°ç›¸åŠ 
  let sum_result = add(large_positive, small_positive)
  assert_eq(2147483647, sum_result)
  
  // æµ‹è¯•å¤§æ•°ç›¸å‡ï¼ˆé€šè¿‡åŠ è´Ÿæ•°ï¼‰
  let diff_result = add(large_negative, small_negative)
  assert_eq(-2147483647, diff_result)
  
  // æµ‹è¯•é›¶çš„å¹³è¡¡ä½œç”¨
  let zero_balance = add(sum_result, diff_result)
  assert_eq(0, zero_balance)
}

// æµ‹è¯•ç”¨ä¾‹ 2: å­—ç¬¦ä¸²å¤„ç†çš„é«˜çº§è¾¹ç•Œæƒ…å†µ
test "advanced_string_edge_cases" {
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦å’Œ Unicode çš„å¤æ‚å­—ç¬¦ä¸²
  let emoji_string = "ğŸš€ğŸŒŸğŸ’»"
  let mixed_string = "Helloä¸–ç•Œ123"
  let special_chars = "!@#$%^&*()"
  
  // æµ‹è¯•å„ç§å­—ç¬¦ä¸²çš„é—®å€™åŠŸèƒ½
  assert_eq_string("Hello, ğŸš€ğŸŒŸğŸ’»!", greet(emoji_string))
  assert_eq_string("Hello, Helloä¸–ç•Œ123!", greet(mixed_string))
  assert_eq_string("Hello, !@#$%^&*()!", greet(special_chars))
}

// æµ‹è¯•ç”¨ä¾‹ 3: å¤æ‚æ•°å­¦å…¬å¼å®ç°
test "complex_mathematical_formulas" {
  // æ¨¡æ‹ŸäºŒæ¬¡æ–¹ç¨‹æ±‚æ ¹å…¬å¼çš„åˆ¤åˆ«å¼è®¡ç®—: bÂ² - 4ac
  let a = 2
  let b = 5
  let c = 3
  
  let b_squared = multiply(b, b)
  let four_ac = multiply(4, multiply(a, c))
  let discriminant = add(b_squared, -four_ac)
  
  assert_eq(25, b_squared)
  assert_eq(24, four_ac)
  assert_eq(1, discriminant)
  
  // æ¨¡æ‹Ÿç»„åˆæ•°å­¦è®¡ç®—: C(5,2) = 5!/(2!(5-2)!) = 10
  let n = 5
  let k = 2
  let n_factorial_part = multiply(n, multiply(n - 1, n - 2))
  let k_factorial = multiply(k, k - 1)
  let n_minus_k_factorial = multiply(n - k, n - k - 1)
  let combination = divide_with_ceil(n_factorial_part, multiply(k_factorial, n_minus_k_factorial))
  
  assert_eq(10, combination)
}

// æµ‹è¯•ç”¨ä¾‹ 4: é”™è¯¯å¤„ç†å¥å£®æ€§æµ‹è¯•
test "error_handling_robustness" {
  // æµ‹è¯•å„ç§è¾¹ç•Œå’Œå¼‚å¸¸æƒ…å†µçš„å¥å£®å¤„ç†
  
  // è¿ç»­çš„é›¶é™¤æ³•æµ‹è¯•
  assert_eq(0, divide_with_ceil(100, 0))
  assert_eq(0, divide_with_ceil(0, 0))
  assert_eq(0, divide_with_ceil(-100, 0))
  
  // æç«¯æ•°å€¼ç»„åˆæµ‹è¯•
  let extreme_sum1 = add(2147483647, -2147483647)
  let extreme_sum2 = add(-2147483648, 2147483647)
  let extreme_product = multiply(2147483647, 1)
  
  assert_eq(0, extreme_sum1)
  assert_eq(-1, extreme_sum2)
  assert_eq(2147483647, extreme_product)
  
  // ç©ºå­—ç¬¦ä¸²å¤„ç†
  assert_eq_string("Hello, !", greet(""))
}

// æµ‹è¯•ç”¨ä¾‹ 5: æ€§èƒ½ç›¸å…³è®¡ç®—æµ‹è¯•
test "performance_related_calculations" {
  // æ¨¡æ‹Ÿç®—æ³•å¤æ‚åº¦è®¡ç®—
  
  // O(nÂ²) å¤æ‚åº¦æ¨¡æ‹Ÿï¼šè®¡ç®—å‰nä¸ªæ•´æ•°çš„å¹³æ–¹å’Œ
  let n = 10
  let sum_of_squares = multiply(n, multiply(n + 1, multiply(2, n + 1))) / 6
  assert_eq(385, sum_of_squares)
  
  // æ¨¡æ‹Ÿç¼“å­˜å‘½ä¸­ç‡è®¡ç®—
  let total_requests = 10000
  let cache_hits = 8500
  let hit_rate = divide_with_ceil(multiply(cache_hits, 100), total_requests)
  let cache_misses = add(total_requests, -cache_hits)
  let miss_rate = divide_with_ceil(multiply(cache_misses, 100), total_requests)
  
  assert_eq(85, hit_rate)
  assert_eq(15, miss_rate)
}

// æµ‹è¯•ç”¨ä¾‹ 6: å®é™…ä¸šåŠ¡åœºæ™¯çš„å¤æ‚åº”ç”¨
test "complex_business_scenarios" {
  // æ¨¡æ‹Ÿç”µå•†å¹³å°çš„è®¢å•å¤„ç†ç³»ç»Ÿ
  
  // è®¡ç®—è®¢å•æ€»ä»·ï¼ˆå«ç¨ã€è¿è´¹ã€æŠ˜æ‰£ï¼‰
  let item1_price = 299
  let item1_qty = 2
  let item2_price = 159
  let item2_qty = 3
  let item3_price = 89
  let item3_qty = 1
  let item4_price = 45
  let item4_qty = 4
  
  // è®¡ç®—å•†å“æ€»ä»·
  let item1_total = multiply(item1_price, item1_qty)
  let item2_total = multiply(item2_price, item2_qty)
  let item3_total = multiply(item3_price, item3_qty)
  let item4_total = multiply(item4_price, item4_qty)
  
  let subtotal = add(add(add(item1_total, item2_total), item3_total), item4_total)
  
  // è®¡ç®—ç¨è´¹ï¼ˆ8%ï¼‰
  let tax_rate = 8
  let tax_amount = divide_with_ceil(multiply(subtotal, tax_rate), 100)
  
  // è®¡ç®—è¿è´¹ï¼ˆæŒ‰é‡é‡å‘ä¸Šå–æ•´ï¼‰
  let total_weight = add(add(add(item1_qty, item2_qty), item3_qty), item4_qty)
  let shipping_rate = 12
  let shipping_cost = multiply(divide_with_ceil(total_weight, 5), shipping_rate)
  
  // åº”ç”¨æŠ˜æ‰£ï¼ˆæ»¡1000å‡100ï¼‰
  let discount_threshold = 1000
  let discount_amount = 100
  let pre_discount_total = add(add(subtotal, tax_amount), shipping_cost)
  let final_total = if pre_discount_total > discount_threshold {
    add(pre_discount_total, -discount_amount)
  } else {
    pre_discount_total
  }
  
  assert_eq(1247, subtotal)
  assert_eq(100, tax_amount)
  assert_eq(24, shipping_cost)
  assert_eq(1271, final_total)
}

// æµ‹è¯•ç”¨ä¾‹ 7: æ•°æ®ç»“æ„ç›¸å…³çš„è®¡ç®—
test "data_structure_calculations" {
  // æ¨¡æ‹Ÿæ•°ç»„æ“ä½œçš„è®¡ç®—
  
  // è®¡ç®—æ•°ç»„å…ƒç´ çš„æ€»å’Œä¸å¹³å‡å€¼
  let elem1 = 15
  let elem2 = 25
  let elem3 = 35
  let elem4 = 45
  let elem5 = 55
  let array_sum = add(add(add(add(elem1, elem2), elem3), elem4), elem5)
  let array_length = 5
  let array_average = divide_with_ceil(array_sum, array_length)
  
  assert_eq(175, array_sum)
  assert_eq(35, array_average)
  
  // æ¨¡æ‹Ÿæ ˆæ“ä½œçš„å†…å­˜ä½¿ç”¨è®¡ç®—
  let stack_capacity = 100
  let element_size = 8
  let current_size = 67
  let memory_used = multiply(current_size, element_size)
  let memory_remaining = multiply(add(stack_capacity, -current_size), element_size)
  
  assert_eq(536, memory_used)
  assert_eq(264, memory_remaining)
  
  // æ¨¡æ‹Ÿé˜Ÿåˆ—çš„å¾ªç¯ç´¢å¼•è®¡ç®—
  let queue_size = 10
  let head_index = 7
  let enqueue_count = 5
  let new_tail_index = add(add(head_index, enqueue_count), -1) % queue_size
  
  assert_eq(1, new_tail_index)
}

// æµ‹è¯•ç”¨ä¾‹ 8: ç®—æ³•æ¨¡æ‹Ÿæµ‹è¯•
test "algorithm_simulation" {
  // æ¨¡æ‹Ÿæ’åºç®—æ³•çš„æ¯”è¾ƒæ¬¡æ•°
  
  // å†’æ³¡æ’åºæœ€åæƒ…å†µæ¯”è¾ƒæ¬¡æ•°: n(n-1)/2
  let bubble_sort_n = 8
  let bubble_comparisons = multiply(bubble_sort_n, add(bubble_sort_n, -1)) / 2
  assert_eq(28, bubble_comparisons)
  
  // å¿«é€Ÿæ’åºå¹³å‡æ¯”è¾ƒæ¬¡æ•°: n log n (ç®€åŒ–ä¸º n*n/2)
  let quick_sort_n = 16
  let quick_comparisons = multiply(quick_sort_n, divide_with_ceil(quick_sort_n, 2))
  assert_eq(128, quick_comparisons)
  
  // æ¨¡æ‹ŸåŠ¨æ€è§„åˆ’çš„ç©ºé—´å¤æ‚åº¦
  let dp_rows = 5
  let dp_cols = 8
  let dp_space = multiply(dp_rows, dp_cols)
  
  assert_eq(40, dp_space)
  
  // æ¨¡æ‹Ÿè´ªå¿ƒç®—æ³•çš„é€‰æ‹©è¿‡ç¨‹
  let total_items = 23
  let knapsack_capacity = 7
  let max_selectable = divide_with_ceil(total_items, knapsack_capacity)
  
  assert_eq(4, max_selectable)
}

// æµ‹è¯•ç”¨ä¾‹ 9: ç»Ÿè®¡åˆ†ææµ‹è¯•
test "statistical_analysis" {
  // æ¨¡æ‹Ÿæ•°æ®é›†çš„ç»Ÿè®¡åˆ†æ
  
  // è®¡ç®—æ•°æ®é›†çš„åŸºæœ¬ç»Ÿè®¡é‡
  let data_count = 7
  
  // è®¡ç®—æ€»å’Œ
  let data_sum = add(add(add(add(add(add(12, 15), 18), 21), 24), 27), 30)
  
  // è®¡ç®—å¹³å‡å€¼
  let data_mean = divide_with_ceil(data_sum, data_count)
  
  // è®¡ç®—æ–¹å·®ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
  let squared_diffs_sum = add(add(add(add(add(add(
    multiply(12 - 21, 12 - 21),
    multiply(15 - 21, 15 - 21)),
    multiply(18 - 21, 18 - 21)),
    multiply(21 - 21, 21 - 21)),
    multiply(24 - 21, 24 - 21)),
    multiply(27 - 21, 27 - 21)),
    multiply(30 - 21, 30 - 21))
  
  let variance = divide_with_ceil(squared_diffs_sum, data_count)
  
  // è®¡ç®—æ ‡å‡†å·®ï¼ˆç®€åŒ–ä¸ºæ•´æ•°ï¼‰
  let std_deviation = divide_with_ceil(variance, 1)
  
  assert_eq(147, data_sum)
  assert_eq(21, data_mean)
  assert_eq(36, variance)
  assert_eq(36, std_deviation)
  
  // æ¨¡æ‹Ÿç›¸å…³æ€§è®¡ç®—
  let x_sum = add(add(add(add(2, 4), 6), add(8, 10)))
  let y_sum = add(add(add(add(3, 7), 9), add(13, 15)))
  
  let xy_sum = add(add(add(add(multiply(2, 3), multiply(4, 7)), multiply(6, 9)), add(multiply(8, 13), multiply(10, 15)))
  
  assert_eq(30, x_sum)
  assert_eq(47, y_sum)
  assert_eq(305, xy_sum)
}

// æµ‹è¯•ç”¨ä¾‹ 10: ç³»ç»Ÿèµ„æºç®¡ç†æµ‹è¯•
test "system_resource_management" {
  // æ¨¡æ‹Ÿç³»ç»Ÿèµ„æºçš„åˆ†é…å’Œç®¡ç†
  
  // CPU æ—¶é—´ç‰‡åˆ†é…è®¡ç®—
  let total_cpu_time = 1000  // æ¯«ç§’
  let process_count = 8
  let time_slice_per_process = divide_with_ceil(total_cpu_time, process_count)
  
  assert_eq(125, time_slice_per_process)
  
  // å†…å­˜æ± ç®¡ç†è®¡ç®—
  let memory_pool_size = 4096  // å­—èŠ‚
  let block_size = 64
  let allocated_blocks = 37
  let used_memory = multiply(allocated_blocks, block_size)
  let remaining_memory = add(memory_pool_size, -used_memory)
  let available_blocks = divide_with_ceil(remaining_memory, block_size)
  
  assert_eq(2368, used_memory)
  assert_eq(1728, remaining_memory)
  assert_eq(27, available_blocks)
  
  // ç£ç›˜I/Oè°ƒåº¦è®¡ç®—
  let total_io_requests = 150
  let io_queue_depth = 32
  let batch_size = 8
  let processing_batches = divide_with_ceil(total_io_requests, batch_size)
  let max_concurrent_batches = divide_with_ceil(io_queue_depth, batch_size)
  
  assert_eq(19, processing_batches)
  assert_eq(4, max_concurrent_batches)
  
  // ç½‘ç»œå¸¦å®½åˆ†é…è®¡ç®—
  let total_bandwidth = 1000  // Mbps
  let priority_weight_high = 5
  let priority_weight_medium = 3
  let priority_weight_low = 2
  let total_weight = add(add(priority_weight_high, priority_weight_medium), priority_weight_low)
  
  let high_priority_bandwidth = divide_with_ceil(multiply(total_bandwidth, priority_weight_high), total_weight)
  let medium_priority_bandwidth = divide_with_ceil(multiply(total_bandwidth, priority_weight_medium), total_weight)
  let low_priority_bandwidth = add(total_bandwidth, add(high_priority_bandwidth, -medium_priority_bandwidth))
  
  assert_eq(10, total_weight)
  assert_eq(500, high_priority_bandwidth)
  assert_eq(300, medium_priority_bandwidth)
  assert_eq(200, low_priority_bandwidth)
}