test "map_carrier_basic_operations" {
  // æµ‹è¯•MapCarrierçš„åŸºæœ¬æ“ä½œ
  let carrier = MapCarrier::new()
  
  // æµ‹è¯•keysæ–¹æ³•
  let keys = carrier.keys()
  assert_eq(keys.length(), 0)
  
  // æµ‹è¯•getæ–¹æ³•
  let value = carrier.get("nonexistent")
  assert_eq(value, None)
}

test "map_carrier_from_map" {
  // æµ‹è¯•ä»Mapåˆ›å»ºMapCarrier
  let mut data = []
  data = data.push(("key1", "value1"))
  data = data.push(("key2", "value2"))
  
  let carrier = MapCarrier::from_map(data)
  
  assert_eq(carrier.get("key1"), Some("value1"))
  assert_eq(carrier.get("key2"), Some("value2"))
  assert_eq(carrier.get("missing"), None)
  
  let keys = carrier.keys()
  assert_eq(keys.length(), 2)
}

test "w3c_trace_context_propagator_constants" {
  // æµ‹è¯•W3C TraceContextå¸¸é‡
  assert_eq(TRACE_PARENT_HEADER, "traceparent")
  assert_eq(TRACE_STATE_HEADER, "tracestate")
}

test "w3c_trace_context_propagator_inject" {
  // æµ‹è¯•W3C TraceContextæ³¨å…¥
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  let carrier = MapCarrier::new()
  
  W3CTraceContextPropagator::inject(ctx, carrier)
  
  // åœ¨ç®€åŒ–å®ç°ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥ä¸€ä¸ªå›ºå®šçš„traceparentå€¼
  let trace_parent = carrier.get(TRACE_PARENT_HEADER)
  assert_eq(trace_parent, Some("00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"))
}

test "w3c_trace_context_propagator_extract_with_header" {
  // æµ‹è¯•W3C TraceContextæå–ï¼ˆæœ‰headerï¼‰
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  
  let mut data = []
  data = data.push((TRACE_PARENT_HEADER, "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"))
  let carrier = MapCarrier::from_map(data)
  
  let extracted_ctx = W3CTraceContextPropagator::extract(ctx, carrier)
  
  // åœ¨ç®€åŒ–å®ç°ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯è¿”å›åŸå§‹context
  // åœ¨å®Œæ•´å®ç°ä¸­ï¼Œåº”è¯¥è§£ætraceparentå¹¶æ›´æ–°context
  assert_eq(true, true)
}

test "w3c_trace_context_propagator_extract_without_header" {
  // æµ‹è¯•W3C TraceContextæå–ï¼ˆæ— headerï¼‰
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  let carrier = MapCarrier::new()
  
  let extracted_ctx = W3CTraceContextPropagator::extract(ctx, carrier)
  
  // åº”è¯¥è¿”å›åŸå§‹context
  assert_eq(true, true)
}

test "w3c_baggage_propagator_constants" {
  // æµ‹è¯•W3C Baggageå¸¸é‡
  assert_eq(BAGGAGE_HEADER, "baggage")
}

test "w3c_baggage_propagator_inject" {
  // æµ‹è¯•W3C Baggageæ³¨å…¥
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  let carrier = MapCarrier::new()
  
  W3CBaggagePropagator::inject(ctx, carrier)
  
  // åœ¨ç®€åŒ–å®ç°ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥ä¸€ä¸ªå›ºå®šçš„baggageå€¼
  let baggage = carrier.get(BAGGAGE_HEADER)
  assert_eq(baggage, Some("key1=value1,key2=value2"))
}

test "w3c_baggage_propagator_extract_with_header" {
  // æµ‹è¯•W3C Baggageæå–ï¼ˆæœ‰headerï¼‰
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  
  let mut data = []
  data = data.push((BAGGAGE_HEADER, "user.id=12345,service.name=api"))
  let carrier = MapCarrier::from_map(data)
  
  let extracted_ctx = W3CBaggagePropagator::extract(ctx, carrier)
  
  // åœ¨ç®€åŒ–å®ç°ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯è¿”å›åŸå§‹context
  // åœ¨å®Œæ•´å®ç°ä¸­ï¼Œåº”è¯¥è§£æbaggageå¹¶æ›´æ–°context
  assert_eq(true, true)
}

test "composite_propagator_creation" {
  // æµ‹è¯•CompositePropagatoråˆ›å»º
  let trace_propagator = W3CTraceContextPropagator
  let baggage_propagator = W3CBaggagePropagator
  let propagators = [trace_propagator, baggage_propagator]
  
  let composite = CompositePropagator::new(propagators)
  assert_eq(composite.propagators.length(), 2)
}

test "composite_propagator_inject" {
  // æµ‹è¯•CompositePropagatoræ³¨å…¥
  let trace_propagator = W3CTraceContextPropagator
  let baggage_propagator = W3CBaggagePropagator
  let propagators = [trace_propagator, baggage_propagator]
  let composite = CompositePropagator::new(propagators)
  
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  let carrier = MapCarrier::new()
  
  CompositePropagator::inject(ctx, carrier)
  
  // åº”è¯¥åŒæ—¶æ³¨å…¥traceparentå’Œbaggage
  let trace_parent = carrier.get(TRACE_PARENT_HEADER)
  let baggage = carrier.get(BAGGAGE_HEADER)
  
  assert_eq(trace_parent, Some("00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"))
  assert_eq(baggage, Some("key1=value1,key2=value2"))
}

test "composite_propagator_extract" {
  // æµ‹è¯•CompositePropagatoræå–
  let trace_propagator = W3CTraceContextPropagator
  let baggage_propagator = W3CBaggagePropagator
  let propagators = [trace_propagator, baggage_propagator]
  let composite = CompositePropagator::new(propagators)
  
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  
  let mut data = []
  data = data.push((TRACE_PARENT_HEADER, "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"))
  data = data.push((BAGGAGE_HEADER, "user.id=12345"))
  let carrier = MapCarrier::from_map(data)
  
  let extracted_ctx = CompositePropagator::extract(ctx, carrier)
  
  // åœ¨ç®€åŒ–å®ç°ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯è¿”å›åŸå§‹context
  // åœ¨å®Œæ•´å®ç°ä¸­ï¼Œåº”è¯¥ä¾æ¬¡åº”ç”¨æ¯ä¸ªpropagator
  assert_eq(true, true)
}

test "map_carrier_comprehensive_operations" {
  // æµ‹è¯•MapCarrierçš„å®Œæ•´æ“ä½œ
  let initial_data = [
    ("existing.key1", "value1"),
    ("existing.key2", "value2"),
    ("x-trace-id", "trace123"),
    ("x-baggage", "user=test")
  ]
  
  let carrier = MapCarrier::from_map(initial_data)
  
  // æµ‹è¯•keysæ–¹æ³•
  let keys = carrier.keys()
  assert_eq(keys.length(), 4)
  
  // éªŒè¯æ‰€æœ‰é”®éƒ½å­˜åœ¨
  assert_eq(keys.contains("existing.key1"), true)
  assert_eq(keys.contains("existing.key2"), true)
  assert_eq(keys.contains("x-trace-id"), true)
  assert_eq(keys.contains("x-baggage"), true)
  
  // æµ‹è¯•getæ–¹æ³•
  assert_eq(carrier.get("existing.key1"), Some("value1"))
  assert_eq(carrier.get("existing.key2"), Some("value2"))
  assert_eq(carrier.get("x-trace-id"), Some("trace123"))
  assert_eq(carrier.get("x-baggage"), Some("user=test"))
  
  // æµ‹è¯•è·å–ä¸å­˜åœ¨çš„é”®
  assert_eq(carrier.get("nonexistent.key"), None)
  assert_eq(carrier.get("missing.header"), None)
  assert_eq(carrier.get(""), None)
  
  // æµ‹è¯•ç©ºé”®å’Œç©ºå€¼çš„æƒ…å†µ
  let data_with_edge_cases = [
    ("", "empty_key_value"),
    ("empty.value", ""),
    ("special.chars", "value-with-special-chars:;?&="),
    ("unicode.test", "æµ‹è¯•å€¼")
  ]
  
  let edge_case_carrier = MapCarrier::from_map(data_with_edge_cases)
  
  assert_eq(edge_case_carrier.get(""), Some("empty_key_value"))
  assert_eq(edge_case_carrier.get("empty.value"), Some(""))
  assert_eq(edge_case_carrier.get("special.chars"), Some("value-with-special-chars:;?&="))
  assert_eq(edge_case_carrier.get("unicode.test"), Some("æµ‹è¯•å€¼"))
  
  // æµ‹è¯•ç©ºcarrier
  let empty_carrier = MapCarrier::new()
  let empty_keys = empty_carrier.keys()
  assert_eq(empty_keys.length(), 0)
  assert_eq(empty_carrier.get("any.key"), None)
}

test "trace_context_error_recovery_malformed_headers" {
  // æµ‹è¯•trace-contextä¼ æ’­å™¨çš„é”™è¯¯æ¢å¤ - å¤„ç†æ ¼å¼é”™è¯¯çš„header
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  
  // æµ‹è¯•å„ç§æ ¼å¼é”™è¯¯çš„traceparent header
  let malformed_cases = [
    // ç¼ºå°‘éƒ¨åˆ†
    "00-0af7651916cd43dd8448eb211c80319c", // ç¼ºå°‘span_idå’Œflags
    "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331", // ç¼ºå°‘flags
    "0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01", // ç¼ºå°‘ç‰ˆæœ¬
    
    // é•¿åº¦é”™è¯¯
    "00-0af7651916cd43dd8448eb211c80319c-b7ad6b71692033-01", // span_idå¤ªçŸ­
    "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-011", // flagså¤ªé•¿
    
    // æ— æ•ˆå­—ç¬¦
    "00-0af7651916cd43dd8448eb211c80319g-b7ad6b7169203331-01", // æ— æ•ˆçš„trace_idå­—ç¬¦
    "00-0af7651916cd43dd8448eb211c80319c-b7ad6b716920333z-01", // æ— æ•ˆçš„span_idå­—ç¬¦
    "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-1z", // æ— æ•ˆçš„flagså­—ç¬¦
    
    // æ ¼å¼é”™è¯¯
    "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01-extra", // é¢å¤–å­—æ®µ
    "01-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01", // ä¸æ”¯æŒçš„ç‰ˆæœ¬
    "invalid-format-string", // å®Œå…¨æ— æ•ˆçš„æ ¼å¼
    
    // è¾¹ç•Œæƒ…å†µ
    "", // ç©ºå­—ç¬¦ä¸²
    "00--b7ad6b7169203331-01", // ç¼ºå°‘trace_id
    "00-0af7651916cd43dd8448eb211c80319c--01", // ç¼ºå°‘span_id
    "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-", // ç¼ºå°‘flags
  ]
  
  // æµ‹è¯•æ¯ç§é”™è¯¯æƒ…å†µéƒ½èƒ½æ­£å¸¸å¤„ç†ï¼ˆä¸ä¼šå´©æºƒï¼‰
  let mut index = 0
  while index < malformed_cases.length() {
    let malformed_header = malformed_cases[index]
    let mut data = []
    data = data.push((TRACE_PARENT_HEADER, malformed_header))
    let carrier = MapCarrier::from_map(data)
    
    // æå–æ“ä½œåº”è¯¥èƒ½å¤Ÿå¤„ç†é”™è¯¯æ ¼å¼å¹¶è¿”å›åŸå§‹context
    let recovered_ctx = W3CTraceContextPropagator::extract(ctx, carrier)
    assert_eq(true, true) // å¦‚æœæ²¡æœ‰å´©æºƒå°±ç®—æˆåŠŸ
    
    index = index + 1
  }
}

test "trace_context_error_recovery_malformed_tracestate" {
  // æµ‹è¯•trace-contextä¼ æ’­å™¨çš„é”™è¯¯æ¢å¤ - å¤„ç†æ ¼å¼é”™è¯¯çš„tracestate header
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  
  // æµ‹è¯•å„ç§æ ¼å¼é”™è¯¯çš„tracestate header
  let malformed_tracestate_cases = [
    // æ— æ•ˆçš„é”®å€¼å¯¹æ ¼å¼
    "invalid-format", // æ²¡æœ‰ç­‰å·
    "key=", // ç©ºå€¼
    "=value", // ç©ºé”®
    "key=value=extra", // å¤šä¸ªç­‰å·
    
    // æ— æ•ˆå­—ç¬¦
    "key@=value", // é”®åŒ…å«æ— æ•ˆå­—ç¬¦
    "key=value,invalid@", // é€—å·åçš„æ— æ•ˆæ ¼å¼
    "key=value,key2=value2@invalid", // æ— æ•ˆåç¼€
    
    // è¾¹ç•Œæƒ…å†µ
    "", // ç©ºå­—ç¬¦ä¸²
    ",", // åªæœ‰é€—å·
    "key=value,", // ç»“å°¾é€—å·
    ",key=value", // å¼€å¤´é€—å·
    "key=value,,key2=value2", // è¿ç»­é€—å·
    
    // è¿‡é•¿çš„é”®æˆ–å€¼
    "a".repeat(257) + "=value", // é”®è¿‡é•¿
    "key=" + "a".repeat(257), // å€¼è¿‡é•¿
  ]
  
  // æµ‹è¯•æ¯ç§é”™è¯¯æƒ…å†µéƒ½èƒ½æ­£å¸¸å¤„ç†
  let mut index = 0
  while index < malformed_tracestate_cases.length() {
    let malformed_tracestate = malformed_tracestate_cases[index]
    let mut data = []
    data = data.push((TRACE_PARENT_HEADER, "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"))
    data = data.push((TRACE_STATE_HEADER, malformed_tracestate))
    let carrier = MapCarrier::from_map(data)
    
    // æå–æ“ä½œåº”è¯¥èƒ½å¤Ÿå¤„ç†é”™è¯¯æ ¼å¼
    let recovered_ctx = W3CTraceContextPropagator::extract(ctx, carrier)
    assert_eq(true, true) // å¦‚æœæ²¡æœ‰å´©æºƒå°±ç®—æˆåŠŸ
    
    index = index + 1
  }
}

test "baggage_error_recovery_malformed_headers" {
  // æµ‹è¯•baggageä¼ æ’­å™¨çš„é”™è¯¯æ¢å¤ - å¤„ç†æ ¼å¼é”™è¯¯çš„header
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  
  // æµ‹è¯•å„ç§æ ¼å¼é”™è¯¯çš„baggage header
  let malformed_baggage_cases = [
    // æ— æ•ˆçš„é”®å€¼å¯¹æ ¼å¼
    "invalid-format", // æ²¡æœ‰ç­‰å·
    "key=", // ç©ºå€¼
    "=value", // ç©ºé”®
    "key=value=extra", // å¤šä¸ªç­‰å·
    
    // æ— æ•ˆå±æ€§æ ¼å¼
    "key=value;invalid", // æ— æ•ˆå±æ€§æ ¼å¼
    "key=value;=invalidvalue", // ç©ºå±æ€§å
    "key=value;invalid=", // ç©ºå±æ€§å€¼
    
    // è¾¹ç•Œæƒ…å†µ
    "", // ç©ºå­—ç¬¦ä¸²
    ",", // åªæœ‰é€—å·
    "key=value,", // ç»“å°¾é€—å·
    ",key=value", // å¼€å¤´é€—å·
    "key=value,,key2=value2", // è¿ç»­é€—å·
    
    // è½¬ä¹‰å­—ç¬¦é—®é¢˜
    "key=value\\", // ä¸å®Œæ•´çš„è½¬ä¹‰
    "key=value\\invalid", // æ— æ•ˆçš„è½¬ä¹‰åºåˆ—
    "key=value\\\\", // åŒåæ–œæ 
    
    // URLç¼–ç é—®é¢˜
    "key=value%2", // ä¸å®Œæ•´çš„URLç¼–ç 
    "key=value%ZZ", // æ— æ•ˆçš„URLç¼–ç 
  ]
  
  // æµ‹è¯•æ¯ç§é”™è¯¯æƒ…å†µéƒ½èƒ½æ­£å¸¸å¤„ç†
  let mut index = 0
  while index < malformed_baggage_cases.length() {
    let malformed_baggage = malformed_baggage_cases[index]
    let mut data = []
    data = data.push((BAGGAGE_HEADER, malformed_baggage))
    let carrier = MapCarrier::from_map(data)
    
    // æå–æ“ä½œåº”è¯¥èƒ½å¤Ÿå¤„ç†é”™è¯¯æ ¼å¼
    let recovered_ctx = W3CBaggagePropagator::extract(ctx, carrier)
    assert_eq(true, true) // å¦‚æœæ²¡æœ‰å´©æºƒå°±ç®—æˆåŠŸ
    
    index = index + 1
  }
}

test "composite_propagator_error_recovery" {
  // æµ‹è¯•Compositeä¼ æ’­å™¨çš„é”™è¯¯æ¢å¤
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  
  // åˆ›å»ºåŒ…å«å¤šä¸ªä¼ æ’­å™¨çš„å¤åˆä¼ æ’­å™¨
  let trace_propagator = W3CTraceContextPropagator
  let baggage_propagator = W3CBaggagePropagator
  let propagators = [trace_propagator, baggage_propagator]
  let composite = CompositePropagator::new(propagators)
  
  // æµ‹è¯•éƒ¨åˆ†headeræŸåçš„æƒ…å†µ
  let mut data = []
  data = data.push((TRACE_PARENT_HEADER, "invalid-traceparent-format"))
  data = data.push((BAGGAGE_HEADER, "key=value")) // åªæœ‰baggageæ˜¯æœ‰æ•ˆçš„
  let partial_valid_carrier = MapCarrier::from_map(data)
  
  // åº”è¯¥èƒ½å¤Ÿå¤„ç†éƒ¨åˆ†æœ‰æ•ˆçš„header
  let recovered_ctx1 = CompositePropagator::extract(ctx, partial_valid_carrier)
  assert_eq(true, true) // å¦‚æœæ²¡æœ‰å´©æºƒå°±ç®—æˆåŠŸ
  
  // æµ‹è¯•æ‰€æœ‰headeréƒ½æŸåçš„æƒ…å†µ
  let mut invalid_data = []
  invalid_data = invalid_data.push((TRACE_PARENT_HEADER, "completely-invalid"))
  invalid_data = invalid_data.push((BAGGAGE_HEADER, "also-completely-invalid"))
  let all_invalid_carrier = MapCarrier::from_map(invalid_data)
  
  // åº”è¯¥èƒ½å¤Ÿå¤„ç†æ‰€æœ‰æ— æ•ˆçš„header
  let recovered_ctx2 = CompositePropagator::extract(ctx, all_invalid_carrier)
  assert_eq(true, true) // å¦‚æœæ²¡æœ‰å´©æºƒå°±ç®—æˆåŠŸ
  
  // æµ‹è¯•æ··åˆæœ‰æ•ˆå’Œæ— æ•ˆçš„tracestate
  let mut mixed_data = []
  mixed_data = mixed_data.push((TRACE_PARENT_HEADER, "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"))
  mixed_data = mixed_data.push((TRACE_STATE_HEADER, "valid=key1,invalid@format,valid2=key2"))
  mixed_data = mixed_data.push((BAGGAGE_HEADER, "valid=value1,invalid=,valid2=value2"))
  let mixed_carrier = MapCarrier::from_map(mixed_data)
  
  // åº”è¯¥èƒ½å¤Ÿå¤„ç†æ··åˆçš„æœ‰æ•ˆå’Œæ— æ•ˆæ•°æ®
  let recovered_ctx3 = CompositePropagator::extract(ctx, mixed_carrier)
  assert_eq(true, true) // å¦‚æœæ²¡æœ‰å´©æºƒå°±ç®—æˆåŠŸ
}

test "propagator_resilience_to_edge_cases" {
  // æµ‹è¯•ä¼ æ’­å™¨å¯¹è¾¹ç•Œæƒ…å†µçš„å¼¹æ€§
  let ctx = @azimuth.telemetry.api.context.Context::empty()
  
  // æµ‹è¯•è¶…é•¿çš„headerå€¼
  let very_long_traceparent = "00-" + "a".repeat(32) + "-" + "b".repeat(16) + "-01"
  let very_long_baggage = "key1=" + "a".repeat(1000) + ",key2=" + "b".repeat(1000)
  
  let mut long_data = []
  long_data = long_data.push((TRACE_PARENT_HEADER, very_long_traceparent))
  long_data = long_data.push((BAGGAGE_HEADER, very_long_baggage))
  let long_carrier = MapCarrier::from_map(long_data)
  
  // åº”è¯¥èƒ½å¤Ÿå¤„ç†è¶…é•¿çš„headerå€¼
  let recovered_ctx1 = W3CTraceContextPropagator::extract(ctx, long_carrier)
  let recovered_ctx2 = W3CBaggagePropagator::extract(ctx, long_carrier)
  assert_eq(true, true)
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„headerå€¼
  let special_chars_tracestate = "key=value with spaces,key2=value,with,commas,key3=value;with;semicolons"
  let special_chars_baggage = "key=value with spaces,key2=value,with,commas,key3=value;with;semicolons"
  
  let mut special_data = []
  special_data = special_data.push((TRACE_PARENT_HEADER, "00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01"))
  special_data = special_data.push((TRACE_STATE_HEADER, special_chars_tracestate))
  special_data = special_data.push((BAGGAGE_HEADER, special_chars_baggage))
  let special_carrier = MapCarrier::from_map(special_data)
  
  // åº”è¯¥èƒ½å¤Ÿå¤„ç†åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„headerå€¼
  let recovered_ctx3 = W3CTraceContextPropagator::extract(ctx, special_carrier)
  let recovered_ctx4 = W3CBaggagePropagator::extract(ctx, special_carrier)
  assert_eq(true, true)
  
  // æµ‹è¯•Unicodeå­—ç¬¦
  let unicode_baggage = "ä¸­æ–‡é”®=ä¸­æ–‡å€¼,emoji=ğŸ”¥ğŸš€,mixed=ä¸­mixedæ–‡"
  let mut unicode_data = []
  unicode_data = unicode_data.push((BAGGAGE_HEADER, unicode_baggage))
  let unicode_carrier = MapCarrier::from_map(unicode_data)
  
  // åº”è¯¥èƒ½å¤Ÿå¤„ç†Unicodeå­—ç¬¦
  let recovered_ctx5 = W3CBaggagePropagator::extract(ctx, unicode_carrier)
  assert_eq(true, true)
  
  // æµ‹è¯•ç©ºcarrier
  let empty_carrier = MapCarrier::new()
  let recovered_ctx6 = W3CTraceContextPropagator::extract(ctx, empty_carrier)
  let recovered_ctx7 = W3CBaggagePropagator::extract(ctx, empty_carrier)
  assert_eq(true, true)
}