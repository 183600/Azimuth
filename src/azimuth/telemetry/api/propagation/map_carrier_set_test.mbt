test "map_carrier_set_operations" {
  // æµ‹è¯•MapCarrierçš„setæ“ä½œï¼ˆè™½ç„¶åœ¨å½“å‰å®ç°ä¸­æ˜¯no-opï¼‰
  
  let initial_data = [
    ("key1", "value1"),
    ("key2", "value2")
  ]
  
  let carrier = MapCarrier::from_map(initial_data)
  
  // æµ‹è¯•setæ“ä½œï¼ˆå½“å‰å®ç°æ˜¯no-opï¼Œä½†åº”è¯¥ä¸ä¼šå´©æºƒï¼‰
  carrier.set("key3", "value3")
  carrier.set("key1", "new_value1") // è¦†ç›–ç°æœ‰é”®
  carrier.set("", "empty_key_value") // ç©ºé”®
  carrier.set("empty_value", "") // ç©ºå€¼
  carrier.set("special.chars", "!@#$%^&*()") // ç‰¹æ®Šå­—ç¬¦
  carrier.set("unicode.key", "Unicodeå€¼ğŸš€") // Unicodeå€¼
  
  // éªŒè¯åŸå§‹æ•°æ®ä»ç„¶å­˜åœ¨ï¼ˆå› ä¸ºsetæ˜¯no-opï¼‰
  let keys = carrier.keys()
  assert_eq(keys.length(), 2) // åŸå§‹æ•°æ®åº”è¯¥ä¿æŒä¸å˜
  
  match carrier.get("key1") {
    Some(value) => assert_eq(value, "value1") // åŸå§‹å€¼
    None => @test.fail("Expected Some(value)")
  }
  
  match carrier.get("key2") {
    Some(value) => assert_eq(value, "value2")
    None => @test.fail("Expected Some(value)")
  }
  
  // éªŒè¯æ–°è®¾ç½®çš„é”®ä¸å­˜åœ¨ï¼ˆå› ä¸ºsetæ˜¯no-opï¼‰
  match carrier.get("key3") {
    Some(_) => @test.fail("Expected None for key3")
    None => assert_eq(true, true)
  }
  
  // æµ‹è¯•ç©ºcarrierçš„setæ“ä½œ
  let empty_carrier = MapCarrier::new()
  let empty_keys = empty_carrier.keys()
  assert_eq(empty_keys.length(), 0)
  
  empty_carrier.set("new.key", "new.value")
  empty_carrier.set("another.key", "another.value")
  
  // éªŒè¯ä»ç„¶æ˜¯ç©ºçš„ï¼ˆå› ä¸ºsetæ˜¯no-opï¼‰
  let keys_after_set = empty_carrier.keys()
  assert_eq(keys_after_set.length(), 0)
  
  match empty_carrier.get("new.key") {
    Some(_) => @test.fail("Expected None for new.key")
    None => assert_eq(true, true)
  }
  
  // æµ‹è¯•to_mapæ“ä½œ
  let map_data = carrier.to_map()
  assert_eq(map_data.length(), 2)
  assert_eq(map_data[0], ("key1", "value1"))
  assert_eq(map_data[1], ("key2", "value2"))
  
  // æµ‹è¯•å¤§é‡setæ“ä½œ
  let large_carrier = MapCarrier::new()
  let mut i = 0
  while i < 100 {
    large_carrier.set("key." + i.to_string(), "value." + i.to_string())
    i = i + 1
  }
  
  // éªŒè¯ä»ç„¶æ˜¯ç©ºçš„
  let large_keys = large_carrier.keys()
  assert_eq(large_keys.length(), 0)
  
  // æµ‹è¯•å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦çš„setæ“ä½œ
  let special_carrier = MapCarrier::new()
  special_carrier.set("key.with.dots", "value.with.dots")
  special_carrier.set("key-with-dashes", "value-with-dashes")
  special_carrier.set("key_with_underscores", "value_with_underscores")
  special_carrier.set("key with spaces", "value with spaces")
  special_carrier.set("KEY.WITH.UPPERCASE", "VALUE.WITH.UPPERCASE")
  special_carrier.set("key.with.symbols!@#$%", "value.with.symbols!@#$%")
  
  // éªŒè¯ä»ç„¶æ˜¯ç©ºçš„
  let special_keys = special_carrier.keys()
  assert_eq(special_keys.length(), 0)
  
  // æµ‹è¯•éå¸¸é•¿çš„é”®å’Œå€¼
  let long_carrier = MapCarrier::new()
  let long_key = "a".repeat(1000)
  let long_value = "b".repeat(1000)
  long_carrier.set(long_key, long_value)
  
  // éªŒè¯ä»ç„¶æ˜¯ç©ºçš„
  let long_keys = long_carrier.keys()
  assert_eq(long_keys.length(), 0)
  
  assert_eq(true, true) // å¦‚æœæ²¡æœ‰å´©æºƒï¼Œæµ‹è¯•é€šè¿‡
}