// é¢å¤–çš„é«˜è´¨é‡ MoonBit æµ‹è¯•ç”¨ä¾‹
// é’ˆå¯¹ azimuth åº“çš„æ ¸å¿ƒåŠŸèƒ½è¿›è¡Œè¡¥å……æµ‹è¯•

// æµ‹è¯• 1: å¤æ‚æ•°å­¦è¡¨è¾¾å¼è®¡ç®—
test "complex_mathematical_expression" {
  // æµ‹è¯•åµŒå¥—æ•°å­¦è¡¨è¾¾å¼: (a + b) * (c - d) / e
  let a = 15
  let b = 25
  let c = 100
  let d = 40
  let e = 6
  
  let step1 = add(a, b)  // 15 + 25 = 40
  let step2 = add(c, -d)  // 100 - 40 = 60
  let step3 = multiply(step1, step2)  // 40 * 60 = 2400
  let result = divide_with_ceil(step3, e)  // ceil(2400/6) = 400
  
  assert_eq(400, result)
}

// æµ‹è¯• 2: è¾¹ç•Œå€¼å’Œæé™æƒ…å†µ
test "boundary_andæé™_values" {
  // æµ‹è¯•é›¶çš„è¾¹ç•Œæƒ…å†µ
  assert_eq(0, multiply(0, 2147483647))
  assert_eq(0, add(0, 0))
  
  // æµ‹è¯•å¤§æ•°è¿ç®—
  let large_num = 1000000
  assert_eq(2000000, add(large_num, large_num))
  assert_eq(1000000000000, multiply(large_num, large_num))
  
  // æµ‹è¯•é™¤æ³•çš„è¾¹ç•Œæƒ…å†µ
  assert_eq(1, divide_with_ceil(1, 1))
  assert_eq(0, divide_with_ceil(0, 1000))
  assert_eq(0, divide_with_ceil(1000, 0))
}

// æµ‹è¯• 3: å­—ç¬¦ä¸²å¤„ç†å’Œç‰¹æ®Šå­—ç¬¦
test "string_processing_special_chars" {
  // æµ‹è¯•å„ç§ç‰¹æ®Šå­—ç¬¦å’ŒUnicode
  assert_eq_string("Hello, ğŸŒŸ!", greet("ğŸŒŸ"))
  assert_eq_string("Hello, ä¸­æ–‡æµ‹è¯•!", greet("ä¸­æ–‡æµ‹è¯•"))
  assert_eq_string("Hello, Ã©Ã Ã¨ÃªÃ«!", greet("Ã©Ã Ã¨ÃªÃ«"))
  assert_eq_string("Hello, @#$%^&*()!", greet("@#$%^&*()"))
  assert_eq_string("Hello, \n\t\r!", greet("\n\t\r"))
}

// æµ‹è¯• 4: å®é™…ä¸šåŠ¡åœºæ™¯ - è®¢å•å¤„ç†
test "business_order_processing" {
  // æ¨¡æ‹Ÿç”µå•†è®¢å•å¤„ç†
  let unit_price = 89
  let quantity = 7
  let tax_rate = 8  // 8%
  let shipping_cost = 25
  let discount_threshold = 500
  let discount_amount = 50
  
  // è®¡ç®—å•†å“æ€»ä»·
  let subtotal = multiply(unit_price, quantity)
  
  // è®¡ç®—ç¨è´¹
  let tax = divide_with_ceil(multiply(subtotal, tax_rate), 100)
  
  // è®¡ç®—æŠ˜æ‰£å‰æ€»ä»·
  let pre_total = add(add(subtotal, tax), shipping_cost)
  
  // åº”ç”¨æŠ˜æ‰£ï¼ˆå¦‚æœæ»¡è¶³æ¡ä»¶ï¼‰
  let final_total = if pre_total > discount_threshold {
    add(pre_total, -discount_amount)
  } else {
    pre_total
  }
  
  assert_eq(623, subtotal)
  assert_eq(50, tax)
  assert_eq(698, pre_total)
  assert_eq(648, final_total)
}

// æµ‹è¯• 5: æ•°æ®åˆ†æå’Œç»Ÿè®¡
test "data_analysis_statistics" {
  // æ¨¡æ‹Ÿé”€å”®æ•°æ®åˆ†æ
  let sales_data = [12000, 15000, 18000, 22000, 25000, 28000]
  let total_sales = add(add(add(add(add(sales_data[0], sales_data[1]), sales_data[2]), sales_data[3]), sales_data[4]), sales_data[5])
  
  // è®¡ç®—å¹³å‡å€¼
  let average = divide_with_ceil(total_sales, 6)
  
  // è®¡ç®—å¢é•¿ç‡
  let growth_rate = divide_with_ceil(multiply(sales_data[5] - sales_data[0], 100), sales_data[0])
  
  assert_eq(120000, total_sales)
  assert_eq(20000, average)
  assert_eq(134, growth_rate)
}

// æµ‹è¯• 6: ç®—æ³•æ¨¡æ‹Ÿ - æ’åºå’Œæœç´¢
test "algorithm_simulation" {
  // æ¨¡æ‹Ÿå†’æ³¡æ’åºçš„æ¯”è¾ƒæ¬¡æ•°
  let array_size = 10
  let comparisons_per_pass = add(array_size, -1)
  let total_comparisons = multiply(comparisons_per_pass, divide_with_ceil(array_size, 2))
  
  // æ¨¡æ‹ŸäºŒåˆ†æŸ¥æ‰¾çš„æœ€å¤§æ¯”è¾ƒæ¬¡æ•°
  let max_binary_search_comparisons = divide_with_ceil(
    multiply(2, array_size), 
    100
  )
  
  assert_eq(45, total_comparisons)
  assert_eq(1, max_binary_search_comparisons)
}

// æµ‹è¯• 7: å·¥ç¨‹è®¡ç®—
test "engineering_calculation" {
  // æ¨¡æ‹Ÿå»ºç­‘å·¥ç¨‹è®¡ç®—
  let building_length = 50  // ç±³
  let building_width = 30   // ç±³
  let floor_height = 3.5    // ç±³ï¼ˆå‘ä¸Šå–æ•´ä¸º4ï¼‰
  let floors = 8
  
  // è®¡ç®—å»ºç­‘é¢ç§¯
  let floor_area = multiply(building_length, building_width)
  
  // è®¡ç®—æ€»å»ºç­‘ä½“ç§¯
  let total_volume = multiply(floor_area, multiply(floors, 4))
  
  // è®¡ç®—éœ€è¦çš„å»ºç­‘ææ–™ï¼ˆå‡è®¾æ¯ç«‹æ–¹ç±³éœ€è¦2å•ä½ææ–™ï¼‰
  let materials_needed = multiply(total_volume, 2)
  
  assert_eq(1500, floor_area)
  assert_eq(48000, total_volume)
  assert_eq(96000, materials_needed)
}

// æµ‹è¯• 8: é‡‘èè®¡ç®—
test "financial_calculation" {
  // æ¨¡æ‹Ÿå¤åˆ©è®¡ç®—
  let principal = 10000
  let annual_rate = 5  // 5%
  let years = 3
  
  // ç¬¬ä¸€å¹´
  let year1_interest = divide_with_ceil(multiply(principal, annual_rate), 100)
  let year1_balance = add(principal, year1_interest)
  
  // ç¬¬äºŒå¹´
  let year2_interest = divide_with_ceil(multiply(year1_balance, annual_rate), 100)
  let year2_balance = add(year1_balance, year2_interest)
  
  // ç¬¬ä¸‰å¹´
  let year3_interest = divide_with_ceil(multiply(year2_balance, annual_rate), 100)
  let final_balance = add(year2_balance, year3_interest)
  
  assert_eq(500, year1_interest)
  assert_eq(10500, year1_balance)
  assert_eq(525, year2_interest)
  assert_eq(11025, year2_balance)
  assert_eq(552, year3_interest)
  assert_eq(11577, final_balance)
}

// æµ‹è¯• 9: æ€§èƒ½åŸºå‡†æµ‹è¯•
test "performance_benchmark" {
  // æ¨¡æ‹Ÿæ€§èƒ½åŸºå‡†æµ‹è¯•
  let base_operations = 1000
  let optimization_factor = 3
  let overhead_percentage = 15
  
  // è®¡ç®—ä¼˜åŒ–åçš„æ“ä½œæ•°
  let optimized_ops = multiply(base_operations, optimization_factor)
  
  // è®¡ç®—å¼€é”€
  let overhead = divide_with_ceil(multiply(optimized_ops, overhead_percentage), 100)
  
  // è®¡ç®—å®é™…æ€§èƒ½
  let actual_performance = add(optimized_ops, -overhead)
  
  // è®¡ç®—æ€§èƒ½æå‡å€æ•°
  let performance_gain = divide_with_ceil(actual_performance, base_operations)
  
  assert_eq(3000, optimized_ops)
  assert_eq(450, overhead)
  assert_eq(2550, actual_performance)
  assert_eq(3, performance_gain)
}

// æµ‹è¯• 10: é”™è¯¯å¤„ç†å’Œå¥å£®æ€§
test "error_handling_robustness" {
  // æµ‹è¯•é™¤é›¶é”™è¯¯å¤„ç†
  assert_eq(0, divide_with_ceil(100, 0))
  assert_eq(0, divide_with_ceil(-100, 0))
  assert_eq(0, divide_with_ceil(0, 0))
  
  // æµ‹è¯•æç«¯æ•°å€¼
  let extreme_positive = 2147483647
  let extreme_negative = -2147483648
  
  // æµ‹è¯•æç«¯å€¼çš„åŠ æ³•
  let extreme_add = add(extreme_positive, -1)
  assert_eq(2147483646, extreme_add)
  
  // æµ‹è¯•æç«¯å€¼çš„ä¹˜æ³•ï¼ˆå°æ•°å€¼ï¼‰
  let extreme_multiply = multiply(extreme_negative, 0)
  assert_eq(0, extreme_multiply)
  
  // æµ‹è¯•ç©ºå­—ç¬¦ä¸²å’Œç‰¹æ®Šè¾“å…¥
  assert_eq_string("Hello, !", greet(""))
  assert_eq_string("Hello, null!", greet("null"))
}