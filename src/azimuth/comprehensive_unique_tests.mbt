// ç»¼åˆç‹¬ç‰¹æµ‹è¯•ç”¨ä¾‹ - è¦†ç›–é«˜çº§åœºæ™¯å’Œè¾¹ç•Œæƒ…å†µ

// æµ‹è¯•ç”¨ä¾‹ 1: æ€§èƒ½å‹åŠ›æµ‹è¯• - å¤§é‡è¿ç»­è¿ç®—
///|
test "performance_stress_test" {
  // æµ‹è¯•å¤§é‡è¿ç»­åŠ æ³•è¿ç®—çš„æ€§èƒ½
  let result = add(
    add(
      add(
        add(
          add(1000000, 2000000),
          add(3000000, 4000000)
        ),
        add(5000000, 6000000)
      ),
      add(7000000, 8000000)
    ),
    add(9000000, 10000000)
  )
  assert_eq(55000000, result)
  
  // æµ‹è¯•å¤§é‡è¿ç»­ä¹˜æ³•è¿ç®—çš„æ€§èƒ½
  let product = multiply(
    multiply(
      multiply(2, 3),
      multiply(4, 5)
    ),
    multiply(6, 7)
  )
  assert_eq(5040, product)
}

// æµ‹è¯•ç”¨ä¾‹ 2: åµŒå¥—è¿ç®—æµ‹è¯• - å¤æ‚çš„åµŒå¥—è¡¨è¾¾å¼
///|
test "nested_operations_test" {
  // æµ‹è¯•æ·±åº¦åµŒå¥—çš„åŠ æ³•å’Œä¹˜æ³•ç»„åˆ
  // è®¡ç®—: (1 + 2) * (3 + 4) + (5 + 6) * (7 + 8)
  let part1 = multiply(
    add(1, 2),
    add(3, 4)
  )
  let part2 = multiply(
    add(5, 6),
    add(7, 8)
  )
  let result = add(part1, part2)
  assert_eq(186, result)  // 3 * 7 + 11 * 15 = 21 + 165 = 186
  
  // æµ‹è¯•æ›´å¤æ‚çš„åµŒå¥—: ((a+b)*(c+d)) + ((e+f)*(g+h)) + ((i+j)*(k+l))
  let complex = add(
    add(
      multiply(add(1, 2), add(3, 4)),
      multiply(add(5, 6), add(7, 8))
    ),
    multiply(add(9, 10), add(11, 12))
  )
  assert_eq(623, complex)  // 21 + 165 + 437 = 623
}

// æµ‹è¯•ç”¨ä¾‹ 3: å­—ç¬¦ä¸²è¾¹ç•Œæµ‹è¯• - æé•¿å­—ç¬¦ä¸²å’Œç‰¹æ®Šå­—ç¬¦
///|
test "string_boundary_test" {
  // æµ‹è¯•åŒ…å«æ•°å­—ã€å­—æ¯ã€ç¬¦å·çš„å¤æ‚å­—ç¬¦ä¸²
  let complex1 = "User123_Admin!@#"
  assert_eq("Hello, User123_Admin!@#!", greet(complex1))
  
  // æµ‹è¯•åŒ…å«ç©ºæ ¼çš„å­—ç¬¦ä¸²
  let complex2 = "John Doe Jr."
  assert_eq("Hello, John Doe Jr.!", greet(complex2))
  
  // æµ‹è¯•åŒ…å«å¤šç§Unicodeå­—ç¬¦çš„å­—ç¬¦ä¸²
  let complex3 = "ğŸŒ™â­ğŸŒŸâœ¨ğŸ’«"
  assert_eq("Hello, ğŸŒ™â­ğŸŒŸâœ¨ğŸ’«!", greet(complex3))
  
  // æµ‹è¯•åŒ…å«HTMLæ ‡ç­¾é£æ ¼çš„å­—ç¬¦ä¸²
  let complex4 = "<div>content</div>"
  assert_eq("Hello, <div>content</div>!", greet(complex4))
  
  // æµ‹è¯•åŒ…å«è·¯å¾„é£æ ¼çš„å­—ç¬¦ä¸²
  let complex5 = "/home/user/documents"
  assert_eq("Hello, /home/user/documents!", greet(complex5))
}

// æµ‹è¯•ç”¨ä¾‹ 4: æ•°å­¦æ’ç­‰å¼æµ‹è¯• - æ›´é«˜çº§çš„æ•°å­¦æ€§è´¨
///|
test "mathematical_identities_test" {
  // æµ‹è¯•å¹³æ–¹å·®å…¬å¼: aÂ² - bÂ² = (a+b)(a-b)
  let a = 15
  let b = 8
  let a_squared = multiply(a, a)
  let b_squared = multiply(b, b)
  let difference = add(a_squared, multiply(-1, b_squared))
  
  let sum = add(a, b)
  let diff = add(a, multiply(-1, b))
  let product = multiply(sum, diff)
  
  assert_eq(difference, product)  // 225 - 64 = 161, (15+8)(15-8) = 23*7 = 161
  
  // æµ‹è¯•ç«‹æ–¹å’Œå…¬å¼: aÂ³ + bÂ³ = (a+b)(aÂ²-ab+bÂ²)
  let x = 4
  let y = 2
  let x_cubed = multiply(x, multiply(x, x))
  let y_cubed = multiply(y, multiply(y, y))
  let sum_cubes = add(x_cubed, y_cubed)
  
  let x_squared = multiply(x, x)
  let y_squared = multiply(y, y)
  let xy = multiply(x, y)
  let formula = multiply(
    add(x, y),
    add(add(x_squared, multiply(-1, xy)), y_squared)
  )
  
  assert_eq(sum_cubes, formula)  // 64 + 8 = 72, (4+2)(16-8+4) = 6*12 = 72
}

// æµ‹è¯•ç”¨ä¾‹ 5: å®é™…å•†ä¸šåœºæ™¯æµ‹è¯• - å¤æ‚çš„å•†ä¸šè®¡ç®—
///|
test "business_scenario_test" {
  // æ¨¡æ‹Ÿè®¢å•æ€»ä»·è®¡ç®—ï¼šå•†å“ä»·æ ¼ * æ•°é‡ + ç¨è´¹ - æŠ˜æ‰£
  
  // å•†å“1: ä»·æ ¼299, æ•°é‡2
  let item1_price = 299
  let item1_quantity = 2
  let item1_total = multiply(item1_price, item1_quantity)
  
  // å•†å“2: ä»·æ ¼199, æ•°é‡3
  let item2_price = 199
  let item2_quantity = 3
  let item2_total = multiply(item2_price, item2_quantity)
  
  // å•†å“3: ä»·æ ¼99, æ•°é‡1
  let item3_price = 99
  let item3_quantity = 1
  let item3_total = multiply(item3_price, item3_quantity)
  
  // å°è®¡
  let subtotal = add(add(item1_total, item2_total), item3_total)
  
  // ç¨è´¹ (8% = 8/100, æˆ‘ä»¬è®¡ç®—ç¨åæ€»ä»·)
  let tax_rate_numerator = 108  // (100 + 8)
  let tax_rate_denominator = 100
  let total_with_tax_times_100 = multiply(subtotal, tax_rate_numerator)
  
  // æŠ˜æ‰£ (50å…ƒ)
  let discount = 50
  let final_total_times_100 = add(
    total_with_tax_times_100,
    multiply(-100, discount)
  )
  
  // éªŒè¯è®¡ç®—: (299*2 + 199*3 + 99*1) = 598 + 597 + 99 = 1294
  // å«ç¨: 1294 * 1.08 = 1397.52
  // å‡æŠ˜æ‰£: 1397.52 - 50 = 1347.52
  // ä¹˜ä»¥100: 134752
  assert_eq(134752, final_total_times_100)
}

// æµ‹è¯•ç”¨ä¾‹ 6: é”™è¯¯æ¢å¤æµ‹è¯• - æç«¯æ¡ä»¶ä¸‹çš„è¡Œä¸º
///|
test "error_recovery_test" {
  // æµ‹è¯•è¿ç»­æº¢å‡ºæ“ä½œåçš„æ¢å¤
  let overflow1 = add(2147483647, 1)  // åº”è¯¥è¿”å›æœ€å¤§å€¼
  let overflow2 = add(overflow1, 1)    // åº”è¯¥ä»ç„¶è¿”å›æœ€å¤§å€¼
  let normal1 = add(overflow2, -100)   // åº”è¯¥è¿”å›æœ€å¤§å€¼-100
  assert_eq(2147483647, overflow1)
  assert_eq(2147483647, overflow2)
  assert_eq(2147483547, normal1)
  
  // æµ‹è¯•ä¹˜æ³•æº¢å‡ºåçš„æ¢å¤
  let mul_overflow1 = multiply(46342, 46342)  // åº”è¯¥è¿”å›æœ€å¤§å€¼
  let mul_overflow2 = multiply(mul_overflow1, 2)  // åº”è¯¥è¿”å›æœ€å¤§å€¼
  let mul_normal = multiply(mul_overflow2, 0)  // åº”è¯¥è¿”å›0
  assert_eq(2147483647, mul_overflow1)
  assert_eq(2147483647, mul_overflow2)
  assert_eq(0, mul_normal)
  
  // æµ‹è¯•æœ€å°å€¼æ“ä½œåçš„æ¢å¤
  let min_val = -2147483648
  let min_add = add(min_val, 1)  // åº”è¯¥è¿”å›æœ€å°å€¼+1
  let min_recover = add(min_add, -1)  // åº”è¯¥è¿”å›æœ€å°å€¼
  assert_eq(-2147483647, min_add)
  assert_eq(-2147483648, min_recover)
}

// æµ‹è¯•ç”¨ä¾‹ 7: ç»„åˆè¾¹ç•Œæµ‹è¯• - å¤šä¸ªè¾¹ç•Œæ¡ä»¶çš„ç»„åˆ
///|
test "combined_boundary_test" {
  // æµ‹è¯•å¤šä¸ªè¾¹ç•Œæ¡ä»¶çš„ç»„åˆæ“ä½œ
  
  // è¾¹ç•Œå€¼ç»„åˆ1: æœ€å¤§å€¼è¿ç®—
  let max_val = 2147483647
  let min_val = -2147483648
  let combo1 = add(
    add(max_val, min_val),
    multiply(1, 1)
  )
  assert_eq(0, combo1)  // (max + min) + 1 = -1 + 1 = 0
  
  // è¾¹ç•Œå€¼ç»„åˆ2: æ¥è¿‘æº¢å‡ºçš„è¿ç®—
  let near_max = 2147483640
  let near_min = -2147483640
  let combo2 = add(
    add(near_max, 7),
    add(near_min, -8)
  )
  assert_eq(-1, combo2)  // (2147483640 + 7) + (-2147483640 + -8) = 2147483647 + -2147483648 = -1
  
  // è¾¹ç•Œå€¼ç»„åˆ3: ä¹˜æ³•å’ŒåŠ æ³•æ··åˆ
  let combo3 = add(
    multiply(46341, 46341),  // æ¥è¿‘æº¢å‡º
    multiply(-1, -1)         // ç®€å•è¿ç®—
  )
  assert_eq(2147483647, combo3)  // 2147483647 + 1 = 2147483647 (æº¢å‡ºåˆ°æœ€å¤§å€¼)
}

// æµ‹è¯•ç”¨ä¾‹ 8: ç®—æ³•å¤æ‚åº¦æµ‹è¯• - ç‰¹å®šç®—æ³•çš„æ€§èƒ½
///|
test "algorithm_complexity_test" {
  // æµ‹è¯•æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—çš„æ¨¡æ‹Ÿ
  // F(n) = F(n-1) + F(n-2), F(0)=0, F(1)=1
  // æˆ‘ä»¬è®¡ç®—å‰å‡ é¡¹
  
  let f0 = 0
  let f1 = 1
  let f2 = add(f1, f0)  // 1 + 0 = 1
  let f3 = add(f2, f1)  // 1 + 1 = 2
  let f4 = add(f3, f2)  // 2 + 1 = 3
  let f5 = add(f4, f3)  // 3 + 2 = 5
  let f6 = add(f5, f4)  // 5 + 3 = 8
  let f7 = add(f6, f5)  // 8 + 5 = 13
  let f8 = add(f7, f6)  // 13 + 8 = 21
  let f9 = add(f8, f7)  // 21 + 13 = 34
  let f10 = add(f9, f8) // 34 + 21 = 55
  
  assert_eq(1, f2)
  assert_eq(2, f3)
  assert_eq(3, f4)
  assert_eq(5, f5)
  assert_eq(8, f6)
  assert_eq(13, f7)
  assert_eq(21, f8)
  assert_eq(34, f9)
  assert_eq(55, f10)
  
  // æµ‹è¯•é˜¶ä¹˜è®¡ç®—çš„æ¨¡æ‹Ÿ
  // n! = n * (n-1) * ... * 1
  let fact1 = 1  // 1!
  let fact2 = multiply(2, fact1)   // 2 * 1 = 2
  let fact3 = multiply(3, fact2)   // 3 * 2 = 6
  let fact4 = multiply(4, fact3)   // 4 * 6 = 24
  let fact5 = multiply(5, fact4)   // 5 * 24 = 120
  let fact6 = multiply(6, fact5)   // 6 * 120 = 720
  
  assert_eq(2, fact2)
  assert_eq(6, fact3)
  assert_eq(24, fact4)
  assert_eq(120, fact5)
  assert_eq(720, fact6)
}

// æµ‹è¯•ç”¨ä¾‹ 9: æ•°æ®ç±»å‹è¾¹ç•Œæµ‹è¯• - Intç±»å‹çš„æé™æƒ…å†µ
///|
test "data_type_boundary_test" {
  // æµ‹è¯•Int32çš„ç²¾ç¡®è¾¹ç•Œæƒ…å†µ
  
  // æµ‹è¯•å¹³æ–¹æ ¹è¾¹ç•Œ: sqrt(2147483647) â‰ˆ 46340.95
  let sqrt_max = 46340
  let sqrt_max_plus1 = 46341
  let sqrt_max_squared = multiply(sqrt_max, sqrt_max)
  let sqrt_max_plus1_squared = multiply(sqrt_max_plus1, sqrt_max_plus1)
  
  assert_eq(2147395600, sqrt_max_squared)    // 46340Â² = 2147395600 (ä¸æº¢å‡º)
  assert_eq(2147483647, sqrt_max_plus1_squared)  // 46341Â² = 2147483647 (æ¥è¿‘æº¢å‡º)
  
  // æµ‹è¯•ç«‹æ–¹æ ¹è¾¹ç•Œ: cbrt(2147483647) â‰ˆ 1290.22
  let cbrt_max = 1290
  let cbrt_max_plus1 = 1291
  let cbrt_max_cubed = multiply(
    cbrt_max,
    multiply(cbrt_max, cbrt_max)
  )
  let cbrt_max_plus1_cubed = multiply(
    cbrt_max_plus1,
    multiply(cbrt_max_plus1, cbrt_max_plus1)
  )
  
  assert_eq(2146689000, cbrt_max_cubed)     // 1290Â³ = 2146689000 (ä¸æº¢å‡º)
  assert_eq(2147483647, cbrt_max_plus1_cubed)  // 1291Â³ = 2147483647 (æ¥è¿‘æº¢å‡º)
  
  // æµ‹è¯•é™¤æ³•ç›¸å…³çš„è¾¹ç•Œï¼ˆé€šè¿‡ä¹˜æ³•æ¨¡æ‹Ÿï¼‰
  // æµ‹è¯•æœ€å¤§å€¼/2çš„ç²¾ç¡®æ€§
  let max_div2_times2 = multiply(
    multiply(2147483647, 1),
    2
  )
  assert_eq(2147483647, max_div2_times2)  // åº”è¯¥æº¢å‡ºåˆ°æœ€å¤§å€¼
}

// æµ‹è¯•ç”¨ä¾‹ 10: å®é™…ç‰©ç†æ¨¡æ‹Ÿæµ‹è¯• - çœŸå®ä¸–ç•Œç‰©ç†è®¡ç®—
///|
test "physics_simulation_test" {
  // æ¨¡æ‹Ÿè‡ªç”±è½ä½“è¿åŠ¨: h = h0 - 0.5 * g * tÂ²
  // æˆ‘ä»¬é€šè¿‡ä¹˜ä»¥2æ¥é¿å…å°æ•°
  
  let initial_height = 100  // ç±³
  let gravity = 10          // m/sÂ² (ç®€åŒ–ä¸º10)
  let time = 4              // ç§’
  
  // h * 2 = h0 * 2 - g * tÂ²
  let height_times_2 = add(
    multiply(initial_height, 2),
    multiply(
      multiply(-1, gravity),
      multiply(time, time)
    )
  )
  
  // éªŒè¯: 100 * 2 - 10 * 16 = 200 - 160 = 40
  // æ‰€ä»¥å®é™…é«˜åº¦ = 40 / 2 = 20ç±³
  assert_eq(40, height_times_2)
  
  // æ¨¡æ‹Ÿæ–œæŠ›è¿åŠ¨: æ°´å¹³è·ç¦» = v0 * cos(Î¸) * t
  // å‡è®¾ cos(45Â°) â‰ˆ 0.707 â‰ˆ 707/1000
  
  let initial_velocity = 20  // m/s
  let angle_cos_numerator = 707
  let angle_cos_denominator = 1000
  let time_flight = 3        // ç§’
  
  // æ°´å¹³è·ç¦» * 1000 = v0 * cos(Î¸åˆ†å­) * t
  let distance_times_1000 = multiply(
    multiply(initial_velocity, angle_cos_numerator),
    time_flight
  )
  
  // éªŒè¯: 20 * 707 * 3 = 42420
  // å®é™…è·ç¦» = 42420 / 1000 = 42.42ç±³
  assert_eq(42420, distance_times_1000)
  
  // æ¨¡æ‹ŸåŠ¨èƒ½è®¡ç®—: KE = 0.5 * m * vÂ²
  // é€šè¿‡ä¹˜ä»¥2æ¥é¿å…å°æ•°
  
  let mass = 5      // kg
  let velocity = 10 // m/s
  
  // KE * 2 = m * vÂ²
  let kinetic_energy_times_2 = multiply(
    mass,
    multiply(velocity, velocity)
  )
  
  // éªŒè¯: 5 * 100 = 500
  // å®é™…åŠ¨èƒ½ = 500 / 2 = 250ç„¦è€³
  assert_eq(500, kinetic_energy_times_2)
}