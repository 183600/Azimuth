// å¢å¼ºçš„ Azimuth æµ‹è¯•ç”¨ä¾‹
// åŒ…å«10ä¸ªé«˜è´¨é‡çš„ MoonBit æ ‡å‡†æµ‹è¯•ç”¨ä¾‹

// å¯¼å…¥è¢«æµ‹è¯•çš„æ¨¡å—
use azimuth

// æµ‹è¯•åŠ æ³•å‡½æ•°çš„è¾¹ç•Œå€¼å’Œç‰¹æ®Šæƒ…å†µ
test add_boundary_conditions {
  // æµ‹è¯•å¤§æ•°ç›¸åŠ 
  azimuth.assert_eq(2000000, azimuth.add(1000000, 1000000))
  
  // æµ‹è¯•æ­£è´Ÿæ•°ç›¸åŠ 
  azimuth.assert_eq(0, azimuth.add(1000000, -1000000))
  azimuth.assert_eq(-500000, azimuth.add(-1000000, 500000))
  
  // æµ‹è¯•é›¶å€¼ç›¸åŠ 
  azimuth.assert_eq(123456, azimuth.add(0, 123456))
  azimuth.assert_eq(-123456, azimuth.add(0, -123456))
}

// æµ‹è¯•ä¹˜æ³•å‡½æ•°çš„æ•°å­¦æ€§è´¨
test multiply_mathematical_properties {
  // æµ‹è¯•ä¹˜æ³•äº¤æ¢å¾‹
  azimuth.assert_eq(azimuth.multiply(15, 25), azimuth.multiply(25, 15))
  azimuth.assert_eq(azimuth.multiply(-15, 25), azimuth.multiply(25, -15))
  
  // æµ‹è¯•ä¹˜æ³•ç»“åˆå¾‹
  azimuth.assert_eq(
    azimuth.multiply(azimuth.multiply(2, 3), 4),
    azimuth.multiply(2, azimuth.multiply(3, 4))
  )
  
  // æµ‹è¯•ä¸é›¶ç›¸ä¹˜
  azimuth.assert_eq(0, azimuth.multiply(123456, 0))
  azimuth.assert_eq(0, azimuth.multiply(-123456, 0))
}

// æµ‹è¯•é—®å€™å‡½æ•°çš„Unicodeå’Œç‰¹æ®Šå­—ç¬¦å¤„ç†
test greet_unicode_and_special_chars {
  // æµ‹è¯•å„ç§Unicodeå­—ç¬¦
  azimuth.assert_eq_string("Hello, ğŸŒŸ!", azimuth.greet("ğŸŒŸ"))
  azimuth.assert_eq_string("Hello, ğŸ‰!", azimuth.greet("ğŸ‰"))
  azimuth.assert_eq_string("Hello, ğŸ’»!", azimuth.greet("ğŸ’»"))
  
  // æµ‹è¯•ç‰¹æ®Šç©ºç™½å­—ç¬¦
  azimuth.assert_eq_string("Hello, \t\n!", azimuth.greet("\t\n"))
  azimuth.assert_eq_string("Hello,   !", azimuth.greet("   "))
  
  // æµ‹è¯•æ•°å­—å’Œç¬¦å·æ··åˆ
  azimuth.assert_eq_string("Hello, test123!", azimuth.greet("test123"))
  azimuth.assert_eq_string("Hello, @#$%!", azimuth.greet("@#$%"))
}

// æµ‹è¯•å‘ä¸Šå–æ•´é™¤æ³•çš„å¤æ‚ä¸šåŠ¡åœºæ™¯
test divide_with_ceil_complex_scenarios {
  // åœºæ™¯ï¼šè®¡ç®—é¡¹ç›®èµ„æºåˆ†é…
  let total_tasks = 123
  let team_members = 8
  let tasks_per_member = azimuth.divide_with_ceil(total_tasks, team_members)
  azimuth.assert_eq(16, tasks_per_member)  // ceil(123/8) = 16
  
  // éªŒè¯åˆ†é…åˆç†æ€§
  let total_allocated = azimuth.multiply(tasks_per_member, team_members)
  azimuth.assert_eq(128, total_allocated)
  
  // åœºæ™¯ï¼šè®¡ç®—å­˜å‚¨ç©ºé—´éœ€æ±‚
  let data_size = 987
  let block_size = 64
  let blocks_needed = azimuth.divide_with_ceil(data_size, block_size)
  azimuth.assert_eq(16, blocks_needed)  // ceil(987/64) = 16
}

// æµ‹è¯•å¤åˆè¿ç®—çš„å‡†ç¡®æ€§
test complex_arithmetic_operations {
  // æµ‹è¯•å¤åˆè¿ç®—ï¼š(a + b) * c / d
  let a = 12
  let b = 8
  let c = 3
  let d = 5
  
  let step1 = azimuth.add(a, b)  // 20
  let step2 = azimuth.multiply(step1, c)  // 60
  let result = azimuth.divide_with_ceil(step2, d)  // 12
  azimuth.assert_eq(12, result)
  
  // æµ‹è¯•å¦ä¸€ä¸ªå¤åˆè¿ç®—
  let x = 15
  let y = 4
  let z = 7
  
  let complex_result = azimuth.divide_with_ceil(
    azimuth.multiply(azimuth.add(x, y), z),
    azimuth.subtract(x, y)
  )
  azimuth.assert_eq(35, complex_result)  // ceil((15+4)*7/(15-4)) = ceil(133/11) = 13
}

// æµ‹è¯•é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ
test error_handling_and_edge_cases {
  // æµ‹è¯•é™¤é›¶çš„å„ç§æƒ…å†µ
  azimuth.assert_eq(0, azimuth.divide_with_ceil(0, 0))
  azimuth.assert_eq(0, azimuth.divide_with_ceil(100, 0))
  azimuth.assert_eq(0, azimuth.divide_with_ceil(-100, 0))
  
  // æµ‹è¯•æå€¼æƒ…å†µ
  azimuth.assert_eq(1, azimuth.divide_with_ceil(1, 1))
  azimuth.assert_eq(1, azimuth.divide_with_ceil(-1, -1))
  azimuth.assert_eq(-1, azimuth.divide_with_ceil(1, -1))
  
  // æµ‹è¯•å¤§æ•°è¿ç®—
  azimuth.assert_eq(1000000, azimuth.divide_with_ceil(999999, 1))
  azimuth.assert_eq(1, azimuth.divide_with_ceil(1000000, 1000000))
}

// æµ‹è¯•å®é™…ä¸šåŠ¡è®¡ç®—åœºæ™¯
test real_world_business_calculations {
  // åœºæ™¯ï¼šè®¡ç®—æ´»åŠ¨åº§ä½å®‰æ’
  let participants = 256
  let tables = 15
  let seats_per_table = azimuth.divide_with_ceil(participants, tables)
  azimuth.assert_eq(18, seats_per_table)  // ceil(256/15) = 18
  
  // éªŒè¯æ€»åº§ä½æ•°
  let total_seats = azimuth.multiply(seats_per_table, tables)
  azimuth.assert_eq(270, total_seats)
  
  // åœºæ™¯ï¼šè®¡ç®—è¿è¾“æˆæœ¬
  let packages = 87
  let truck_capacity = 12
  let trucks_needed = azimuth.divide_with_ceil(packages, truck_capacity)
  let cost_per_truck = 150
  let total_cost = azimuth.multiply(trucks_needed, cost_per_truck)
  
  azimuth.assert_eq(8, trucks_needed)  // ceil(87/12) = 8
  azimuth.assert_eq(1200, total_cost)  // 8 * 150
}

// æµ‹è¯•æ•°å­¦æ’ç­‰å¼å’Œæ€§è´¨
test mathematical_identities {
  // æµ‹è¯•åŠ æ³•æ’ç­‰å¼
  let test_value = 42
  azimuth.assert_eq(test_value, azimuth.add(test_value, 0))
  azimuth.assert_eq(test_value, azimuth.add(0, test_value))
  
  // æµ‹è¯•ä¹˜æ³•æ’ç­‰å¼
  azimuth.assert_eq(test_value, azimuth.multiply(test_value, 1))
  azimuth.assert_eq(test_value, azimuth.multiply(1, test_value))
  azimuth.assert_eq(0, azimuth.multiply(test_value, 0))
  
  // æµ‹è¯•åˆ†é…å¾‹
  let a = 6
  let b = 7
  let c = 8
  azimuth.assert_eq(
    azimuth.multiply(a, azimuth.add(b, c)),
    azimuth.add(azimuth.multiply(a, b), azimuth.multiply(a, c))
  )
}

// æµ‹è¯•å­—ç¬¦ä¸²å¤„ç†çš„å®‰å…¨æ€§
test string_processing_security {
  // æµ‹è¯•ç©ºå€¼å’Œç‰¹æ®Šå­—ç¬¦ä¸²
  azimuth.assert_eq_string("Hello, !", azimuth.greet(""))
  azimuth.assert_eq_string("Hello, null!", azimuth.greet("null"))
  azimuth.assert_eq_string("Hello, undefined!", azimuth.greet("undefined"))
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å­—ç¬¦ä¸²
  azimuth.assert_eq_string("Hello, <script>!", azimuth.greet("<script>"))
  azimuth.assert_eq_string("Hello, 'quote'!", azimuth.greet("'quote'"))
  azimuth.assert_eq_string("Hello, \"double quote\"!", azimuth.greet("\"double quote\""))
  
  // æµ‹è¯•é•¿å­—ç¬¦ä¸²
  let long_string = "This_is_a_very_long_string_that_tests_the_greeting_function_with_extended_input"
  let expected = "Hello, " + long_string + "!"
  azimuth.assert_eq_string(expected, azimuth.greet(long_string))
}

// æµ‹è¯•æ€§èƒ½å’Œæ•ˆç‡ç›¸å…³çš„è®¡ç®—
test performance_efficiency_calculations {
  // æµ‹è¯•æ‰¹é‡è®¡ç®—æ•ˆç‡
  let batch_size = 1000
  let operations_per_batch = 25
  
  // è®¡ç®—éœ€è¦çš„æ‰¹æ¬¡æ•°
  let total_items = 12345
  let batches_needed = azimuth.divide_with_ceil(total_items, batch_size)
  azimuth.assert_eq(13, batches_needed)  // ceil(12345/1000) = 13
  
  // è®¡ç®—æ€»æ“ä½œæ•°
  let total_operations = azimuth.multiply(batches_needed, operations_per_batch)
  azimuth.assert_eq(325, total_operations)  // 13 * 25
  
  // æµ‹è¯•èµ„æºåˆ©ç”¨ç‡
  let used_capacity = azimuth.multiply(batches_needed - 1, batch_size)
  let remaining_items = azimuth.subtract(total_items, used_capacity)
  azimuth.assert_eq(345, remaining_items)  // 12345 - 12*1000
}