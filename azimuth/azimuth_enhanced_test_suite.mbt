// Azimuth å¢å¼ºæµ‹è¯•å¥—ä»¶ - é«˜è´¨é‡ MoonBit æµ‹è¯•ç”¨ä¾‹
// åŒ…å« 10 ä¸ªç»¼åˆæµ‹è¯•ç”¨ä¾‹ï¼Œè¦†ç›–å„ç§åœºæ™¯å’Œè¾¹ç•Œæƒ…å†µ

// æµ‹è¯•åŸºæœ¬ç®—æœ¯è¿ç®—çš„ç»“åˆå¾‹
test "arithmetic_associative_laws" {
  // åŠ æ³•ç»“åˆå¾‹: (a + b) + c = a + (b + c)
  let a = 5
  let b = 8
  let c = 12
  
  let left_add = @azimuth.add(@azimuth.add(a, b), c)
  let right_add = @azimuth.add(a, @azimuth.add(b, c))
  @azimuth.assert_eq(left_add, right_add)
  
  // ä¹˜æ³•ç»“åˆå¾‹: (a * b) * c = a * (b * c)
  let left_mul = @azimuth.multiply(@azimuth.multiply(a, b), c)
  let right_mul = @azimuth.multiply(a, @azimuth.multiply(b, c))
  @azimuth.assert_eq(left_mul, right_mul)
}

// æµ‹è¯•é™¤é›¶å’Œè¾¹ç•Œæ¡ä»¶å¤„ç†
test "division_edge_cases" {
  // é™¤é›¶æƒ…å†µ
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(0, 0))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(10, 0))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(-10, 0))
  
  // æå°æ•°å€¼
  @azimuth.assert_eq(1, @azimuth.divide_with_ceil(1, 1))
  @azimuth.assert_eq(1, @azimuth.divide_with_ceil(-1, -1))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(0, 1))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(0, -1))
  
  // å¤§æ•°è¾¹ç•Œ
  @azimuth.assert_eq(1000000, @azimuth.divide_with_ceil(1000000, 1))
  @azimuth.assert_eq(1, @azimuth.divide_with_ceil(1000000, 1000000))
}

// æµ‹è¯•å¤æ‚ä¸šåŠ¡è®¡ç®—åœºæ™¯
test "complex_business_calculations" {
  // åœºæ™¯ï¼šç”µå•†è®¢å•å¤„ç†
  let order_items = 47
  let items_per_box = 8
  let boxes_per_pallet = 6
  
  // è®¡ç®—éœ€è¦çš„ç®±å­æ•°
  let boxes_needed = @azimuth.divide_with_ceil(order_items, items_per_box)
  
  // è®¡ç®—éœ€è¦çš„æ‰˜ç›˜æ•°
  let pallets_needed = @azimuth.divide_with_ceil(boxes_needed, boxes_per_pallet)
  
  // éªŒè¯ç»“æœ
  @azimuth.assert_eq(6, boxes_needed)  // ceil(47/8) = 6
  @azimuth.assert_eq(1, pallets_needed)  // ceil(6/6) = 1
  
  // è®¡ç®—æ€»å®¹é‡
  let total_box_capacity = @azimuth.multiply(boxes_needed, items_per_box)
  let total_pallet_capacity = @azimuth.multiply(pallets_needed, @azimuth.multiply(boxes_per_pallet, items_per_box))
  
  @azimuth.assert_eq(48, total_box_capacity)
  @azimuth.assert_eq(48, total_pallet_capacity)
}

// æµ‹è¯•å­—ç¬¦ä¸²å¤„ç†çš„å›½é™…åŒ–æ”¯æŒ
test "international_string_handling" {
  // æµ‹è¯•å„ç§è¯­è¨€å’Œå­—ç¬¦é›†
  @azimuth.assert_eq_string("Hello, ä¸­æ–‡!", @azimuth.greet("ä¸­æ–‡"))
  @azimuth.assert_eq_string("Hello, æ—¥æœ¬èª!", @azimuth.greet("æ—¥æœ¬èª"))
  @azimuth.assert_eq_string("Hello, í•œêµ­ì–´!", @azimuth.greet("í•œêµ­ì–´"))
  @azimuth.assert_eq_string("Hello, Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©!", @azimuth.greet("Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"))
  @azimuth.assert_eq_string("Hello, ×¢×‘×¨×™×ª!", @azimuth.greet("×¢×‘×¨×™×ª"))
  @azimuth.assert_eq_string("Hello, à¤¹à¤¿à¤¨à¥à¤¦à¥€!", @azimuth.greet("à¤¹à¤¿à¤¨à¥à¤¦à¥€"))
  
  // æµ‹è¯•è¡¨æƒ…ç¬¦å·å’Œç‰¹æ®Šå­—ç¬¦
  @azimuth.assert_eq_string("Hello, ğŸ‰ğŸš€ğŸŒŸ!", @azimuth.greet("ğŸ‰ğŸš€ğŸŒŸ"))
  @azimuth.assert_eq_string("Hello, ğŸ’¯ğŸ”¥!", @azimuth.greet("ğŸ’¯ğŸ”¥"))
}

// æµ‹è¯•æ•°å­¦è¿ç®—çš„ç²¾åº¦å’Œæ€§èƒ½
test "precision_and_performance" {
  // æµ‹è¯•è¿ç»­è¿ç®—çš„ç²¾åº¦ä¿æŒ
  let initial = 100
  
  // è¿ç»­åŠ æ³•
  let sum_result = @azimuth.add(@azimuth.add(@azimuth.add(initial, 25), 50), 75)
  @azimuth.assert_eq(250, sum_result)
  
  // è¿ç»­ä¹˜æ³•
  let mul_result = @azimuth.multiply(@azimuth.multiply(@azimuth.multiply(2, 3), 4), 5)
  @azimuth.assert_eq(120, mul_result)
  
  // æ··åˆè¿ç®—
  let complex_result = @azimuth.divide_with_ceil(
    @azimuth.multiply(@azimuth.add(10, 5), 3),
    @azimuth.add(2, 1)
  )
  @azimuth.assert_eq(45, complex_result)  // ceil((10+5)*3/3) = ceil(15) = 15
}

// æµ‹è¯•èµ„æºåˆ†é…ä¼˜åŒ–é—®é¢˜
test "resource_allocation_optimization" {
  // åœºæ™¯ï¼šæœåŠ¡å™¨èµ„æºåˆ†é…
  let total_cpu_cores = 64
  let total_memory_gb = 256
  let num_services = 7
  
  // è®¡ç®—æ¯ä¸ªæœåŠ¡å¹³å‡åˆ†é…çš„èµ„æº
  let cpu_per_service = @azimuth.divide_with_ceil(total_cpu_cores, num_services)
  let memory_per_service = @azimuth.divide_with_ceil(total_memory_gb, num_services)
  
  @azimuth.assert_eq(10, cpu_per_service)  // ceil(64/7) = 10
  @azimuth.assert_eq(37, memory_per_service)  // ceil(256/7) = 37
  
  // è®¡ç®—å®é™…åˆ†é…çš„æ€»èµ„æº
  let total_allocated_cpu = @azimuth.multiply(cpu_per_service, num_services)
  let total_allocated_memory = @azimuth.multiply(memory_per_service, num_services)
  
  @azimuth.assert_eq(70, total_allocated_cpu)
  @azimuth.assert_eq(259, total_allocated_memory)
  
  // è®¡ç®—èµ„æºæµªè´¹
  let cpu_waste = @azimuth.subtract(total_allocated_cpu, total_cpu_cores)
  let memory_waste = @azimuth.subtract(total_allocated_memory, total_memory_gb)
  
  @azimuth.assert_eq(6, cpu_waste)
  @azimuth.assert_eq(3, memory_waste)
}

// æµ‹è¯•é”™è¯¯æ¢å¤å’Œå¼‚å¸¸å¤„ç†
test "error_resilience_and_recovery" {
  // æµ‹è¯•å„ç§å¯èƒ½å¯¼è‡´é”™è¯¯çš„è¾“å…¥ç»„åˆ
  let test_values = [(0, 0), (1, 0), (-1, 0), (100, 0), (-100, 0)]
  
  // éªŒè¯æ‰€æœ‰é™¤é›¶æƒ…å†µéƒ½è¿”å›0
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(test_values[0].0, test_values[0].1))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(test_values[1].0, test_values[1].1))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(test_values[2].0, test_values[2].1))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(test_values[3].0, test_values[3].1))
  @azimuth.assert_eq(0, @azimuth.divide_with_ceil(test_values[4].0, test_values[4].1))
  
  // æµ‹è¯•æå€¼è¿ç®—çš„ç¨³å®šæ€§
  let max_safe_int = 1000000
  let min_safe_int = -1000000
  
  @azimuth.assert_eq(2000000, @azimuth.add(max_safe_int, max_safe_int))
  @azimuth.assert_eq(-2000000, @azimuth.add(min_safe_int, min_safe_int))
  @azimuth.assert_eq(0, @azimuth.add(max_safe_int, min_safe_int))
}

// æµ‹è¯•æ•°æ®ç»“æ„å’Œç®—æ³•æ¨¡æ‹Ÿ
test "data_structure_simulation" {
  // æ¨¡æ‹Ÿæ ˆæ“ä½œ
  let stack_size = 0
  
  // å‹æ ˆæ“ä½œ
  let stack_size_after_push1 = @azimuth.add(stack_size, 1)
  let stack_size_after_push2 = @azimuth.add(stack_size_after_push1, 1)
  let stack_size_after_push3 = @azimuth.add(stack_size_after_push2, 1)
  
  @azimuth.assert_eq(3, stack_size_after_push3)
  
  // å¼¹æ ˆæ“ä½œ
  let stack_size_after_pop1 = @azimuth.subtract(stack_size_after_push3, 1)
  let stack_size_after_pop2 = @azimuth.subtract(stack_size_after_pop1, 1)
  let stack_size_after_pop3 = @azimuth.subtract(stack_size_after_pop2, 1)
  
  @azimuth.assert_eq(0, stack_size_after_pop3)
  
  // æ¨¡æ‹Ÿé˜Ÿåˆ—æ“ä½œ
  let queue_capacity = 20
  let queue_items = 13
  let new_items = 8
  let total_queue_items = @azimuth.add(queue_items, new_items)
  
  // æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
  let needs_expansion = total_queue_items > queue_capacity
  let new_capacity = @azimuth.divide_with_ceil(total_queue_items, 10) * 10
  
  @azimuth.assert_eq(true, needs_expansion)
  @azimuth.assert_eq(30, new_capacity)
}

// æµ‹è¯•æ—¶é—´è®¡ç®—å’Œè°ƒåº¦ç®—æ³•
test "time_calculation_and_scheduling" {
  // åœºæ™¯ï¼šé¡¹ç›®æ—¶é—´è§„åˆ’
  let total_tasks = 87
  let team_members = 5
  let tasks_per_person_per_day = 3
  let work_days_per_week = 5
  
  // è®¡ç®—æ¯æ—¥æ€»å¤„ç†èƒ½åŠ›
  let daily_capacity = @azimuth.multiply(team_members, tasks_per_person_per_day)
  
  // è®¡ç®—éœ€è¦çš„å·¥ä½œæ—¥æ•°
  let work_days_needed = @azimuth.divide_with_ceil(total_tasks, daily_capacity)
  
  // è®¡ç®—éœ€è¦çš„å‘¨æ•°
  let weeks_needed = @azimuth.divide_with_ceil(work_days_needed, work_days_per_week)
  
  @azimuth.assert_eq(6, work_days_needed)  // ceil(87/(5*3)) = ceil(87/15) = 6
  @azimuth.assert_eq(2, weeks_needed)  // ceil(6/5) = 2
  
  // è®¡ç®—å®é™…å¤„ç†èƒ½åŠ›
  let actual_capacity = @azimuth.multiply(work_days_needed, daily_capacity)
  @azimuth.assert_eq(90, actual_capacity)
  
  // è®¡ç®—å‰©ä½™å¤„ç†èƒ½åŠ›
  let spare_capacity = @azimuth.subtract(actual_capacity, total_tasks)
  @azimuth.assert_eq(3, spare_capacity)
}

// æµ‹è¯•ç»¼åˆè®¡ç®—å’Œå†³ç­–é€»è¾‘
test "comprehensive_decision_logic" {
  // åœºæ™¯ï¼šåº“å­˜ç®¡ç†å’Œè¡¥è´§å†³ç­–
  let current_stock = 156
  let daily_demand = 23
  let lead_time_days = 7
  let safety_buffer = 50
  
  // è®¡ç®—å®‰å…¨åº“å­˜æ°´å¹³
  let safety_stock = @azimuth.add(@azimuth.multiply(daily_demand, lead_time_days), safety_buffer)
  
  // è®¡ç®—éœ€è¦è¡¥è´§çš„æ•°é‡
  let reorder_needed = current_stock < safety_stock
  let reorder_quantity = @azimuth.multiply(2, safety_stock)  // è®¢è´­2å€å®‰å…¨åº“å­˜
  
  // è®¡ç®—è¡¥è´§åçš„åº“å­˜
  let new_stock = @azimuth.add(current_stock, reorder_quantity)
  
  // è®¡ç®—è¡¥è´§å¯ä»¥æ”¯æŒçš„å¤©æ•°
  let days_supported = @azimuth.divide_with_ceil(new_stock, daily_demand)
  
  @azimuth.assert_eq(211, safety_stock)  // 23*7 + 50 = 211
  @azimuth.assert_eq(true, reorder_needed)  // 156 < 211
  @azimuth.assert_eq(422, reorder_quantity)  // 2 * 211
  @azimuth.assert_eq(578, new_stock)  // 156 + 422
  @azimuth.assert_eq(26, days_supported)  // ceil(578/23) = 26
}