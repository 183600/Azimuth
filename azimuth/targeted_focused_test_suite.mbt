// ç›®æ ‡ä¸“æ³¨æµ‹è¯•å¥—ä»¶ - é’ˆå¯¹ç‰¹å®šåŠŸèƒ½çš„æ·±å…¥æµ‹è¯•

test "è·¨æœåŠ¡ä¼ æ’­ä¸€è‡´æ€§æµ‹è¯•" {
  // æ¨¡æ‹Ÿå¾®æœåŠ¡é—´çš„è¿½è¸ªä¼ æ’­
  let trace_propagator = W3CTraceContextPropagator::new()
  let composite = CompositePropagator::new([trace_propagator])
  
  // æœåŠ¡Aåˆ›å»ºåˆå§‹span
  let tracer_a = TracerProvider::get_tracer(TracerProvider::default(), "service.a")
  let span_a = Tracer::start_span(tracer_a, "service.a.operation")
  let ctx_a = Context::root()
  
  // æ³¨å…¥åˆ°HTTPå¤´
  let carrier_a = TextMapCarrier::new()
  CompositePropagator::inject(composite, ctx_a, carrier_a)
  
  // æœåŠ¡Bæå–å¹¶åˆ›å»ºå­span
  let extracted_ctx_b = CompositePropagator::extract(composite, carrier_a)
  let tracer_b = TracerProvider::get_tracer(TracerProvider::default(), "service.b")
  let span_b = Tracer::start_span(tracer_b, "service.b.operation")
  
  // æœåŠ¡Cç»§ç»­ä¼ æ’­
  let carrier_b = TextMapCarrier::new()
  CompositePropagator::inject(composite, extracted_ctx_b, carrier_b)
  let extracted_ctx_c = CompositePropagator::extract(composite, carrier_b)
  let tracer_c = TracerProvider::get_tracer(TracerProvider::default(), "service.c")
  let span_c = Tracer::start_span(tracer_c, "service.c.operation")
  
  // éªŒè¯æ‰€æœ‰spanéƒ½æœ‰æ­£ç¡®çš„ä¸Šä¸‹æ–‡
  assert_eq(Span::name(span_a), "service.a.operation")
  assert_eq(Span::name(span_b), "service.b.operation")
  assert_eq(Span::name(span_c), "service.c.operation")
  
  Span::end(span_a)
  Span::end(span_b)
  Span::end(span_c)
  
  assert_true(true)
}

test "æ€§èƒ½åŸºå‡†æŒ‡æ ‡æµ‹è¯•" {
  let meter_provider = MeterProvider::default()
  let meter = MeterProvider::get_meter(meter_provider, "performance.meter")
  
  // åˆ›å»ºå„ç§æ€§èƒ½æŒ‡æ ‡
  let request_counter = Meter::create_counter(meter, "http.requests.total", Some("Total HTTP requests"), Some("requests"))
  let response_histogram = Meter::create_histogram(meter, "http.response.duration", Some("HTTP response duration"), Some("ms"))
  let active_connections = Meter::create_updown_counter(meter, "http.active_connections", Some("Active connections"), Some("connections"))
  let memory_usage = Meter::create_gauge(meter, "process.memory.usage", Some("Memory usage"), Some("bytes"))
  
  // æ¨¡æ‹Ÿæ€§èƒ½æ•°æ®è®°å½•
  for i = 0; i < 100; i = i + 1 {
    Counter::add(request_counter, 1.0)
    Histogram::record(response_histogram, (i + 50).to_double())
  }
  
  // æ¨¡æ‹Ÿè¿æ¥æ•°å˜åŒ–
  UpDownCounter::add(active_connections, 10.0)
  UpDownCounter::add(active_connections, -3.0)
  UpDownCounter::add(active_connections, 5.0)
  
  // æ¨¡æ‹Ÿå†…å­˜ä½¿ç”¨æƒ…å†µ
  for i = 0; i < 10; i = i + 1 {
    let memory_value = (1024 * 1024 * (i + 1)).to_double() // 1MB, 2MB, 3MB...
    // Gaugeæ²¡æœ‰ç›´æ¥çš„setæ–¹æ³•ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†
    assert_true(memory_value > 0.0)
  }
  
  assert_true(true)
}

test "å¹¶å‘å®‰å…¨æ“ä½œæµ‹è¯•" {
  // æ¨¡æ‹Ÿå¹¶å‘ç¯å¢ƒä¸‹çš„èµ„æºæ“ä½œ
  let shared_resource = Resource::new()
  let attributes = [
    ("concurrent.access", StringValue("test")),
    ("thread.id", IntValue(1)),
    ("operation.count", IntValue(0))
  ]
  
  let resource_with_attrs = Resource::with_attributes(shared_resource, attributes)
  
  // æ¨¡æ‹Ÿå¤šä¸ªå¹¶å‘æ“ä½œï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
  for i = 0; i < 10; i = i + 1 {
    // æ¨¡æ‹Ÿå¹¶å‘è¯»å–
    let attr = Resource::get_attribute(resource_with_attrs, "concurrent.access")
    match attr {
      Some(StringValue(value)) => assert_eq(value, "test")
      _ => assert_true(false)
    }
    
    // æ¨¡æ‹Ÿå¹¶å‘å†™å…¥ï¼ˆåœ¨å®é™…ç¯å¢ƒä¸­éœ€è¦é”æœºåˆ¶ï¼‰
    let new_attributes = [
      ("concurrent.access", StringValue("test")),
      ("thread.id", IntValue(i)),
      ("operation.count", IntValue(i + 1))
    ]
    let updated_resource = Resource::with_attributes(resource_with_attrs, new_attributes)
    
    // éªŒè¯æ•°æ®ä¸€è‡´æ€§
    let updated_attr = Resource::get_attribute(updated_resource, "thread.id")
    match updated_attr {
      Some(IntValue(value)) => assert_true(value >= 0 && value < 10)
      _ => assert_true(false)
    }
  }
  
  assert_true(true)
}

test "å†…å­˜ç®¡ç†è¾¹ç•Œæµ‹è¯•" {
  // æµ‹è¯•å¤§é‡æ•°æ®çš„å†…å­˜ç®¡ç†
  let attrs = Attributes::new()
  
  // åˆ›å»ºå¤§é‡å±æ€§
  for i = 0; i < 1000; i = i + 1 {
    let key = "large.attribute." + i.to_string()
    let value = StringValue("large.value." + i.to_string() + " with additional content to increase memory usage")
    Attributes::set(attrs, key, value)
  }
  
  // åˆ›å»ºå¤§å‹æ•°ç»„å±æ€§
  let large_string_array = ArrayStringValue([])
  for i = 0; i < 100; i = i + 1 {
    large_string_array.push("array.item." + i.to_string())
  }
  Attributes::set(attrs, "large.array", large_string_array)
  
  // åˆ›å»ºå¤§å‹æ•´æ•°æ•°ç»„
  let large_int_array = ArrayIntValue([])
  for i = 0; i < 100; i = i + 1 {
    large_int_array.push(i * 1000)
  }
  Attributes::set(attrs, "large.int.array", large_int_array)
  
  // éªŒè¯å¯ä»¥æ­£ç¡®æ£€ç´¢å¤§å‹æ•°æ®
  let retrieved_array = Attributes::get(attrs, "large.array")
  match retrieved_array {
    Some(ArrayStringValue(values)) => assert_eq(values.length(), 100)
    _ => assert_true(false)
  }
  
  let retrieved_int_array = Attributes::get(attrs, "large.int.array")
  match retrieved_int_array {
    Some(ArrayIntValue(values)) => assert_eq(values.length(), 100)
    _ => assert_true(false)
  }
  
  assert_true(true)
}

test "é…ç½®ç®¡ç†åŠ¨æ€æ›´æ–°æµ‹è¯•" {
  // æ¨¡æ‹Ÿé…ç½®ç®¡ç†ç³»ç»Ÿ
  let config_resource = Resource::new()
  
  // åˆå§‹é…ç½®
  let initial_config = [
    ("service.name", StringValue("azimuth-service")),
    ("service.version", StringValue("1.0.0")),
    ("log.level", StringValue("INFO")),
    ("metrics.enabled", BoolValue(true)),
    ("tracing.sample.rate", FloatValue(0.1))
  ]
  
  let configured_resource = Resource::with_attributes(config_resource, initial_config)
  
  // éªŒè¯åˆå§‹é…ç½®
  let service_name = Resource::get_attribute(configured_resource, "service.name")
  match service_name {
    Some(StringValue(value)) => assert_eq(value, "azimuth-service")
    _ => assert_true(false)
  }
  
  // åŠ¨æ€æ›´æ–°é…ç½®
  let updated_config = [
    ("service.name", StringValue("azimuth-service")),
    ("service.version", StringValue("1.1.0")), // ç‰ˆæœ¬æ›´æ–°
    ("log.level", StringValue("DEBUG")),       // æ—¥å¿—çº§åˆ«æ›´æ–°
    ("metrics.enabled", BoolValue(false)),     // åŠŸèƒ½å¼€å…³
    ("tracing.sample.rate", FloatValue(0.5)),  // é‡‡æ ·ç‡æ›´æ–°
    ("new.feature.enabled", BoolValue(true))   // æ–°å¢é…ç½®
  ]
  
  let updated_resource = Resource::with_attributes(configured_resource, updated_config)
  
  // éªŒè¯é…ç½®æ›´æ–°
  let new_version = Resource::get_attribute(updated_resource, "service.version")
  match new_version {
    Some(StringValue(value)) => assert_eq(value, "1.1.0")
    _ => assert_true(false)
  }
  
  let new_log_level = Resource::get_attribute(updated_resource, "log.level")
  match new_log_level {
    Some(StringValue(value)) => assert_eq(value, "DEBUG")
    _ => assert_true(false)
  }
  
  let new_feature = Resource::get_attribute(updated_resource, "new.feature.enabled")
  match new_feature {
    Some(BoolValue(value)) => assert_eq(value, true)
    _ => assert_true(false)
  }
  
  assert_true(true)
}

test "å›½é™…åŒ–æœ¬åœ°åŒ–æ”¯æŒæµ‹è¯•" {
  // æµ‹è¯•å›½é™…åŒ–æ”¯æŒ
  let i18n_resource = Resource::new()
  
  // å¤šè¯­è¨€é…ç½®
  let i18n_config = [
    ("service.name.en", StringValue("Azimuth Telemetry Service")),
    ("service.name.zh", StringValue("æ–¹ä½è§’é¥æµ‹æœåŠ¡")),
    ("service.name.ja", StringValue("ã‚¢ã‚¸ãƒ ã‚¹ãƒ»ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ»ã‚µãƒ¼ãƒ“ã‚¹")),
    ("error.message.en", StringValue("Operation failed")),
    ("error.message.zh", StringValue("æ“ä½œå¤±è´¥")),
    ("error.message.ja", StringValue("æ“ä½œãŒå¤±æ•—ã—ã¾ã—ãŸ")),
    ("timezone", StringValue("Asia/Shanghai")),
    ("locale", StringValue("zh-CN"))
  ]
  
  let localized_resource = Resource::with_attributes(i18n_resource, i18n_config)
  
  // éªŒè¯ä¸­æ–‡é…ç½®
  let chinese_name = Resource::get_attribute(localized_resource, "service.name.zh")
  match chinese_name {
    Some(StringValue(value)) => assert_eq(value, "æ–¹ä½è§’é¥æµ‹æœåŠ¡")
    _ => assert_true(false)
  }
  
  // éªŒè¯æ—¥æ–‡é…ç½®
  let japanese_error = Resource::get_attribute(localized_resource, "error.message.ja")
  match japanese_error {
    Some(StringValue(value)) => assert_eq(value, "æ“ä½œãŒå¤±æ•—ã—ã¾ã—ãŸ")
    _ => assert_true(false)
  }
  
  // éªŒè¯æœ¬åœ°åŒ–è®¾ç½®
  let locale = Resource::get_attribute(localized_resource, "locale")
  match locale {
    Some(StringValue(value)) => assert_eq(value, "zh-CN")
    _ => assert_true(false)
  }
  
  // æµ‹è¯•æœ¬åœ°åŒ–æ—¥å¿—è®°å½•
  let logger_provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(logger_provider, "i18n.logger")
  
  let localized_log = LogRecord::new_with_context(
    Error,
    Some("æ“ä½œå¤±è´¥"),
    Some(Attributes::new()),
    Some(Clock::now_unix_nanos()),
    None,
    None,
    None,
    Some(Context::with_value(Context::root(), ContextKey::new("locale"), "zh-CN"))
  )
  
  Logger::emit(logger, localized_log)
  
  assert_true(true)
}

test "é”™è¯¯æ¢å¤è¾¹ç•Œæµ‹è¯•" {
  // æµ‹è¯•å„ç§é”™è¯¯åœºæ™¯çš„æ¢å¤èƒ½åŠ›
  
  // 1. ç©ºå€¼æ¢å¤
  let empty_trace_ctx = SpanContext::new("", "", false, "")
  assert_false(SpanContext::is_valid(empty_trace_ctx))
  
  // åˆ›å»ºé»˜è®¤æ¢å¤ä¸Šä¸‹æ–‡
  let recovery_ctx = SpanContext::new("recovery-trace-id", "recovery-span-id", true, "")
  assert_true(SpanContext::is_valid(recovery_ctx))
  
  // 2. å±æ€§æ“ä½œé”™è¯¯æ¢å¤
  let attrs = Attributes::new()
  
  // å°è¯•è·å–ä¸å­˜åœ¨çš„å±æ€§
  let missing_attr = Attributes::get(attrs, "nonexistent.key")
  assert_true(missing_attr is None)
  
  // è®¾ç½®é»˜è®¤å€¼ä½œä¸ºæ¢å¤
  Attributes::set(attrs, "nonexistent.key", StringValue("default.value"))
  let recovered_attr = Attributes::get(attrs, "nonexistent.key")
  match recovered_attr {
    Some(StringValue(value)) => assert_eq(value, "default.value")
    _ => assert_true(false)
  }
  
  // 3. HTTPé”™è¯¯æ¢å¤
  let error_response = HttpResponse::new(500, [], Some("Internal Server Error"))
  assert_eq(HttpResponse::status_code(error_response), 500)
  
  // åˆ›å»ºé‡è¯•è¯·æ±‚
  let retry_request = HttpRequest::new("GET", "https://api.example.com/retry", [])
  let success_response = HttpResponse::new(200, [], Some("Success"))
  assert_eq(HttpResponse::status_code(success_response), 200)
  
  // 4. æ—¥å¿—è®°å½•é”™è¯¯æ¢å¤
  let logger_provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(logger_provider, "error.recovery.logger")
  
  // è®°å½•é”™è¯¯æ—¥å¿—
  let error_log = LogRecord::new_with_context(
    Error,
    Some("Error occurred but system recovered"),
    Some(Attributes::new()),
    Some(Clock::now_unix_nanos()),
    None,
    Some("recovery-trace-id"),
    Some("recovery-span-id"),
    Some(Context::root())
  )
  
  Logger::emit(logger, error_log)
  
  // è®°å½•æ¢å¤æ—¥å¿—
  let recovery_log = LogRecord::new_with_context(
    Info,
    Some("System successfully recovered from error"),
    Some(Attributes::new()),
    Some(Clock::now_unix_nanos()),
    None,
    Some("recovery-trace-id"),
    Some("recovery-span-id"),
    Some(Context::root())
  )
  
  Logger::emit(logger, recovery_log)
  
  assert_true(true)
}

test "æ•°æ®åºåˆ—åŒ–å®Œæ•´æ€§æµ‹è¯•" {
  // æµ‹è¯•æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å®Œæ•´æ€§
  
  // åˆ›å»ºå¤æ‚çš„æ•°æ®ç»“æ„
  let complex_attrs = Attributes::new()
  
  // å„ç§ç±»å‹çš„å±æ€§
  Attributes::set(complex_attrs, "string.value", StringValue("complex string with ç‰¹æ®Šå­—ç¬¦ and emoji ğŸš€"))
  Attributes::set(complex_attrs, "int.value", IntValue(-2147483648))
  Attributes::set(complex_attrs, "float.value", FloatValue(3.14159265359))
  Attributes::set(complex_attrs, "bool.value", BoolValue(true))
  
  let string_array = ArrayStringValue(["item1", "item2", "åŒ…å«ä¸­æ–‡", "special chars !@#$%"])
  Attributes::set(complex_attrs, "string.array", string_array)
  
  let int_array = ArrayIntValue([-1, 0, 1, 2147483647, -2147483648])
  Attributes::set(complex_attrs, "int.array", int_array)
  
  // åˆ›å»ºå¤æ‚çš„SpanContext
  let complex_span_ctx = SpanContext::new(
    "0af7651916cd43dd8448eb211c80319c",
    "b7ad6b7169203331",
    true,
    "rojo=00f067aa0ba902b7,congo=1f067aa0ba902b7"
  )
  
  // åˆ›å»ºå¤æ‚çš„LogRecord
  let complex_log = LogRecord::new_with_context(
    Fatal,
    Some("Complex log message with special chars: æµ‹è¯• ğŸš€"),
    Some(complex_attrs),
    Some(1735689600000000000L),
    Some(1735689600000000001L),
    Some(complex_span_ctx.trace_id),
    Some(complex_span_ctx.span_id),
    Some(Context::with_value(Context::root(), ContextKey::new("serialization.test"), "true"))
  )
  
  // éªŒè¯æ•°æ®å®Œæ•´æ€§
  assert_eq(LogRecord::severity_number(complex_log), Fatal)
  assert_eq(LogRecord::trace_id(complex_log), Some("0af7651916cd43dd8448eb211c80319c"))
  assert_eq(LogRecord::span_id(complex_log), Some("b7ad6b7169203331"))
  
  // éªŒè¯å¤æ‚å±æ€§
  match LogRecord::body(complex_log) {
    Some(body) => assert_eq(body, "Complex log message with special chars: æµ‹è¯• ğŸš€")
    None => assert_true(false)
  }
  
  // éªŒè¯æ•°ç»„å±æ€§
  let retrieved_string_array = Attributes::get(complex_attrs, "string.array")
  match retrieved_string_array {
    Some(ArrayStringValue(values)) => {
      assert_eq(values.length(), 4)
      assert_eq(values[2], "åŒ…å«ä¸­æ–‡")
      assert_eq(values[3], "special chars !@#$%")
    }
    _ => assert_true(false)
  }
  
  let retrieved_int_array = Attributes::get(complex_attrs, "int.array")
  match retrieved_int_array {
    Some(ArrayIntValue(values)) => {
      assert_eq(values.length(), 5)
      assert_eq(values[0], -1)
      assert_eq(values[3], 2147483647)
      assert_eq(values[4], -2147483648)
    }
    _ => assert_true(false)
  }
  
  assert_true(true)
}

test "å®æ—¶æ•°æ®æµå¤„ç†æµ‹è¯•" {
  // æ¨¡æ‹Ÿå®æ—¶æ•°æ®æµå¤„ç†
  
  let meter_provider = MeterProvider::default()
  let meter = MeterProvider::get_meter(meter_provider, "realtime.processor")
  
  // åˆ›å»ºå®æ—¶æŒ‡æ ‡
  let event_counter = Meter::create_counter(meter, "events.processed", Some("Events processed"), Some("events"))
  let latency_histogram = Meter::create_histogram(meter, "event.latency", Some("Event processing latency"), Some("ms"))
  let throughput_gauge = Meter::create_gauge(meter, "processing.throughput", Some("Processing throughput"), Some("events/sec"))
  
  let logger_provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(logger_provider, "realtime.logger")
  
  // æ¨¡æ‹Ÿå®æ—¶æ•°æ®æµ
  for batch = 0; batch < 10; batch = batch + 1 {
    // æ¯æ‰¹å¤„ç†100ä¸ªäº‹ä»¶
    for event = 0; event < 100; event = event + 1 {
      // è®°å½•äº‹ä»¶å¤„ç†
      Counter::add(event_counter, 1.0)
      
      // è®°å½•å»¶è¿Ÿï¼ˆæ¨¡æ‹Ÿ1-100msçš„å»¶è¿Ÿï¼‰
      let latency = (event % 100 + 1).to_double()
      Histogram::record(latency_histogram, latency)
      
      // æ¯10ä¸ªäº‹ä»¶è®°å½•ä¸€æ¬¡æ—¥å¿—
      if event % 10 == 0 {
        let event_log = LogRecord::new_with_context(
          Info,
          Some("Processed event " + event.to_string() + " in batch " + batch.to_string()),
          Some(Attributes::new()),
          Some(Clock::now_unix_nanos()),
          None,
          Some("batch-" + batch.to_string()),
          Some("event-" + event.to_string()),
          None
        )
        
        Logger::emit(logger, event_log)
      }
    }
    
    // æ‰¹æ¬¡å¤„ç†å®Œæˆæ—¥å¿—
    let batch_log = LogRecord::new_with_context(
      Info,
      Some("Completed batch " + batch.to_string() + " with 100 events"),
      Some(Attributes::new()),
      Some(Clock::now_unix_nanos()),
      None,
      Some("realtime-stream"),
      Some("batch-" + batch.to_string()),
      None
    )
    
    Logger::emit(logger, batch_log)
  }
  
  // éªŒè¯æ€»å¤„ç†äº‹ä»¶æ•°
  assert_true(true) // ç®€åŒ–å®ç°ä¸­æ— æ³•éªŒè¯å®é™…å€¼
  
  // è®°å½•æµå¤„ç†å®Œæˆ
  let completion_log = LogRecord::new_with_context(
    Info,
    Some("Realtime stream processing completed: 1000 events processed"),
    Some(Attributes::new()),
    Some(Clock::now_unix_nanos()),
    None,
    Some("realtime-stream"),
    Some("completion"),
    None
  )
  
  Logger::emit(logger, completion_log)
  
  assert_true(true)
}

test "å®‰å…¨æ€§å’Œæƒé™æ§åˆ¶æµ‹è¯•" {
  // æµ‹è¯•å®‰å…¨æ€§å’Œæƒé™æ§åˆ¶
  
  // åˆ›å»ºå®‰å…¨ä¸Šä¸‹æ–‡
  let security_context = Resource::new()
  
  // å®‰å…¨é…ç½®
  let security_config = [
    ("auth.enabled", BoolValue(true)),
    ("auth.method", StringValue("oauth2")),
    ("auth.token.expiry", IntValue(3600)),
    ("encryption.enabled", BoolValue(true)),
    ("encryption.algorithm", StringValue("AES-256-GCM")),
    ("access.control.level", StringValue("restricted")),
    ("audit.logging.enabled", BoolValue(true)),
    ("data.masking.enabled", BoolValue(true))
  ]
  
  let secured_resource = Resource::with_attributes(security_context, security_config)
  
  // éªŒè¯å®‰å…¨é…ç½®
  let auth_enabled = Resource::get_attribute(secured_resource, "auth.enabled")
  match auth_enabled {
    Some(BoolValue(value)) => assert_eq(value, true)
    _ => assert_true(false)
  }
  
  let encryption_algo = Resource::get_attribute(secured_resource, "encryption.algorithm")
  match encryption_algo {
    Some(StringValue(value)) => assert_eq(value, "AES-256-GCM")
    _ => assert_true(false)
  }
  
  // æ¨¡æ‹Ÿç”¨æˆ·æƒé™éªŒè¯
  let user_permissions = [
    ("user.id", StringValue("user123")),
    ("user.role", StringValue("admin")),
    ("user.permissions", ArrayStringValue(["read", "write", "delete"])),
    ("access.token", StringValue("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9")),
    ("session.expiry", IntValue(1735689600))
  ]
  
  let user_resource = Resource::with_attributes(Resource::new(), user_permissions)
  
  // éªŒè¯ç”¨æˆ·æƒé™
  let user_role = Resource::get_attribute(user_resource, "user.role")
  match user_role {
    Some(StringValue(value)) => assert_eq(value, "admin")
    _ => assert_true(false)
  }
  
  let user_permissions_array = Resource::get_attribute(user_resource, "user.permissions")
  match user_permissions_array {
    Some(ArrayStringValue(permissions)) => {
      assert_eq(permissions.length(), 3)
      assert_true(permissions.contains("read"))
      assert_true(permissions.contains("write"))
      assert_true(permissions.contains("delete"))
    }
    _ => assert_true(false)
  }
  
  // åˆ›å»ºå®‰å…¨å®¡è®¡æ—¥å¿—
  let logger_provider = LoggerProvider::default()
  let audit_logger = LoggerProvider::get_logger(logger_provider, "security.audit")
  
  let audit_log = LogRecord::new_with_context(
    Info,
    Some("User authentication successful"),
    Some(user_resource),
    Some(Clock::now_unix_nanos()),
    None,
    Some("auth-session-123"),
    Some("security-event"),
    Some(Context::with_value(Context::root(), ContextKey::new("security.level"), "high"))
  )
  
  Logger::emit(audit_logger, audit_log)
  
  // æ¨¡æ‹Ÿæ•æ„Ÿæ•°æ®è„±æ•
  let sensitive_attrs = Attributes::new()
  Attributes::set(sensitive_attrs, "user.email", StringValue("user***@example.com"))
  Attributes::set(sensitive_attrs, "user.phone", StringValue("***-****-1234"))
  Attributes::set(sensitive_attrs, "credit.card", StringValue("****-****-****-1234"))
  
  let masked_log = LogRecord::new_with_context(
    Info,
    Some("Sensitive data access logged with masking"),
    Some(sensitive_attrs),
    Some(Clock::now_unix_nanos()),
    None,
    Some("data-access-123"),
    Some("masked-event"),
    None
  )
  
  Logger::emit(audit_logger, masked_log)
  
  assert_true(true)
}