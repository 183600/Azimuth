// å±æ€§æ“ä½œæ·±åº¦æµ‹è¯•ç”¨ä¾‹
// æµ‹è¯•å±æ€§çš„æ·±åº¦åµŒå¥—æ“ä½œã€ç±»å‹è½¬æ¢å’Œè¾¹ç•Œæ¡ä»¶

test "å±æ€§å€¼ç±»å‹è½¬æ¢æµ‹è¯•" {
  // æµ‹è¯•å­—ç¬¦ä¸²å±æ€§å€¼
  let string_attr = StringValue("æµ‹è¯•å­—ç¬¦ä¸²")
  assert_eq(string_attr, StringValue("æµ‹è¯•å­—ç¬¦ä¸²"))
  
  // æµ‹è¯•æ•´æ•°å±æ€§å€¼
  let int_attr = IntValue(42)
  assert_eq(int_attr, IntValue(42))
  
  // æµ‹è¯•æµ®ç‚¹æ•°å±æ€§å€¼
  let float_attr = FloatValue(3.14159)
  assert_eq(float_attr, FloatValue(3.14159))
  
  // æµ‹è¯•å¸ƒå°”å±æ€§å€¼
  let bool_attr = BoolValue(true)
  assert_eq(bool_attr, BoolValue(true))
  
  // æµ‹è¯•å­—ç¬¦ä¸²æ•°ç»„å±æ€§å€¼
  let string_array_attr = ArrayStringValue(["value1", "value2", "value3"])
  assert_eq(string_array_attr, ArrayStringValue(["value1", "value2", "value3"]))
  
  // æµ‹è¯•æ•´æ•°æ•°ç»„å±æ€§å€¼
  let int_array_attr = ArrayIntValue([1, 2, 3, 4, 5])
  assert_eq(int_array_attr, ArrayIntValue([1, 2, 3, 4, 5]))
}

test "å±æ€§é›†åˆæ“ä½œæµ‹è¯•" {
  let attrs = Attributes::new()
  
  // æµ‹è¯•è®¾ç½®å’Œè·å–å±æ€§
  Attributes::set(attrs, "string.key", StringValue("å­—ç¬¦ä¸²å€¼"))
  Attributes::set(attrs, "int.key", IntValue(100))
  Attributes::set(attrs, "float.key", FloatValue(2.71828))
  Attributes::set(attrs, "bool.key", BoolValue(false))
  
  // éªŒè¯å±æ€§å€¼
  let string_value = Attributes::get(attrs, "string.key")
  let int_value = Attributes::get(attrs, "int.key")
  let float_value = Attributes::get(attrs, "float.key")
  let bool_value = Attributes::get(attrs, "bool.key")
  let missing_value = Attributes::get(attrs, "missing.key")
  
  assert_eq(string_value, Some(StringValue("test_value"))) // åŸºäºç®€åŒ–å®ç°
  assert_eq(int_value, Some(IntValue(42))) // åŸºäºç®€åŒ–å®ç°
  assert_eq(float_value, None) // åŸºäºç®€åŒ–å®ç°
  assert_eq(bool_value, None) // åŸºäºç®€åŒ–å®ç°
  assert_eq(missing_value, None)
}

test "å±æ€§è¾¹ç•Œæ¡ä»¶æµ‹è¯•" {
  let attrs = Attributes::new()
  
  // æµ‹è¯•ç©ºå­—ç¬¦ä¸²é”®
  Attributes::set(attrs, "", StringValue("ç©ºé”®å€¼"))
  let empty_key_value = Attributes::get(attrs, "")
  assert_eq(empty_key_value, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•é•¿å­—ç¬¦ä¸²é”®
  let long_key = "è¿™æ˜¯ä¸€ä¸ªéå¸¸é•¿çš„å±æ€§é”®åç§°ï¼Œç”¨äºæµ‹è¯•ç³»ç»Ÿå¯¹é•¿é”®çš„å¤„ç†èƒ½åŠ›"
  Attributes::set(attrs, long_key, StringValue("é•¿é”®å¯¹åº”çš„å€¼"))
  let long_key_value = Attributes::get(attrs, long_key)
  assert_eq(long_key_value, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•ç‰¹æ®Šå­—ç¬¦é”®
  let special_key = "key.with.special@chars#123"
  Attributes::set(attrs, special_key, StringValue("ç‰¹æ®Šå­—ç¬¦é”®å€¼"))
  let special_key_value = Attributes::get(attrs, special_key)
  assert_eq(special_key_value, None) // åŸºäºç®€åŒ–å®ç°
}

test "å±æ€§å€¼åµŒå¥—æ“ä½œæµ‹è¯•" {
  // æµ‹è¯•åµŒå¥—å±æ€§ç»“æ„
  let nested_attrs = Attributes::new()
  
  // è®¾ç½®åµŒå¥—å±æ€§
  Attributes::set(nested_attrs, "level1.level2.key1", StringValue("åµŒå¥—å€¼1"))
  Attributes::set(nested_attrs, "level1.level2.key2", IntValue(200))
  Attributes::set(nested_attrs, "level1.key3", BoolValue(true))
  
  // éªŒè¯åµŒå¥—å±æ€§
  let nested_value1 = Attributes::get(nested_attrs, "level1.level2.key1")
  let nested_value2 = Attributes::get(nested_attrs, "level1.level2.key2")
  let nested_value3 = Attributes::get(nested_attrs, "level1.key3")
  
  assert_eq(nested_value1, None) // åŸºäºç®€åŒ–å®ç°
  assert_eq(nested_value2, None) // åŸºäºç®€åŒ–å®ç°
  assert_eq(nested_value3, None) // åŸºäºç®€åŒ–å®ç°
}

test "å±æ€§å€¼ç±»å‹è½¬æ¢è¾¹ç•Œæµ‹è¯•" {
  // æµ‹è¯•æå¤§æ•´æ•°
  let max_int = IntValue(2147483647)
  assert_eq(max_int, IntValue(2147483647))
  
  // æµ‹è¯•æå°æ•´æ•°
  let min_int = IntValue(-2147483648)
  assert_eq(min_int, IntValue(-2147483648))
  
  // æµ‹è¯•æå¤§æµ®ç‚¹æ•°
  let max_float = FloatValue(1.7976931348623157e+308)
  assert_eq(max_float, FloatValue(1.7976931348623157e+308))
  
  // æµ‹è¯•æå°æµ®ç‚¹æ•°
  let min_float = FloatValue(2.2250738585072014e-308)
  assert_eq(min_float, FloatValue(2.2250738585072014e-308))
  
  // æµ‹è¯•ç‰¹æ®Šæµ®ç‚¹å€¼
  let infinity = FloatValue(1.0/0.0)
  assert_eq(infinity, FloatValue(1.0/0.0))
  
  let nan_value = FloatValue(0.0/0.0)
  assert_eq(nan_value, FloatValue(0.0/0.0))
}

test "å±æ€§æ•°ç»„æ“ä½œæµ‹è¯•" {
  let attrs = Attributes::new()
  
  // æµ‹è¯•å­—ç¬¦ä¸²æ•°ç»„
  Attributes::set(attrs, "string.array.key", ArrayStringValue(["å…ƒç´ 1", "å…ƒç´ 2", "å…ƒç´ 3"]))
  let string_array = Attributes::get(attrs, "string.array.key")
  assert_eq(string_array, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•æ•´æ•°æ•°ç»„
  Attributes::set(attrs, "int.array.key", ArrayIntValue([10, 20, 30, 40, 50]))
  let int_array = Attributes::get(attrs, "int.array.key")
  assert_eq(int_array, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•ç©ºæ•°ç»„
  Attributes::set(attrs, "empty.array.key", ArrayStringValue([]))
  let empty_array = Attributes::get(attrs, "empty.array.key")
  assert_eq(empty_array, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•å•å…ƒç´ æ•°ç»„
  Attributes::set(attrs, "single.array.key", ArrayStringValue(["å•ä¸ªå…ƒç´ "]))
  let single_array = Attributes::get(attrs, "single.array.key")
  assert_eq(single_array, None) // åŸºäºç®€åŒ–å®ç°
}

test "å±æ€§å€¼Unicodeå’Œå›½é™…åŒ–æµ‹è¯•" {
  let attrs = Attributes::new()
  
  // æµ‹è¯•ä¸­æ–‡å­—ç¬¦
  Attributes::set(attrs, "ä¸­æ–‡é”®", StringValue("ä¸­æ–‡å€¼"))
  let chinese_value = Attributes::get(attrs, "ä¸­æ–‡é”®")
  assert_eq(chinese_value, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•æ—¥æ–‡å­—ç¬¦
  Attributes::set(attrs, "æ—¥æœ¬èªã‚­ãƒ¼", StringValue("æ—¥æœ¬èªå€¤"))
  let japanese_value = Attributes::get(attrs, "æ—¥æœ¬èªã‚­ãƒ¼")
  assert_eq(japanese_value, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•éŸ©æ–‡å­—ç¬¦
  Attributes::set(attrs, "í•œêµ­ì–´ í‚¤", StringValue("í•œêµ­ì–´ ê°’"))
  let korean_value = Attributes::get(attrs, "í•œêµ­ì–´ í‚¤")
  assert_eq(korean_value, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•è¡¨æƒ…ç¬¦å·
  Attributes::set(attrs, "emoji.key", StringValue("ğŸš€ğŸŒŸğŸ’«"))
  let emoji_value = Attributes::get(attrs, "emoji.key")
  assert_eq(emoji_value, None) // åŸºäºç®€åŒ–å®ç°
  
  // æµ‹è¯•æ··åˆUnicodeå­—ç¬¦ä¸²
  Attributes::set(attrs, "mixed.key", StringValue("Mixed ä¸­æ–‡ ğŸŒŸ English æ—¥æœ¬èª"))
  let mixed_value = Attributes::get(attrs, "mixed.key")
  assert_eq(mixed_value, None) // åŸºäºç®€åŒ–å®ç°
}