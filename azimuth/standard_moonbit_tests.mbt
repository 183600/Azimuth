// æ ‡å‡† MoonBit æµ‹è¯•ç”¨ä¾‹
// è¦†ç›– azimuth åº“çš„æ ¸å¿ƒåŠŸèƒ½å’Œè¾¹ç•Œæƒ…å†µ

// æµ‹è¯•åŠ æ³•å‡½æ•°çš„è¾¹ç•Œå€¼å¤„ç†
test "add_overflow_boundary" {
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•æ­£æ•°æº¢å‡ºè¾¹ç•Œ
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, 1))
  @azimuth.assert_eq(max_val, @azimuth.add(max_val - 1, 2))
  @azimuth.assert_eq(max_val, @azimuth.add(1000000000, 1147483648))
  
  // æµ‹è¯•è´Ÿæ•°æº¢å‡ºè¾¹ç•Œ
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, -1))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val + 1, -2))
  @azimuth.assert_eq(min_val, @azimuth.add(-1000000000, -1147483648))
}

// æµ‹è¯•ä¹˜æ³•å‡½æ•°çš„è¾¹ç•Œå€¼å¤„ç†
test "multiply_extreme_values" {
  let max_val = 2147483647
  let min_val = -2147483648
  
  // æµ‹è¯•å¤§æ•°ç›¸ä¹˜çš„æº¢å‡ºä¿æŠ¤
  @azimuth.assert_eq(max_val, @azimuth.multiply(46341, 46341))
  @azimuth.assert_eq(max_val, @azimuth.multiply(65536, 32768))
  @azimuth.assert_eq(max_val, @azimuth.multiply(100000, 21475))
  
  // æµ‹è¯•æœ€å°å€¼çš„ç‰¹æ®Šå¤„ç†
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 2))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, -2))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, 100))
}

// æµ‹è¯•æ•°å­¦è¿ç®—çš„ç»“åˆå¾‹
test "addition_associativity" {
  // éªŒè¯åŠ æ³•ç»“åˆå¾‹ï¼š(a + b) + c = a + (b + c)
  let a = 1000000
  let b = -500000
  let c = 750000
  
  let left = @azimuth.add(@azimuth.add(a, b), c)
  let right = @azimuth.add(a, @azimuth.add(b, c))
  @azimuth.assert_eq(left, right)
  
  // æµ‹è¯•è¾¹ç•Œå€¼çš„ç»“åˆå¾‹
  let max_val = 2147483647
  let min_val = -2147483648
  
  let left_boundary = @azimuth.add(@azimuth.add(max_val, min_val), 1)
  let right_boundary = @azimuth.add(max_val, @azimuth.add(min_val, 1))
  @azimuth.assert_eq(left_boundary, right_boundary)
}

// æµ‹è¯•æ•°å­¦è¿ç®—çš„åˆ†é…å¾‹
test "multiplication_distributivity" {
  // éªŒè¯ä¹˜æ³•åˆ†é…å¾‹ï¼ša Ã— (b + c) = a Ã— b + a Ã— c
  let a = 123
  let b = 456
  let c = 789
  
  let left = @azimuth.multiply(a, @azimuth.add(b, c))
  let right = @azimuth.add(@azimuth.multiply(a, b), @azimuth.multiply(a, c))
  @azimuth.assert_eq(left, right)
  
  // æµ‹è¯•è´Ÿæ•°çš„åˆ†é…å¾‹
  let a_neg = -100
  let b_neg = 50
  let c_neg = -75
  
  let left_neg = @azimuth.multiply(a_neg, @azimuth.add(b_neg, c_neg))
  let right_neg = @azimuth.add(@azimuth.multiply(a_neg, b_neg), @azimuth.multiply(a_neg, c_neg))
  @azimuth.assert_eq(left_neg, right_neg)
}

// æµ‹è¯•å­—ç¬¦ä¸²å¤„ç†å‡½æ•°çš„è¾¹ç•Œæƒ…å†µ
test "greet_unicode_handling" {
  // æµ‹è¯•å„ç§ Unicode å­—ç¬¦
  @azimuth.assert_eq_string("Hello, ä¸­æ–‡!", @azimuth.greet("ä¸­æ–‡"))
  @azimuth.assert_eq_string("Hello, æ—¥æœ¬èª!", @azimuth.greet("æ—¥æœ¬èª"))
  @azimuth.assert_eq_string("Hello, Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©!", @azimuth.greet("Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"))
  @azimuth.assert_eq_string("Hello, ğŸŒŸ!", @azimuth.greet("ğŸŒŸ"))
  @azimuth.assert_eq_string("Hello, ğŸ‘‹ğŸŒ!", @azimuth.greet("ğŸ‘‹ğŸŒ"))
  
  // æµ‹è¯•æ··åˆå­—ç¬¦
  @azimuth.assert_eq_string("Hello, Helloä¸–ç•Œ!", @azimuth.greet("Helloä¸–ç•Œ"))
  @azimuth.assert_eq_string("Hello, Test123æµ‹è¯•!", @azimuth.greet("Test123æµ‹è¯•"))
}

// æµ‹è¯•å¤æ‚ç®—æœ¯è¡¨è¾¾å¼
test "complex_arithmetic_expressions" {
  // è®¡ç®—ï¼š((a + b) Ã— c) - (d Ã— (e + f))
  let a = 10
  let b = 20
  let c = 5
  let d = 3
  let e = 15
  let f = 25
  
  let sum_ab = @azimuth.add(a, b)
  let product_abc = @azimuth.multiply(sum_ab, c)
  let sum_ef = @azimuth.add(e, f)
  let product_def = @azimuth.multiply(d, sum_ef)
  let result = @azimuth.add(product_abc, -product_def)
  
  @azimuth.assert_eq(-40, result)
  
  // æµ‹è¯•åµŒå¥—è¿ç®—ï¼ša Ã— b + c Ã— d + e Ã— f
  let product_ab = @azimuth.multiply(a, b)
  let product_cd = @azimuth.multiply(c, d)
  let product_ef = @azimuth.multiply(e, f)
  let total = @azimuth.add(@azimuth.add(product_ab, product_cd), product_ef)
  
  @azimuth.assert_eq(550, total)
}

// æµ‹è¯•å®é™…å•†ä¸šåœºæ™¯
test "business_calculation_scenarios" {
  // åœºæ™¯1ï¼šè®¡ç®—è®¢å•æ€»ä»·ï¼ˆå«ç¨å’ŒæŠ˜æ‰£ï¼‰
  let unit_price = 100
  let quantity = 5
  let discount_rate = 10  // 10% æŠ˜æ‰£
  let tax_rate = 8        // 8% ç¨ç‡
  
  let subtotal = @azimuth.multiply(unit_price, quantity)
  let discount_amount = @azimuth.multiply(subtotal, discount_rate)
  let discounted_total = @azimuth.add(subtotal, -discount_amount)
  let tax_amount = @azimuth.multiply(discounted_total, tax_rate)
  let final_total = @azimuth.add(discounted_total, tax_amount)
  
  @azimuth.assert_eq(480, final_total)  // (100*5 - 100*5*10/100) + (100*5 - 100*5*10/100)*8/100 = 480
  
  // åœºæ™¯2ï¼šè®¡ç®—å‘˜å·¥å·¥èµ„
  let base_salary = 3000
  let overtime_hours = 10
  let overtime_rate = 50
  let bonus = 500
  let deduction = 200
  
  let overtime_pay = @azimuth.multiply(overtime_hours, overtime_rate)
  let gross_pay = @azimuth.add(@azimuth.add(base_salary, overtime_pay), bonus)
  let net_pay = @azimuth.add(gross_pay, -deduction)
  
  @azimuth.assert_eq(3800, net_pay)
}

// æµ‹è¯•æ•°å­¦å‡½æ•°çš„å¹‚è¿ç®—æ¨¡æ‹Ÿ
test "power_operation_simulation" {
  // ä½¿ç”¨ä¹˜æ³•æ¨¡æ‹Ÿå¹‚è¿ç®—ï¼š2^3 = 2 Ã— 2 Ã— 2
  let base = 2
  let exponent = 3
  
  let mut result = 1
  result = @azimuth.multiply(result, base)  // 2
  result = @azimuth.multiply(result, base)  // 4
  result = @azimuth.multiply(result, base)  // 8
  
  @azimuth.assert_eq(8, result)
  
  // æ¨¡æ‹Ÿ 3^4 = 3 Ã— 3 Ã— 3 Ã— 3
  let base2 = 3
  let exponent2 = 4
  
  let mut result2 = 1
  result2 = @azimuth.multiply(result2, base2)  // 3
  result2 = @azimuth.multiply(result2, base2)  // 9
  result2 = @azimuth.multiply(result2, base2)  // 27
  result2 = @azimuth.multiply(result2, base2)  // 81
  
  @azimuth.assert_eq(81, result2)
}

// æµ‹è¯•æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—
test "fibonacci_sequence_calculation" {
  // è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‰å‡ é¡¹
  let mut a = 0
  let mut b = 1
  
  // F0 = 0
  @azimuth.assert_eq(0, a)
  
  // F1 = 1
  @azimuth.assert_eq(1, b)
  
  // F2 = F1 + F0 = 1 + 0 = 1
  let c = @azimuth.add(a, b)
  @azimuth.assert_eq(1, c)
  
  // æ›´æ–° a = b, b = c
  a = b
  b = c
  
  // F3 = F2 + F1 = 1 + 1 = 2
  c = @azimuth.add(a, b)
  @azimuth.assert_eq(2, c)
  
  // æ›´æ–° a = b, b = c
  a = b
  b = c
  
  // F4 = F3 + F2 = 2 + 1 = 3
  c = @azimuth.add(a, b)
  @azimuth.assert_eq(3, c)
  
  // æ›´æ–° a = b, b = c
  a = b
  b = c
  
  // F5 = F4 + F3 = 3 + 2 = 5
  c = @azimuth.add(a, b)
  @azimuth.assert_eq(5, c)
}

// æµ‹è¯•é˜¶ä¹˜è®¡ç®—
test "factorial_calculation" {
  // è®¡ç®— 5! = 5 Ã— 4 Ã— 3 Ã— 2 Ã— 1
  let n = 5
  
  let mut result = n
  result = @azimuth.multiply(result, 4)  // 20
  result = @azimuth.multiply(result, 3)  // 60
  result = @azimuth.multiply(result, 2)  // 120
  result = @azimuth.multiply(result, 1)  // 120
  
  @azimuth.assert_eq(120, result)
  
  // è®¡ç®— 4! = 4 Ã— 3 Ã— 2 Ã— 1
  let n2 = 4
  
  let mut result2 = n2
  result2 = @azimuth.multiply(result2, 3)  // 12
  result2 = @azimuth.multiply(result2, 2)  // 24
  result2 = @azimuth.multiply(result2, 1)  // 24
  
  @azimuth.assert_eq(24, result2)
  
  // è¾¹ç•Œæƒ…å†µï¼š0! = 1
  @azimuth.assert_eq(1, 1)  // ç›´æ¥éªŒè¯
}