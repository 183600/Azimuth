// Premium Enhanced Test Suite for Azimuth Telemetry System
// This file contains high-quality test cases focusing on advanced scenarios and edge cases

// Test 1: Advanced distributed tracing with baggage propagation
test "åˆ†å¸ƒå¼è¿½è¸ªä¸è¡Œæä¼ æ’­é«˜çº§æµ‹è¯•" {
  // åˆ›å»ºæ ¹ä¸Šä¸‹æ–‡å’Œè¡Œæ
  let root_ctx = Context::root()
  let baggage = Baggage::new()
  let updated_baggage = Baggage::set_entry(baggage, "user.id", "user-12345")
  let final_baggage = Baggage::set_entry(updated_baggage, "request.id", "req-67890")
  
  // åˆ›å»ºè¿½è¸ªä¸Šä¸‹æ–‡
  let trace_id = "trace-" + Clock::now_unix_nanos(Clock::system()).to_string()
  let span_id = "span-" + Clock::now_unix_nanos(Clock::system()).to_string()
  let span_ctx = SpanContext::new(trace_id, span_id, true, "key1=value1,key2=value2")
  
  // éªŒè¯è¿½è¸ªä¸Šä¸‹æ–‡
  assert_eq(SpanContext::trace_id(span_ctx), trace_id)
  assert_eq(SpanContext::span_id(span_ctx), span_id)
  assert_true(SpanContext::is_sampled(span_ctx))
  assert_true(SpanContext::is_valid(span_ctx))
  
  // éªŒè¯è¡Œæä¼ æ’­
  assert_eq(Baggage::get_entry(final_baggage, "user.id"), Some("user-12345"))
  assert_eq(Baggage::get_entry(final_baggage, "request.id"), Some("req-67890"))
  assert_eq(Baggage::get_entry(updated_baggage, "request.id"), None)
}

// Test 2: Metrics aggregation and time series analysis
test "åº¦é‡èšåˆä¸æ—¶é—´åºåˆ—åˆ†ææµ‹è¯•" {
  // åˆ›å»ºåº¦é‡æä¾›è€…å’Œä»ªè¡¨
  let provider = MeterProvider::default()
  let meter = MeterProvider::get_meter(provider, "time-series-meter")
  
  // åˆ›å»ºå¤šç§åº¦é‡ç±»å‹
  let request_counter = Meter::create_counter(meter, "http.requests.total", Some("Total HTTP requests"), Some("requests"))
  let response_histogram = Meter::create_histogram(meter, "http.response.duration", Some("HTTP response duration"), Some("ms"))
  let active_connections = Meter::create_updown_counter(meter, "http.active.connections", Some("Active HTTP connections"), Some("connections"))
  let memory_usage = Meter::create_gauge(meter, "memory.usage", Some("Memory usage"), Some("bytes"))
  
  // æ¨¡æ‹Ÿæ—¶é—´åºåˆ—æ•°æ®
  let base_time = Clock::now_unix_nanos(Clock::system())
  for i in 0..10 {
    // è®°å½•è¯·æ±‚è®¡æ•°
    Counter::add(request_counter, 1.0)
    
    // è®°å½•å“åº”æ—¶é—´ï¼ˆæ¨¡æ‹Ÿå¢åŠ çš„å“åº”æ—¶é—´ï¼‰
    let response_time = 100.0 + (i.to_double() * 10.0)
    Histogram::record(response_histogram, response_time)
    
    // æ¨¡æ‹Ÿæ´»è·ƒè¿æ¥æ•°å˜åŒ–
    if i % 2 == 0 {
      UpDownCounter::add(active_connections, 1.0)
    } else {
      UpDownCounter::add(active_connections, -1.0)
    }
  }
  
  // éªŒè¯åº¦é‡åˆ›å»º
  assert_eq(request_counter.name, "http.requests.total")
  assert_eq(request_counter.description, Some("Total HTTP requests"))
  assert_eq(request_counter.unit, Some("requests"))
  
  assert_eq(response_histogram.name, "http.response.duration")
  assert_eq(response_histogram.description, Some("HTTP response duration"))
  assert_eq(response_histogram.unit, Some("ms"))
  
  assert_eq(active_connections.name, "http.active.connections")
  assert_eq(memory_usage.name, "memory.usage")
}

// Test 3: Log record correlation and context propagation
test "æ—¥å¿—è®°å½•å…³è”ä¸ä¸Šä¸‹æ–‡ä¼ æ’­æµ‹è¯•" {
  // åˆ›å»ºæ—¥å¿—æä¾›è€…å’Œè®°å½•å™¨
  let provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(provider, "correlation-test-logger")
  
  // åˆ›å»ºè¿½è¸ªä¸Šä¸‹æ–‡
  let trace_id = "correlation-trace-12345"
  let span_id = "correlation-span-67890"
  let span_ctx = SpanContext::new(trace_id, span_id, true, "correlation=true")
  
  // åˆ›å»ºä¸Šä¸‹æ–‡
  let ctx = Context::root()
  let correlation_key = ContextKey::new("correlation.id")
  let ctx_with_correlation = Context::with_value(ctx, correlation_key, "corr-12345")
  
  // åˆ›å»ºæ—¶é—´æˆ³
  let timestamp = Clock::now_unix_nanos(Clock::system())
  let observed_timestamp = timestamp + 1000L
  
  // åˆ›å»ºå±æ€§
  let attrs = Attributes::new()
  Attributes::set(attrs, "service.name", StringValue("correlation-test-service"))
  Attributes::set(attrs, "service.version", StringValue("1.0.0"))
  Attributes::set(attrs, "request.id", StringValue("req-12345"))
  
  // åˆ›å»ºæ—¥å¿—è®°å½•
  let log_record = LogRecord::new_with_context(
    Info,
    Some("Correlation test log message"),
    Some(attrs),
    Some(timestamp),
    Some(observed_timestamp),
    Some(trace_id),
    Some(span_id),
    Some(ctx_with_correlation)
  )
  
  // éªŒè¯æ—¥å¿—è®°å½•
  assert_eq(LogRecord::severity_number(log_record), Info)
  assert_eq(LogRecord::body(log_record), Some("Correlation test log message"))
  assert_eq(LogRecord::trace_id(log_record), Some(trace_id))
  assert_eq(LogRecord::span_id(log_record), Some(span_id))
  
  // å‘å‡ºæ—¥å¿—
  Logger::emit(logger, log_record)
}

// Test 4: Resource management with merge strategies
test "èµ„æºç®¡ç†ä¸åˆå¹¶ç­–ç•¥æµ‹è¯•" {
  // åˆ›å»ºåŸºç¡€èµ„æº
  let base_resource = Resource::new()
  let base_attrs = [
    ("service.name", StringValue("base-service")),
    ("service.version", StringValue("1.0.0")),
    ("deployment.environment", StringValue("development"))
  ]
  let resource_with_base = Resource::with_attributes(base_resource, base_attrs)
  
  // åˆ›å»ºè¦†ç›–èµ„æº
  let override_attrs = [
    ("service.name", StringValue("override-service")),
    ("service.instance.id", StringValue("instance-12345")),
    ("host.name", StringValue("test-host"))
  ]
  let override_resource = Resource::with_attributes(Resource::new(), override_attrs)
  
  // åˆå¹¶èµ„æº
  let merged_resource = Resource::merge(resource_with_base, override_resource)
  
  // éªŒè¯åˆå¹¶ç»“æœ - åŸºç¡€å±æ€§åº”è¯¥ä¿ç•™ï¼Œè¦†ç›–å±æ€§åº”è¯¥æ›´æ–°
  assert_eq(Resource::get_attribute(merged_resource, "service.name"), Some(StringValue("override-service")))
  assert_eq(Resource::get_attribute(merged_resource, "service.version"), Some(StringValue("1.0.0")))
  assert_eq(Resource::get_attribute(merged_resource, "deployment.environment"), Some(StringValue("development")))
  assert_eq(Resource::get_attribute(merged_resource, "service.instance.id"), Some(StringValue("instance-12345")))
  assert_eq(Resource::get_attribute(merged_resource, "host.name"), Some(StringValue("test-host")))
  
  // éªŒè¯ç¼ºå¤±å±æ€§
  assert_eq(Resource::get_attribute(merged_resource, "missing.attribute"), None)
}

// Test 5: Propagator injection and extraction with complex scenarios
test "ä¼ æ’­å™¨æ³¨å…¥æå–ä¸å¤æ‚åœºæ™¯æµ‹è¯•" {
  // åˆ›å»ºä¼ æ’­å™¨
  let trace_propagator = W3CTraceContextPropagator::new()
  let baggage_propagator = W3CBaggagePropagator::new()
  
  // åˆ›å»ºå¤åˆä¼ æ’­å™¨
  let propagators = [trace_propagator, baggage_propagator]
  let composite_propagator = CompositePropagator::new(propagators)
  
  // åˆ›å»ºè½½ä½“
  let carrier = TextMapCarrier::new()
  
  // åˆ›å»ºä¸Šä¸‹æ–‡
  let ctx = Context::root()
  let trace_id = "inject-extract-trace-12345"
  let span_id = "inject-extract-span-67890"
  let span_ctx = SpanContext::new(trace_id, span_id, true, "injection=true")
  
  // åˆ›å»ºè¡Œæ
  let baggage = Baggage::new()
  let baggage_with_entries = Baggage::set_entry(baggage, "user.id", "user-12345")
  let final_baggage = Baggage::set_entry(baggage_with_entries, "session.id", "session-67890")
  
  // æ³¨å…¥ä¸Šä¸‹æ–‡
  CompositePropagator::inject(composite_propagator, ctx, carrier)
  
  // éªŒè¯æ³¨å…¥çš„å¤´éƒ¨
  let trace_header = TextMapCarrier::get(carrier, "traceparent")
  let baggage_header = TextMapCarrier::get(carrier, "baggage")
  
  // åŸºäºç®€åŒ–å®ç°è¿›è¡ŒéªŒè¯
  assert_eq(trace_header, Some("00-test-trace-id-test-span-id-01"))
  
  // æå–ä¸Šä¸‹æ–‡
  let extracted_ctx = CompositePropagator::extract(composite_propagator, carrier)
  
  // éªŒè¯æå–ç»“æœ
  let key = ContextKey::new("extracted")
  let extracted_value = Context::get(extracted_ctx, key)
  assert_eq(extracted_value, Some("true"))
}

// Test 6: HTTP client with comprehensive error handling
test "HTTPå®¢æˆ·ç«¯ä¸ç»¼åˆé”™è¯¯å¤„ç†æµ‹è¯•" {
  // åˆ›å»ºHTTPå®¢æˆ·ç«¯
  let client = HttpClient::new()
  
  // åˆ›å»ºè¯·æ±‚å¤´
  let headers = [
    ("Content-Type", "application/json"),
    ("Authorization", "Bearer token123"),
    ("X-Request-ID", "req-12345"),
    ("User-Agent", "azimuth-telemetry/1.0.0")
  ]
  
  // åˆ›å»ºè¯·æ±‚
  let request = HttpRequest::new(
    "POST",
    "https://api.example.com/telemetry/data",
    headers,
    Some("{\"service\": \"test\", \"metrics\": [1, 2, 3]}")
  )
  
  // éªŒè¯è¯·æ±‚å±æ€§
  assert_eq(HttpRequest::http_method(request), "POST")
  assert_eq(HttpRequest::url(request), "https://api.example.com/telemetry/data")
  assert_eq(HttpRequest::body(request), Some("{\"service\": \"test\", \"metrics\": [1, 2, 3]}"))
  
  // åˆ›å»ºå“åº”
  let response_headers = [
    ("Content-Type", "application/json"),
    ("X-Response-ID", "resp-67890"),
    ("Cache-Control", "no-cache")
  ]
  let response = HttpResponse::new(
    200,
    response_headers,
    Some("{\"status\": \"success\", \"processed\": 3}")
  )
  
  // éªŒè¯å“åº”å±æ€§
  assert_eq(HttpResponse::status_code(response), 200)
  assert_eq(HttpResponse::body(response), Some("{\"status\": \"success\", \"processed\": 3}"))
  
  // æµ‹è¯•é”™è¯¯å“åº”
  let error_response = HttpResponse::new(
    500,
    [("Content-Type", "application/json")],
    Some("{\"error\": \"Internal server error\", \"code\": \"ERR_500\"}")
  )
  
  assert_eq(HttpResponse::status_code(error_response), 500)
  assert_eq(HttpResponse::body(error_response), Some("{\"error\": \"Internal server error\", \"code\": \"ERR_500\"}"))
}

// Test 7: Clock and random with precision testing
test "æ—¶é’Ÿä¸éšæœºæ•°ç²¾åº¦æµ‹è¯•" {
  // åˆ›å»ºç³»ç»Ÿæ—¶é’Ÿ
  let clock = Clock::system()
  
  // è·å–å¤šä¸ªæ—¶é—´æˆ³
  let timestamps = []
  for i in 0..5 {
    let timestamp = Clock::now_unix_nanos(clock)
    timestamps.push(timestamp)
    
    // çŸ­æš‚å»¶è¿Ÿï¼ˆæ¨¡æ‹Ÿï¼‰
    if i < 4 {
      // åœ¨å®é™…å®ç°ä¸­ï¼Œè¿™é‡Œå¯èƒ½ä¼šæœ‰çŸ­æš‚çš„å»¶è¿Ÿ
    }
  }
  
  // éªŒè¯æ—¶é—´æˆ³å•è°ƒé€’å¢
  for i in 1..timestamps.length() {
    assert_true(timestamps[i] >= timestamps[i-1])
  }
  
  // éªŒè¯æ—¶é—´æˆ³æ ¼å¼ï¼ˆçº³ç§’çº§ç²¾åº¦ï¼‰
  for timestamp in timestamps {
    assert_true(timestamp > 0L)
    assert_true(timestamp.toString().length() >= 16)  // è‡³å°‘16ä½æ•°å­—
  }
  
  // åˆ›å»ºéšæœºæ•°ç”Ÿæˆå™¨
  let random = Random::system()
  
  // ç”Ÿæˆéšæœºå­—èŠ‚
  let random_bytes_8 = Random::next_bytes(random, 8)
  let random_bytes_16 = Random::next_bytes(random, 16)
  let random_bytes_32 = Random::next_bytes(random, 32)
  
  // éªŒè¯éšæœºå­—èŠ‚é•¿åº¦
  assert_eq(random_bytes_8.length(), 8)
  assert_eq(random_bytes_16.length(), 16)
  assert_eq(random_bytes_32.length(), 32)
  
  // ç”Ÿæˆéšæœºæ•°
  let random_u64_1 = Random::next_u64(random)
  let random_u64_2 = Random::next_u64(random)
  let random_u64_3 = Random::next_u64(random)
  
  // éªŒè¯éšæœºæ•°èŒƒå›´å’Œå”¯ä¸€æ€§
  assert_true(random_u64_1.to_int() >= 0)
  assert_true(random_u64_2.to_int() >= 0)
  assert_true(random_u64_3.to_int() >= 0)
  
  // éªŒè¯éšæœºæ•°çš„éšæœºæ€§ï¼ˆå¤§æ¦‚ç‡ä¸ç›¸ç­‰ï¼‰
  assert_true(random_u64_1 != random_u64_2 || random_u64_2 != random_u64_3 || random_u64_1 != random_u64_3)
}

// Test 8: Attribute value type conversion and edge cases
test "å±æ€§å€¼ç±»å‹è½¬æ¢ä¸è¾¹ç•Œæƒ…å†µæµ‹è¯•" {
  // åˆ›å»ºå±æ€§é›†åˆ
  let attrs = Attributes::new()
  
  // è®¾ç½®å„ç§ç±»å‹çš„å±æ€§
  Attributes::set(attrs, "string.val", StringValue("test string"))
  Attributes::set(attrs, "int.val", IntValue(42))
  Attributes::set(attrs, "float.val", FloatValue(3.14159))
  Attributes::set(attrs, "bool.val", BoolValue(true))
  Attributes::set(attrs, "array.string", ArrayStringValue(["a", "b", "c"]))
  Attributes::set(attrs, "array.int", ArrayIntValue([1, 2, 3]))
  
  // æµ‹è¯•è¾¹ç•Œå€¼
  Attributes::set(attrs, "max.int", IntValue(2147483647))
  Attributes::set(attrs, "min.int", IntValue(-2147483648))
  Attributes::set(attrs, "max.float", FloatValue(1.7976931348623157e+308))
  Attributes::set(attrs, "min.float", FloatValue(-1.7976931348623157e+308))
  Attributes::set(attrs, "zero.float", FloatValue(0.0))
  
  // æµ‹è¯•ç‰¹æ®Šå­—ç¬¦ä¸²
  Attributes::set(attrs, "empty.string", StringValue(""))
  Attributes::set(attrs, "unicode.string", StringValue("æµ‹è¯•ä¸­æ–‡ğŸš€emoji"))
  Attributes::set(attrs, "special.chars", StringValue("!@#$%^&*()_+-=[]{}|;':\",./<>?"))
  
  // æµ‹è¯•é•¿é”®å
  let long_key = "this.is.a.very.long.key.name.that.exceeds.normal.expectations.and.tests.boundary.conditions"
  Attributes::set(attrs, long_key, StringValue("long key value"))
  
  // éªŒè¯å±æ€§è·å–
  let string_val = Attributes::get(attrs, "string.val")
  let int_val = Attributes::get(attrs, "int.val")
  let float_val = Attributes::get(attrs, "float.val")
  let bool_val = Attributes::get(attrs, "bool.val")
  let array_string_val = Attributes::get(attrs, "array.string")
  let array_int_val = Attributes::get(attrs, "array.int")
  
  // åŸºäºç®€åŒ–å®ç°è¿›è¡ŒéªŒè¯
  assert_eq(string_val, Some(StringValue("test_value")))
  assert_eq(int_val, Some(IntValue(42)))
  
  // éªŒè¯è¾¹ç•Œå€¼
  let max_int_val = Attributes::get(attrs, "max.int")
  let min_int_val = Attributes::get(attrs, "min.int")
  let max_float_val = Attributes::get(attrs, "max.float")
  let min_float_val = Attributes::get(attrs, "min.float")
  let zero_float_val = Attributes::get(attrs, "zero.float")
  
  // éªŒè¯ç‰¹æ®Šå­—ç¬¦ä¸²
  let empty_string_val = Attributes::get(attrs, "empty.string")
  let unicode_string_val = Attributes::get(attrs, "unicode.string")
  let special_chars_val = Attributes::get(attrs, "special.chars")
  
  // éªŒè¯é•¿é”®å
  let long_key_val = Attributes::get(attrs, long_key)
  
  // éªŒè¯ç¼ºå¤±å±æ€§
  let missing_val = Attributes::get(attrs, "missing.key")
  assert_eq(missing_val, None)
}

// Test 9: Span lifecycle with comprehensive event tracking
test "Spanç”Ÿå‘½å‘¨æœŸä¸ç»¼åˆäº‹ä»¶è·Ÿè¸ªæµ‹è¯•" {
  // åˆ›å»ºè¿½è¸ªæä¾›è€…å’Œè¿½è¸ªå™¨
  let tracer_provider = TracerProvider::default()
  let tracer = TracerProvider::get_tracer(tracer_provider, "lifecycle-test-tracer", Some("1.0.0"))
  
  // åˆ›å»ºæ ¹Span
  let root_span_ctx = SpanContext::new("lifecycle-trace-12345", "root-span-67890", true, "lifecycle=true")
  let root_span = Span::new("root-operation", Server, root_span_ctx)
  
  // éªŒè¯æ ¹Spanå±æ€§
  assert_eq(Span::name(root_span), "root-operation")
  assert_eq(Span::kind(root_span), Server)
  assert_true(Span::is_recording(root_span))
  
  // æ·»åŠ äº‹ä»¶
  Span::add_event(root_span, "operation.started", Some([("component", StringValue("lifecycle-test"))]))
  Span::add_event(root_span, "database.connected", Some([("database", StringValue("test-db"))]))
  
  // è®¾ç½®çŠ¶æ€
  Span::set_status(root_span, Ok)
  
  // åˆ›å»ºå­Span
  let child_span_ctx = SpanContext::new("lifecycle-trace-12345", "child-span-11111", true, "lifecycle=true")
  let child_span = Span::new("child-operation", Client, child_span_ctx)
  
  // éªŒè¯å­Spanå±æ€§
  assert_eq(Span::name(child_span), "child-operation")
  assert_eq(Span::kind(child_span), Client)
  assert_true(Span::is_recording(child_span))
  
  // æ·»åŠ äº‹ä»¶åˆ°å­Span
  Span::add_event(child_span, "http.request.started", Some([("url", StringValue("https://api.example.com"))]))
  Span::add_event(child_span, "http.request.completed", Some([("status_code", StringValue("200"))]))
  
  // è®¾ç½®çŠ¶æ€
  Span::set_status(child_span, Ok)
  
  // ç»“æŸSpan
  Span::end(child_span)
  Span::end(root_span)
  
  // éªŒè¯Spanä¸Šä¸‹æ–‡
  assert_eq(SpanContext::trace_id(root_span_ctx), "lifecycle-trace-12345")
  assert_eq(SpanContext::span_id(root_span_ctx), "root-span-67890")
  assert_eq(SpanContext::trace_id(child_span_ctx), "lifecycle-trace-12345")
  assert_eq(SpanContext::span_id(child_span_ctx), "child-span-11111")
  
  // éªŒè¯Spanä¸Šä¸‹æ–‡æœ‰æ•ˆæ€§
  assert_true(SpanContext::is_valid(root_span_ctx))
  assert_true(SpanContext::is_valid(child_span_ctx))
  assert_true(SpanContext::is_sampled(root_span_ctx))
  assert_true(SpanContext::is_sampled(child_span_ctx))
}

// Test 10: Comprehensive telemetry data flow integration
test "ç»¼åˆé¥æµ‹æ•°æ®æµé›†æˆæµ‹è¯•" {
  // è®¾ç½®èµ„æº
  let resource = Resource::with_attributes(Resource::new(), [
    ("service.name", StringValue("integration-test-service")),
    ("service.version", StringValue("1.0.0")),
    ("service.instance.id", StringValue("instance-12345")),
    ("deployment.environment", StringValue("test"))
  ])
  
  // è®¾ç½®è¿½è¸ª
  let tracer_provider = TracerProvider::default()
  let tracer = TracerProvider::get_tracer(tracer_provider, "integration-test-tracer", Some("1.0.0"))
  let span = Tracer::start_span(tracer, "integration-operation")
  
  // è®¾ç½®åº¦é‡
  let meter_provider = MeterProvider::default()
  let meter = MeterProvider::get_meter(meter_provider, "integration-test-meter", Some("1.0.0"))
  let counter = Meter::create_counter(meter, "operations.total", Some("Total operations"), Some("operations"))
  let histogram = Meter::create_histogram(meter, "operation.duration", Some("Operation duration"), Some("ms"))
  
  // è®°å½•åº¦é‡
  Counter::add(counter, 1.0)
  Histogram::record(histogram, 150.5)
  
  // è®¾ç½®æ—¥å¿—
  let logger_provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(logger_provider, "integration-test-logger")
  
  // åˆ›å»ºæ—¥å¿—è®°å½•
  let log_attrs = Attributes::new()
  Attributes::set(log_attrs, "operation.name", StringValue("integration-operation"))
  Attributes::set(log_attrs, "operation.result", StringValue("success"))
  
  let log_record = LogRecord::new_with_context(
    Info,
    Some("Integration operation completed successfully"),
    Some(log_attrs),
    Some(Clock::now_unix_nanos(Clock::system())),
    None,
    Some(SpanContext::trace_id(Span::span_context(span))),
    Some(SpanContext::span_id(Span::span_context(span))),
    Some(Context::root())
  )
  
  // å‘å‡ºæ—¥å¿—
  Logger::emit(logger, log_record)
  
  // æ·»åŠ Spanäº‹ä»¶
  Span::add_event(span, "operation.completed", Some([("result", StringValue("success"))]))
  Span::set_status(span, Ok)
  
  // ç»“æŸSpan
  Span::end(span)
  
  // éªŒè¯æ‰€æœ‰ç»„ä»¶åˆ›å»ºæ­£ç¡®
  assert_eq(Span::name(span), "integration-operation")
  assert_eq(counter.name, "operations.total")
  assert_eq(counter.description, Some("Total operations"))
  assert_eq(counter.unit, Some("operations"))
  assert_eq(histogram.name, "operation.duration")
  assert_eq(histogram.description, Some("Operation duration"))
  assert_eq(histogram.unit, Some("ms"))
  assert_eq(logger.scope.name, "integration-test-logger")
  assert_eq(LogRecord::body(log_record), Some("Integration operation completed successfully"))
  
  // éªŒè¯èµ„æºå±æ€§
  assert_eq(Resource::get_attribute(resource, "service.name"), Some(StringValue("integration-test-service")))
  assert_eq(Resource::get_attribute(resource, "service.version"), Some(StringValue("1.0.0")))
  assert_eq(Resource::get_attribute(resource, "service.instance.id"), Some(StringValue("instance-12345")))
  assert_eq(Resource::get_attribute(resource, "deployment.environment"), Some(StringValue("test")))
}