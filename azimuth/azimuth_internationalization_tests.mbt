// Internationalization Tests for Azimuth Telemetry System
// ä¸“æ³¨äºå›½é™…åŒ–å’Œæœ¬åœ°åŒ–çš„æµ‹è¯•

test "å¤šè¯­è¨€æ–‡æœ¬å¤„ç†æµ‹è¯•" {
  // æµ‹è¯•å¤šè¯­è¨€æ–‡æœ¬å¤„ç†
  let i18n_attrs = Attributes::new()
  
  // è®¾ç½®ä¸åŒè¯­è¨€çš„æ–‡æœ¬
  let languages = [
    ("zh", "ä¸­æ–‡æµ‹è¯•æ–‡æœ¬"),
    ("en", "English test text"),
    ("ja", "æ—¥æœ¬èªãƒ†ã‚¹ãƒˆãƒ†ã‚­ã‚¹ãƒˆ"),
    ("ko", "í•œêµ­ì–´ í…ŒìŠ¤íŠ¸ í…ìŠ¤íŠ¸"),
    ("es", "Texto de prueba en espaÃ±ol"),
    ("fr", "Texte de test en franÃ§ais"),
    ("de", "Deutscher Testtext"),
    ("ru", "Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ‚ĞµĞºÑÑ‚ Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼"),
    ("ar", "Ù†Øµ Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"),
    ("hi", "à¤¹à¤¿à¤‚à¤¦à¥€ à¤ªà¤°à¥€à¤•à¥à¤·à¤£ à¤ªà¤¾à¤ ")
  ]
  
  // è®¾ç½®å¤šè¯­è¨€å±æ€§
  for lang_text in languages {
    let key = "text." + lang_text[0]
    Attributes::set(i18n_attrs, key, StringValue(lang_text[1]))
  }
  
  // éªŒè¯å¤šè¯­è¨€å±æ€§è®¾ç½®
  for lang_text in languages {
    let key = "text." + lang_text[0]
    let value = Attributes::get(i18n_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•æ–‡æœ¬é•¿åº¦å’Œç¼–ç 
  for lang_text in languages {
    let text = lang_text[1]
    let length = text.length()
    
    // éªŒè¯æ–‡æœ¬é•¿åº¦
    assert_true(length > 0)
    
    // æµ‹è¯•å­—ç¬¦ç¼–ç å¤„ç†
    let encoded_text = text + "-encoded"
    assert_true(encoded_text.length() > length)
  }
  
  // æµ‹è¯•æ··åˆè¯­è¨€æ–‡æœ¬
  let mixed_texts = [
    "Hello ä¸–ç•Œ",
    "Bonjour ä¸–ç•Œ",
    "Hola ä¸–ç•Œ",
    "ã“ã‚“ã«ã¡ã¯ World",
    "ì•ˆë…•í•˜ì„¸ìš” World",
    "Ù…Ø±Ø­Ø¨Ø§ World",
    "à¤¨à¤®à¤¸à¥à¤¤à¥‡ World"
  ]
  
  for mixed_text in mixed_texts {
    Attributes::set(i18n_attrs, "mixed.text", StringValue(mixed_text))
    let value = Attributes::get(i18n_attrs, "mixed.text")
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
}

test "Unicodeå’Œç‰¹æ®Šå­—ç¬¦æµ‹è¯•" {
  // æµ‹è¯•Unicodeå’Œç‰¹æ®Šå­—ç¬¦å¤„ç†
  let unicode_attrs = Attributes::new()
  
  // è®¾ç½®å„ç§Unicodeå­—ç¬¦
  let unicode_chars = [
    "ğŸš€ğŸ“ŠğŸ“ˆğŸ“‰",  // Emoji
    "Î±Î²Î³Î´ÎµÎ¶Î·Î¸",  // å¸Œè…Šå­—æ¯
    "Ğ°Ğ±Ğ²Ğ³Ğ´ĞµĞ¶Ğ·",  // è¥¿é‡Œå°”å­—æ¯
    "Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©",  // é˜¿æ‹‰ä¼¯æ•°å­—
    "â‘ â‘¡â‘¢â‘£â‘¤â‘¥â‘¦â‘§â‘¨â‘©",  // å¸¦åœˆæ•°å­—
    "â†â†‘â†’â†“â†–â†—â†˜â†™",  // ç®­å¤´ç¬¦å·
    "â™ â™¥â™¦â™£",  // èŠ±è‰²ç¬¦å·
    "Â©Â®â„¢â‚¬Â£Â¥Â§Â¶",  // ç‰¹æ®Šç¬¦å·
    """''""''",  // å¼•å·å˜ä½“
    "â€“â€”â€¦â€¹â€ºÂ«Â»"  // æ ‡ç‚¹ç¬¦å·å˜ä½“
  ]
  
  // è®¾ç½®Unicodeå­—ç¬¦å±æ€§
  for i in 0..unicode_chars.length() {
    let key = "unicode." + i.to_string()
    Attributes::set(unicode_attrs, key, StringValue(unicode_chars[i]))
  }
  
  // éªŒè¯Unicodeå­—ç¬¦å±æ€§
  for i in 0..unicode_chars.length() {
    let key = "unicode." + i.to_string()
    let value = Attributes::get(unicode_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•æ§åˆ¶å­—ç¬¦å’Œç©ºç™½å­—ç¬¦
  let control_chars = [
    "\n",    // æ¢è¡Œ
    "\t",    // åˆ¶è¡¨ç¬¦
    "\r",    // å›è½¦
    "\u0000", // nullå­—ç¬¦
    "\u200B", // é›¶å®½ç©ºæ ¼
    "\u00A0", // ä¸é—´æ–­ç©ºæ ¼
    "\u3000"  // å…¨è§’ç©ºæ ¼
  ]
  
  for i in 0..control_chars.length() {
    let key = "control." + i.to_string()
    Attributes::set(unicode_attrs, key, StringValue(control_chars[i]))
    let value = Attributes::get(unicode_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•ç»„åˆå­—ç¬¦
  let combining_chars = [
    "e\u0301",  // e + é‡éŸ³ç¬¦
    "o\u0308",  // o + åˆ†éŸ³ç¬¦
    "u\u0302",  // u + æŠ‘æ‰¬ç¬¦
    "n\u0303",  // n + æ³¢æµªå·
    "c\u0327"   // c + ä¸‹åŠ ç¬¦
  ]
  
  for i in 0..combining_chars.length() {
    let key = "combining." + i.to_string()
    Attributes::set(unicode_attrs, key, StringValue(combining_chars[i]))
    let value = Attributes::get(unicode_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
}

test "æœ¬åœ°åŒ–æ•°å­—å’Œæ—¥æœŸæ ¼å¼æµ‹è¯•" {
  // æµ‹è¯•æœ¬åœ°åŒ–æ•°å­—æ ¼å¼
  let number_attrs = Attributes::new()
  
  // è®¾ç½®ä¸åŒåœ°åŒºçš„æ•°å­—æ ¼å¼
  let number_formats = [
    ("en-US", "1,234.56"),
    ("de-DE", "1.234,56"),
    ("fr-FR", "1 234,56"),
    ("zh-CN", "1,234.56"),
    ("ja-JP", "1,234.56"),
    ("ar-SA", "Ù¡Ù¬Ù¢Ù£Ù¤Ù«Ù¥Ù¦"),
    ("hi-IN", "à¥§,à¥¨à¥©à¥ª.à¥«à¥¬"),
    ("ru-RU", "1 234,56")
  ]
  
  for format in number_formats {
    let key = "number." + format[0]
    Attributes::set(number_attrs, key, StringValue(format[1]))
    let value = Attributes::get(number_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•æ—¥æœŸæ ¼å¼
  let date_attrs = Attributes::new()
  
  let date_formats = [
    ("en-US", "01/15/2025"),
    ("en-GB", "15/01/2025"),
    ("de-DE", "15.01.2025"),
    ("fr-FR", "15/01/2025"),
    ("zh-CN", "2025/1/15"),
    ("ja-JP", "2025/01/15"),
    ("ar-SA", "Ù¡Ù¥/Ù Ù¡/Ù¢Ù Ù¢Ù¥"),
    ("hi-IN", "à¥§à¥«/à¥¦à¥§/à¥¨à¥¦à¥¨à¥«"),
    ("ru-RU", "15.01.2025")
  ]
  
  for format in date_formats {
    let key = "date." + format[0]
    Attributes::set(date_attrs, key, StringValue(format[1]))
    let value = Attributes::get(date_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•æ—¶é—´æ ¼å¼
  let time_formats = [
    ("en-US", "2:30:45 PM"),
    ("en-GB", "14:30:45"),
    ("de-DE", "14:30:45"),
    ("fr-FR", "14:30:45"),
    ("zh-CN", "ä¸‹åˆ2:30:45"),
    ("ja-JP", "14:30:45"),
    ("ar-SA", "Ù¢:Ù£Ù :Ù¤Ù¥ Ù…"),
    ("hi-IN", "à¤¦à¥‹à¤ªà¤¹à¤° à¥¨:à¥©à¥¦:à¥ªà¥«"),
    ("ru-RU", "14:30:45")
  ]
  
  for format in time_formats {
    let key = "time." + format[0]
    Attributes::set(time_attrs := Attributes::new(), key, StringValue(format[1]))
    let value = Attributes::get(time_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
}

test "ä»å³åˆ°å·¦(RTL)è¯­è¨€æ”¯æŒæµ‹è¯•" {
  // æµ‹è¯•RTLè¯­è¨€æ”¯æŒ
  let rtl_attrs = Attributes::new()
  
  // è®¾ç½®RTLè¯­è¨€æ–‡æœ¬
  let rtl_texts = [
    ("ar", "Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…"),
    ("he", "×©×œ×•× ×¢×•×œ×"),
    ("fa", "Ø³Ù„Ø§Ù… Ø¯Ù†ÛŒØ§"),
    ("ur", "ÛÛŒÙ„Ùˆ Ø¯Ù†ÛŒØ§"),
    ("yi", "×”×¢×œ× ×•×•×¢×œ×˜")
  ]
  
  for rtl_text in rtl_texts {
    let key = "rtl." + rtl_text[0]
    Attributes::set(rtl_attrs, key, StringValue(rtl_text[1]))
    let value = Attributes::get(rtl_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•æ··åˆLTRå’ŒRTLæ–‡æœ¬
  let mixed_directions = [
    "Hello Ù…Ø±Ø­Ø¨Ø§",
    "Ù…Ø±Ø­Ø¨Ø§ World",
    "123 Ù…Ø±Ø­Ø¨Ø§ 456",
    "×©×œ×•× Hello ×©×œ×•×",
    "Ø³Ù„Ø§Ù… Ø¯Ù†ÛŒØ§ Hello World"
  ]
  
  for i in 0..mixed_directions.length() {
    let key = "mixed.direction." + i.to_string()
    Attributes::set(rtl_attrs, key, StringValue(mixed_directions[i]))
    let value = Attributes::get(rtl_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•RTLæ•°å­—å’Œæ ‡ç‚¹
  let rtl_numbers = [
    "Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©",  // é˜¿æ‹‰ä¼¯æ•°å­—
    "Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹Û°",  // æ³¢æ–¯æ•°å­—
    "à¥§à¥¨à¥©à¥ªà¥¥à¥¬à¥­à¥®à¥¯à¥¦"   // å°åœ°æ•°å­—
  ]
  
  for i in 0..rtl_numbers.length() {
    let key = "rtl.number." + i.to_string()
    Attributes::set(rtl_attrs, key, StringValue(rtl_numbers[i]))
    let value = Attributes::get(rtl_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
}

test "æ—¶åŒºå’Œå›½é™…åŒ–æ—¶é—´å¤„ç†æµ‹è¯•" {
  // æµ‹è¯•æ—¶åŒºå¤„ç†
  let timezone_attrs = Attributes::new()
  
  // è®¾ç½®ä¸åŒæ—¶åŒºçš„æ—¶é—´
  let timezones = [
    ("UTC", "2025-01-15T14:30:45Z"),
    ("America/New_York", "2025-01-15T09:30:45-05:00"),
    ("Europe/London", "2025-01-15T14:30:45+00:00"),
    ("Europe/Paris", "2025-01-15T15:30:45+01:00"),
    ("Asia/Tokyo", "2025-01-15T23:30:45+09:00"),
    ("Asia/Shanghai", "2025-01-15T22:30:45+08:00"),
    ("Australia/Sydney", "2025-01-16T01:30:45+11:00"),
    ("Asia/Dubai", "2025-01-15T18:30:45+04:00")
  ]
  
  for timezone in timezones {
    let key = "timezone." + timezone[0].replace("/", ".")
    Attributes::set(timezone_attrs, key, StringValue(timezone[1]))
    let value = Attributes::get(timezone_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•æ—¥å†ç³»ç»Ÿ
  let calendar_attrs = Attributes::new()
  
  let calendars = [
    ("gregorian", "2025-01-15"),
    ("islamic", "1446-07-15"),
    ("hebrew", "5785-11-15"),
    ("chinese", "2024-12-16"),
    ("japanese", "Reiwa-7-01-15"),
    ("indian", "1946-10-25"),
    ("persian", "1403-10-25")
  ]
  
  for calendar in calendars {
    let key = "calendar." + calendar[0]
    Attributes::set(calendar_attrs, key, StringValue(calendar[1]))
    let value = Attributes::get(calendar_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•ç›¸å¯¹æ—¶é—´æ ¼å¼
  let relative_time_attrs = Attributes::new()
  
  let relative_times = [
    ("en", "2 hours ago"),
    ("zh", "2å°æ—¶å‰"),
    ("ja", "2æ™‚é–“å‰"),
    ("ko", "2ì‹œê°„ ì „"),
    ("es", "hace 2 horas"),
    ("fr", "il y a 2 heures"),
    ("de", "vor 2 Stunden"),
    ("ru", "2 Ñ‡Ğ°ÑĞ° Ğ½Ğ°Ğ·Ğ°Ğ´"),
    ("ar", "Ù…Ù†Ø° Ø³Ø§Ø¹ØªÙŠÙ†"),
    ("hi", "2 à¤˜à¤‚à¤Ÿà¥‡ à¤ªà¤¹à¤²à¥‡")
  ]
  
  for relative_time in relative_times {
    let key = "relative." + relative_time[0]
    Attributes::set(relative_time_attrs, key, StringValue(relative_time[1]))
    let value = Attributes::get(relative_time_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
}

test "æœ¬åœ°åŒ–é”™è¯¯æ¶ˆæ¯æµ‹è¯•" {
  // æµ‹è¯•æœ¬åœ°åŒ–é”™è¯¯æ¶ˆæ¯
  let error_attrs = Attributes::new()
  
  // è®¾ç½®ä¸åŒè¯­è¨€çš„é”™è¯¯æ¶ˆæ¯
  let error_messages = [
    ("en", "Operation failed: Invalid input parameter"),
    ("zh", "æ“ä½œå¤±è´¥ï¼šè¾“å…¥å‚æ•°æ— æ•ˆ"),
    ("ja", "æ“ä½œãŒå¤±æ•—ã—ã¾ã—ãŸï¼šå…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒç„¡åŠ¹ã§ã™"),
    ("ko", "ì‘ì—… ì‹¤íŒ¨: ì…ë ¥ ë§¤ê°œë³€ìˆ˜ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"),
    ("es", "OperaciÃ³n fallida: ParÃ¡metro de entrada no vÃ¡lido"),
    ("fr", "OpÃ©ration Ã©chouÃ©e: ParamÃ¨tre d'entrÃ©e non valide"),
    ("de", "Operation fehlgeschlagen: UngÃ¼ltiger Eingabeparameter"),
    ("ru", "ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ°ÑÑŒ: ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ Ğ²Ğ²Ğ¾Ğ´Ğ°"),
    ("ar", "ÙØ´Ù„Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ØºÙŠØ± ØµØ§Ù„Ø­Ø©"),
    ("hi", "à¤‘à¤ªà¤°à¥‡à¤¶à¤¨ à¤µà¤¿à¤«à¤²: à¤…à¤®à¤¾à¤¨à¥à¤¯ à¤‡à¤¨à¤ªà¥à¤Ÿ à¤ªà¥ˆà¤°à¤¾à¤®à¥€à¤Ÿà¤°")
  ]
  
  for error_msg in error_messages {
    let key = "error." + error_msg[0]
    Attributes::set(error_attrs, key, StringValue(error_msg[1]))
    let value = Attributes::get(error_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•æœ¬åœ°åŒ–è­¦å‘Šæ¶ˆæ¯
  let warning_messages = [
    ("en", "Warning: Resource usage approaching limit"),
    ("zh", "è­¦å‘Šï¼šèµ„æºä½¿ç”¨ç‡æ¥è¿‘é™åˆ¶"),
    ("ja", "è­¦å‘Šï¼šãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ãŒåˆ¶é™ã«è¿‘ã¥ã„ã¦ã„ã¾ã™"),
    ("ko", "ê²½ê³ : ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì´ í•œê³„ì— ê°€ê¹Œì›Œì§€ê³  ìˆìŠµë‹ˆë‹¤"),
    ("es", "Advertencia: El uso de recursos se acerca al lÃ­mite"),
    ("fr", "Avertissement: L'utilisation des ressources approche de la limite"),
    ("de", "Warnung: Ressourcennutzung nÃ¤hert sich dem Limit"),
    ("ru", "ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ: Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ² Ğ¿Ñ€Ğ¸Ğ±Ğ»Ğ¸Ğ¶Ğ°ĞµÑ‚ÑÑ Ğº Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñƒ"),
    ("ar", "ØªØ­Ø°ÙŠØ±: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ÙŠÙ‚ØªØ±Ø¨ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰"),
    ("hi", "à¤šà¥‡à¤¤à¤¾à¤µà¤¨à¥€: à¤¸à¤‚à¤¸à¤¾à¤§à¤¨ à¤‰à¤ªà¤¯à¥‹à¤— à¤¸à¥€à¤®à¤¾ à¤•à¥‡ à¤•à¤°à¥€à¤¬ à¤ªà¤¹à¥à¤‚à¤š à¤°à¤¹à¤¾ à¤¹à¥ˆ")
  ]
  
  for warning_msg in warning_messages {
    let key = "warning." + warning_msg[0]
    Attributes::set(error_attrs, key, StringValue(warning_msg[1]))
    let value = Attributes::get(error_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
  
  // æµ‹è¯•æœ¬åœ°åŒ–ä¿¡æ¯æ¶ˆæ¯
  let info_messages = [
    ("en", "Information: System startup completed successfully"),
    ("zh", "ä¿¡æ¯ï¼šç³»ç»Ÿå¯åŠ¨æˆåŠŸå®Œæˆ"),
    ("ja", "æƒ…å ±ï¼šã‚·ã‚¹ãƒ†ãƒ ã®èµ·å‹•ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ"),
    ("ko", "ì •ë³´: ì‹œìŠ¤í…œ ì‹œì‘ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"),
    ("es", "InformaciÃ³n: El inicio del sistema se completÃ³ correctamente"),
    ("fr", "Information: Le dÃ©marrage du systÃ¨me s'est terminÃ© avec succÃ¨s"),
    ("de", "Information: Systemstart erfolgreich abgeschlossen"),
    ("ru", "Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ: Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½"),
    ("ar", "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª: ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­"),
    ("hi", "à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€: à¤¸à¤¿à¤¸à¥à¤Ÿà¤® à¤¸à¥à¤Ÿà¤¾à¤°à¥à¤Ÿà¤…à¤ª à¤¸à¤«à¤²à¤¤à¤¾à¤ªà¥‚à¤°à¥à¤µà¤• à¤ªà¥‚à¤°à¤¾ à¤¹à¥à¤†")
  ]
  
  for info_msg in info_messages {
    let key = "info." + info_msg[0]
    Attributes::set(error_attrs, key, StringValue(info_msg[1]))
    let value = Attributes::get(error_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
}

test "æœ¬åœ°åŒ–åº¦é‡å•ä½æµ‹è¯•" {
  // æµ‹è¯•æœ¬åœ°åŒ–åº¦é‡å•ä½
  let unit_attrs = Attributes::new()
  
  // è®¾ç½®ä¸åŒè¯­è¨€çš„åº¦é‡å•ä½
  let units = [
    ("en", {
      "bytes": "bytes",
      "kilobytes": "KB",
      "megabytes": "MB",
      "seconds": "seconds",
      "milliseconds": "ms",
      "requests_per_second": "req/s",
      "percentage": "%"
    }),
    ("zh", {
      "bytes": "å­—èŠ‚",
      "kilobytes": "åƒå­—èŠ‚",
      "megabytes": "å…†å­—èŠ‚",
      "seconds": "ç§’",
      "milliseconds": "æ¯«ç§’",
      "requests_per_second": "è¯·æ±‚/ç§’",
      "percentage": "%"
    }),
    ("ja", {
      "bytes": "ãƒã‚¤ãƒˆ",
      "kilobytes": "KB",
      "megabytes": "MB",
      "seconds": "ç§’",
      "milliseconds": "ãƒŸãƒªç§’",
      "requests_per_second": "ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ç§’",
      "percentage": "%"
    }),
    ("ko", {
      "bytes": "ë°”ì´íŠ¸",
      "kilobytes": "KB",
      "megabytes": "MB",
      "seconds": "ì´ˆ",
      "milliseconds": "ë°€ë¦¬ì´ˆ",
      "requests_per_second": "ìš”ì²­/ì´ˆ",
      "percentage": "%"
    })
  ]
  
  for unit in units {
    let lang = unit[0]
    let unit_map = unit[1]
    
    for unit_key => unit_value in unit_map {
      let key = "unit." + lang + "." + unit_key
      Attributes::set(unit_attrs, key, StringValue(unit_value))
      let value = Attributes::get(unit_attrs, key)
      assert_true(value == Some(StringValue("test_value")) || value == None)
    }
  }
  
  // æµ‹è¯•æœ¬åœ°åŒ–æ•°å­—æ ¼å¼
  let number_format_attrs = Attributes::new()
  
  let number_formats = [
    ("en", "1,234.56 MB"),
    ("de", "1.234,56 MB"),
    ("fr", "1 234,56 MB"),
    ("zh", "1,234.56 MB"),
    ("ja", "1,234.56 MB"),
    ("ko", "1,234.56 MB")
  ]
  
  for format in number_formats {
    let key = "format." + format[0]
    Attributes::set(number_format_attrs, key, StringValue(format[1]))
    let value = Attributes::get(number_format_attrs, key)
    assert_true(value == Some(StringValue("test_value")) || value == None)
  }
}

test "å›½é™…åŒ–é…ç½®å’Œå›é€€æµ‹è¯•" {
  // æµ‹è¯•å›½é™…åŒ–é…ç½®
  let i18n_config_attrs = Attributes::new()
  
  // è®¾ç½®å›½é™…åŒ–é…ç½®
  Attributes::set(i18n_config_attrs, "i18n.default.locale", StringValue("en-US"))
  Attributes::set(i18n_config_attrs, "i18n.supported.locales", StringValue("en-US,zh-CN,ja-JP,ko-KR,es-ES,fr-FR,de-DE,ru-RU,ar-SA,hi-IN"))
  Attributes::set(i18n_config_attrs, "i18n.fallback.locale", StringValue("en-US"))
  Attributes::set(i18n_config_attrs, "i18n.resource.bundle", StringValue("messages"))
  
  // éªŒè¯å›½é™…åŒ–é…ç½®
  let default_locale = Attributes::get(i18n_config_attrs, "i18n.default.locale")
  let supported_locales = Attributes::get(i18n_config_attrs, "i18n.supported.locales")
  let fallback_locale = Attributes::get(i18n_config_attrs, "i18n.fallback.locale")
  let resource_bundle = Attributes::get(i18n_config_attrs, "i18n.resource.bundle")
  
  assert_true(default_locale == Some(StringValue("test_value")) || default_locale == None)
  assert_true(supported_locales == Some(StringValue("test_value")) || supported_locales == None)
  assert_true(fallback_locale == Some(StringValue("test_value")) || fallback_locale == None)
  assert_true(resource_bundle == Some(StringValue("test_value")) || resource_bundle == None)
  
  // æµ‹è¯•è¯­è¨€å›é€€æœºåˆ¶
  let fallback_attrs = Attributes::new()
  
  // è®¾ç½®å›é€€é“¾
  Attributes::set(fallback_attrs, "message.zh-CN", StringValue("ä¸­æ–‡æ¶ˆæ¯"))
  Attributes::set(fallback_attrs, "message.zh", StringValue("ä¸­æ–‡æ¶ˆæ¯ï¼ˆé€šç”¨ï¼‰"))
  Attributes::set(fallback_attrs, "message.en", StringValue("English message"))
  
  // æ¨¡æ‹Ÿå›é€€æŸ¥æ‰¾
  let locales = ["zh-CN", "zh-TW", "zh", "en-US", "en"]
  let found_messages = []
  
  for locale in locales {
    let key = "message." + locale
    let message = Attributes::get(fallback_attrs, key)
    if message != None {
      found_messages.push({
        "locale": locale,
        "message": message
      })
      break
    }
  }
  
  // éªŒè¯å›é€€æŸ¥æ‰¾
  assert_true(found_messages.length() > 0)
  assert_eq(found_messages[0]["locale"], "zh-CN")
  
  // æµ‹è¯•ç¼ºå¤±ç¿»è¯‘çš„å¤„ç†
  let missing_attrs = Attributes::new()
  
  // è®¾ç½®éƒ¨åˆ†ç¿»è¯‘
  Attributes::set(missing_attrs, "partial.en", StringValue("English translation"))
  Attributes::set(missing_attrs, "partial.zh", StringValue("ä¸­æ–‡ç¿»è¯‘"))
  
  // æŸ¥æ‰¾ç¼ºå¤±çš„ç¿»è¯‘
  let missing_locales = ["fr", "de", "ja", "ko", "es", "ru", "ar", "hi"]
  let missing_translations = []
  
  for locale in missing_locales {
    let key = "partial." + locale
    let translation = Attributes::get(missing_attrs, key)
    if translation == None {
      missing_translations.push(locale)
    }
  }
  
  // éªŒè¯ç¼ºå¤±ç¿»è¯‘æ£€æµ‹
  assert_true(missing_translations.length() == missing_locales.length())
  
  // æµ‹è¯•å›é€€åˆ°é»˜è®¤è¯­è¨€
  for locale in missing_locales {
    let fallback_key = "partial.en"
    let fallback_translation = Attributes::get(missing_attrs, fallback_key)
    assert_true(fallback_translation != None)
  }
}