// å›½é™…åŒ–æ”¯æŒé«˜çº§æµ‹è¯•
// æµ‹è¯•å¤šè¯­è¨€æ”¯æŒã€Unicodeå¤„ç†ã€æœ¬åœ°åŒ–æ ¼å¼å’Œå…¨çƒåŒ–åŠŸèƒ½

test "å¤šè¯­è¨€å­—ç¬¦ä¸²å¤„ç†æµ‹è¯•" {
  // æµ‹è¯•ä¸­æ–‡æ”¯æŒ
  let chinese_string = StringValue("è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å­—ç¬¦ä¸²ï¼ŒåŒ…å«ä¸­æ–‡å­—ç¬¦")
  match chinese_string {
    StringValue(s) => {
      assert_true(s.contains("ä¸­æ–‡"), "ä¸­æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'ä¸­æ–‡'")
      assert_true(s.contains("æµ‹è¯•"), "ä¸­æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'æµ‹è¯•'")
      assert_eq(s.length(), 16, "ä¸­æ–‡å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•æ—¥æ–‡æ”¯æŒ
  let japanese_string = StringValue("ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆæ–‡å­—åˆ—ã§ã€æ—¥æœ¬èªæ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™")
  match japanese_string {
    StringValue(s) => {
      assert_true(s.contains("æ—¥æœ¬èª"), "æ—¥æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'æ—¥æœ¬èª'")
      assert_true(s.contains("ãƒ†ã‚¹ãƒˆ"), "æ—¥æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'ãƒ†ã‚¹ãƒˆ'")
      assert_eq(s.length(), 24, "æ—¥æ–‡å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•éŸ©æ–‡æ”¯æŒ
  let korean_string = StringValue("ì´ê²ƒì€ í…ŒìŠ¤íŠ¸ ë¬¸ìì—´ì´ë©°, í•œêµ­ì–´ ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤")
  match korean_string {
    StringValue(s) => {
      assert_true(s.contains("í•œêµ­ì–´"), "éŸ©æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'í•œêµ­ì–´'")
      assert_true(s.contains("í…ŒìŠ¤íŠ¸"), "éŸ©æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'í…ŒìŠ¤íŠ¸'")
      assert_eq(s.length(), 27, "éŸ©æ–‡å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•é˜¿æ‹‰ä¼¯æ–‡æ”¯æŒ
  let arabic_string = StringValue("Ù‡Ø°Ù‡ Ø³Ù„Ø³Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø­Ø±Ù Ø¹Ø±Ø¨ÙŠØ©")
  match arabic_string {
    StringValue(s) => {
      assert_true(s.contains("Ø¹Ø±Ø¨ÙŠØ©"), "é˜¿æ‹‰ä¼¯æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'Ø¹Ø±Ø¨ÙŠØ©'")
      assert_true(s.contains("Ø§Ø®ØªØ¨Ø§Ø±"), "é˜¿æ‹‰ä¼¯æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'Ø§Ø®ØªØ¨Ø§Ø±'")
      assert_eq(s.length(), 31, "é˜¿æ‹‰ä¼¯æ–‡å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•ä¿„æ–‡æ”¯æŒ
  let russian_string = StringValue("Ğ­Ñ‚Ğ¾ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ°, ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‰Ğ°Ñ Ñ€ÑƒÑÑĞºĞ¸Ğµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹")
  match russian_string {
    StringValue(s) => {
      assert_true(s.contains("Ñ€ÑƒÑÑĞºĞ¸Ğµ"), "ä¿„æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'Ñ€ÑƒÑÑĞºĞ¸Ğµ'")
      assert_true(s.contains("Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ°Ñ"), "ä¿„æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ°Ñ'")
      assert_eq(s.length(), 36, "ä¿„æ–‡å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•å¸Œä¼¯æ¥æ–‡æ”¯æŒ
  let hebrew_string = StringValue("×–×•×”×™ ××—×¨×•×–×ª ×‘×“×™×§×” ×”××›×™×œ×” ×ª×•×•×™× ×‘×¢×‘×¨×™×ª")
  match hebrew_string {
    StringValue(s) => {
      assert_true(s.contains("×¢×‘×¨×™×ª"), "å¸Œä¼¯æ¥æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'×¢×‘×¨×™×ª'")
      assert_true(s.contains("×‘×“×™×§×”"), "å¸Œä¼¯æ¥æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'×‘×“×™×§×”'")
      assert_eq(s.length(), 27, "å¸Œä¼¯æ¥æ–‡å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•æ³°æ–‡æ”¯æŒ
  let thai_string = StringValue("à¸™à¸µà¹ˆà¸„à¸·à¸­à¸ªà¸•à¸£à¸´à¸‡à¸—à¸”à¸ªà¸­à¸šà¸—à¸µà¹ˆà¸¡à¸µà¸­à¸±à¸à¸‚à¸£à¸°à¸ à¸²à¸©à¸²à¹„à¸—à¸¢")
  match thai_string {
    StringValue(s) => {
      assert_true(s.contains("à¸ à¸²à¸©à¸²à¹„à¸—à¸¢"), "æ³°æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'à¸ à¸²à¸©à¸²à¹„à¸—à¸¢'")
      assert_true(s.contains("à¸—à¸”à¸ªà¸­à¸š"), "æ³°æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«'à¸—à¸”à¸ªà¸­à¸š'")
      assert_eq(s.length(), 30, "æ³°æ–‡å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
}

test "Unicodeå­—ç¬¦å’ŒEmojiæ”¯æŒæµ‹è¯•" {
  // æµ‹è¯•åŸºæœ¬Emojiæ”¯æŒ
  let basic_emoji_string = StringValue("Hello World! ğŸŒğŸš€â­ğŸ’¡")
  match basic_emoji_string {
    StringValue(s) => {
      assert_true(s.contains("ğŸŒ"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«åœ°çƒemoji")
      assert_true(s.contains("ğŸš€"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«ç«ç®­emoji")
      assert_true(s.contains("â­"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ˜Ÿæ˜Ÿemoji")
      assert_true(s.contains("ğŸ’¡"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«ç¯æ³¡emoji")
      assert_eq(s.length(), 18, "åŸºæœ¬emojiå­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•å¤æ‚Emojiæ”¯æŒ
  let complex_emoji_string = StringValue("Complex emojis: ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ğŸ³ï¸â€ğŸŒˆ ğŸ‰ğŸŠğŸˆ")
  match complex_emoji_string {
    StringValue(s) => {
      assert_true(s.contains("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«å®¶åº­emoji")
      assert_true(s.contains("ğŸ³ï¸â€ğŸŒˆ"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«å½©è™¹æ——emoji")
      assert_true(s.contains("ğŸ‰"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ´¾å¯¹emoji")
      assert_eq(s.length(), 28, "å¤æ‚emojiå­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•Unicodeç‰¹æ®Šå­—ç¬¦
  let unicode_special_string = StringValue("Special Unicode: Â©Â®â„¢â‚¬Â£Â¥Â§Â¶â€ â€¡â€¢â€¦â€°â€¹â€º""''â€“â€”")
  match unicode_special_string {
    StringValue(s) => {
      assert_true(s.contains("Â©"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«ç‰ˆæƒç¬¦å·")
      assert_true(s.contains("Â®"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ³¨å†Œå•†æ ‡ç¬¦å·")
      assert_true(s.contains("â„¢"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«å•†æ ‡ç¬¦å·")
      assert_true(s.contains("â‚¬"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ¬§å…ƒç¬¦å·")
      assert_true(s.contains("Â£"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«è‹±é•‘ç¬¦å·")
      assert_true(s.contains("Â¥"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ—¥å…ƒç¬¦å·")
      assert_eq(s.length(), 32, "Unicodeç‰¹æ®Šå­—ç¬¦å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•æ•°å­¦ç¬¦å·
  let math_symbols_string = StringValue("Math symbols: âˆ‘âˆâˆ«âˆ†âˆ‡âˆ‚âˆÂ±Ã—Ã·â‰¤â‰¥â‰ â‰ˆâˆˆâˆ‰âŠ‚âŠƒâˆ§âˆ¨Â¬")
  match math_symbols_string {
    StringValue(s) => {
      assert_true(s.contains("âˆ‘"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ±‚å’Œç¬¦å·")
      assert_true(s.contains("âˆ"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ— ç©·ç¬¦å·")
      assert_true(s.contains("Â±"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«æ­£è´Ÿå·")
      assert_true(s.contains("Ã—"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«ä¹˜å·")
      assert_true(s.contains("Ã·"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«é™¤å·")
      assert_eq(s.length(), 32, "æ•°å­¦ç¬¦å·å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
  
  // æµ‹è¯•ç®­å¤´ç¬¦å·
  let arrows_string = StringValue("Arrows: â†â†’â†‘â†“â†–â†—â†˜â†™â‡â‡’â‡‘â‡“â‡”â‡•â‡–â‡—â‡˜â‡™")
  match arrows_string {
    StringValue(s) => {
      assert_true(s.contains("â†"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«å·¦ç®­å¤´")
      assert_true(s.contains("â†’"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«å³ç®­å¤´")
      assert_true(s.contains("â†‘"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«ä¸Šç®­å¤´")
      assert_true(s.contains("â†“"), "å­—ç¬¦ä¸²åº”è¯¥åŒ…å«ä¸‹ç®­å¤´")
      assert_eq(s.length(), 26, "ç®­å¤´ç¬¦å·å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å­—ç¬¦ä¸²å€¼")
  }
}

test "å¤šè¯­è¨€æ—¥å¿—è®°å½•æµ‹è¯•" {
  // åˆ›å»ºå¤šè¯­è¨€æ—¥å¿—æä¾›è€…
  let logger_provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(logger_provider, "internationalization-test")
  
  // åˆ›å»ºä¸­æ–‡æ—¥å¿—è®°å½•
  let chinese_log = LogRecord::new_with_context(
    Info,
    Some("ç”¨æˆ·ç™»å½•æˆåŠŸï¼Œç”¨æˆ·ID: 12345"),
    None,
    Some(1735689600000000000L),
    Some(1735689600000001000L),
    Some("trace-cn-12345"),
    Some("span-cn-67890"),
    Some(Context::with_value(Context::root(), ContextKey::new("language"), "zh-CN"))
  )
  
  // åˆ›å»ºæ—¥æ–‡æ—¥å¿—è®°å½•
  let japanese_log = LogRecord::new_with_context(
    Warn,
    Some("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒç™ºç”Ÿã—ã¾ã—ãŸ"),
    None,
    Some(1735689600000002000L),
    Some(1735689600000003000L),
    Some("trace-ja-12345"),
    Some("span-ja-67890"),
    Some(Context::with_value(Context::root(), ContextKey::new("language"), "ja-JP"))
  )
  
  // åˆ›å»ºéŸ©æ–‡æ—¥å¿—è®°å½•
  let korean_log = LogRecord::new_with_context(
    Error,
    Some("ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”."),
    None,
    Some(1735689600000004000L),
    Some(1735689600000005000L),
    Some("trace-ko-12345"),
    Some("span-ko-67890"),
    Some(Context::with_value(Context::root(), ContextKey::new("language"), "ko-KR"))
  )
  
  // å‘é€å¤šè¯­è¨€æ—¥å¿—
  Logger::emit(logger, chinese_log)
  Logger::emit(logger, japanese_log)
  Logger::emit(logger, korean_log)
  
  // éªŒè¯ä¸­æ–‡æ—¥å¿—
  assert_eq(LogRecord::severity_number(chinese_log), Info, "ä¸­æ–‡æ—¥å¿—ä¸¥é‡çº§åˆ«åº”è¯¥æ­£ç¡®")
  match LogRecord::body(chinese_log) {
    Some(body) => {
      assert_true(body.contains("ç”¨æˆ·ç™»å½•"), "ä¸­æ–‡æ—¥å¿—åº”è¯¥åŒ…å«ç”¨æˆ·ç™»å½•ä¿¡æ¯")
      assert_true(body.contains("12345"), "ä¸­æ–‡æ—¥å¿—åº”è¯¥åŒ…å«ç”¨æˆ·ID")
    }
    _ => assert_true(false, "æœŸæœ›ä¸­æ–‡æ—¥å¿—æœ‰å†…å®¹")
  }
  assert_eq(LogRecord::trace_id(chinese_log), Some("trace-cn-12345"), "ä¸­æ–‡æ—¥å¿—è¿½è¸ªIDåº”è¯¥æ­£ç¡®")
  
  // éªŒè¯æ—¥æ–‡æ—¥å¿—
  assert_eq(LogRecord::severity_number(japanese_log), Warn, "æ—¥æ–‡æ—¥å¿—ä¸¥é‡çº§åˆ«åº”è¯¥æ­£ç¡®")
  match LogRecord::body(japanese_log) {
    Some(body) => {
      assert_true(body.contains("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"), "æ—¥æ–‡æ—¥å¿—åº”è¯¥åŒ…å«æ•°æ®åº“ä¿¡æ¯")
      assert_true(body.contains("ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ"), "æ—¥æ–‡æ—¥å¿—åº”è¯¥åŒ…å«è¶…æ—¶ä¿¡æ¯")
    }
    _ => assert_true(false, "æœŸæœ›æ—¥æ–‡æ—¥å¿—æœ‰å†…å®¹")
  }
  assert_eq(LogRecord::trace_id(japanese_log), Some("trace-ja-12345"), "æ—¥æ–‡æ—¥å¿—è¿½è¸ªIDåº”è¯¥æ­£ç¡®")
  
  // éªŒè¯éŸ©æ–‡æ—¥å¿—
  assert_eq(LogRecord::severity_number(korean_log), Error, "éŸ©æ–‡æ—¥å¿—ä¸¥é‡çº§åˆ«åº”è¯¥æ­£ç¡®")
  match LogRecord::body(korean_log) {
    Some(body) => {
      assert_true(body.contains("ì„œë²„ ì˜¤ë¥˜"), "éŸ©æ–‡æ—¥å¿—åº”è¯¥åŒ…å«æœåŠ¡å™¨é”™è¯¯ä¿¡æ¯")
      assert_true(body.contains("ê´€ë¦¬ì"), "éŸ©æ–‡æ—¥å¿—åº”è¯¥åŒ…å«ç®¡ç†å‘˜ä¿¡æ¯")
    }
    _ => assert_true(false, "æœŸæœ›éŸ©æ–‡æ—¥å¿—æœ‰å†…å®¹")
  }
  assert_eq(LogRecord::trace_id(korean_log), Some("trace-ko-12345"), "éŸ©æ–‡æ—¥å¿—è¿½è¸ªIDåº”è¯¥æ­£ç¡®")
}

test "å¤šè¯­è¨€å±æ€§å’Œèµ„æºæµ‹è¯•" {
  // åˆ›å»ºå¤šè¯­è¨€å±æ€§
  let multilingual_attributes = Attributes::new()
  
  // è®¾ç½®ä¸åŒè¯­è¨€çš„å±æ€§å€¼
  Attributes::set(multilingual_attributes, "error.message.zh", StringValue("æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•"))
  Attributes::set(multilingual_attributes, "error.message.ja", StringValue("æ“ä½œãŒå¤±æ•—ã—ã¾ã—ãŸã€‚å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚"))
  Attributes::set(multilingual_attributes, "error.message.ko", StringValue("ì‘ì—…ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”."))
  Attributes::set(multilingual_attributes, "error.message.en", StringValue("Operation failed, please retry"))
  Attributes::set(multilingual_attributes, "error.message.ar", StringValue("ÙØ´Ù„Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰"))
  
  // éªŒè¯å¤šè¯­è¨€å±æ€§
  let zh_message = Attributes::get(multilingual_attributes, "error.message.zh")
  let ja_message = Attributes::get(multilingual_attributes, "error.message.ja")
  let ko_message = Attributes::get(multilingual_attributes, "error.message.ko")
  let en_message = Attributes::get(multilingual_attributes, "error.message.en")
  let ar_message = Attributes::get(multilingual_attributes, "error.message.ar")
  
  match zh_message {
    Some(StringValue(msg)) => {
      assert_true(msg.contains("æ“ä½œå¤±è´¥"), "ä¸­æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥æ­£ç¡®")
      assert_true(msg.contains("è¯·é‡è¯•"), "ä¸­æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥åŒ…å«é‡è¯•æç¤º")
    }
    _ => assert_true(false, "æœŸæœ›ä¸­æ–‡é”™è¯¯æ¶ˆæ¯")
  }
  
  match ja_message {
    Some(StringValue(msg)) => {
      assert_true(msg.contains("å¤±æ•—"), "æ—¥æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥æ­£ç¡®")
      assert_true(msg.contains("å†è©¦è¡Œ"), "æ—¥æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥åŒ…å«é‡è¯•æç¤º")
    }
    _ => assert_true(false, "æœŸæœ›æ—¥æ–‡é”™è¯¯æ¶ˆæ¯")
  }
  
  match ko_message {
    Some(StringValue(msg)) => {
      assert_true(msg.contains("ì‹¤íŒ¨"), "éŸ©æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥æ­£ç¡®")
      assert_true(msg.contains("ë‹¤ì‹œ ì‹œë„"), "éŸ©æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥åŒ…å«é‡è¯•æç¤º")
    }
    _ => assert_true(false, "æœŸæœ›éŸ©æ–‡é”™è¯¯æ¶ˆæ¯")
  }
  
  match en_message {
    Some(StringValue(msg)) => {
      assert_true(msg.contains("failed"), "è‹±æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥æ­£ç¡®")
      assert_true(msg.contains("retry"), "è‹±æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥åŒ…å«é‡è¯•æç¤º")
    }
    _ => assert_true(false, "æœŸæœ›è‹±æ–‡é”™è¯¯æ¶ˆæ¯")
  }
  
  match ar_message {
    Some(StringValue(msg)) => {
      assert_true(msg.contains("ÙØ´Ù„Øª"), "é˜¿æ‹‰ä¼¯æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥æ­£ç¡®")
      assert_true(msg.contains("Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©"), "é˜¿æ‹‰ä¼¯æ–‡é”™è¯¯æ¶ˆæ¯åº”è¯¥åŒ…å«é‡è¯•æç¤º")
    }
    _ => assert_true(false, "æœŸæœ›é˜¿æ‹‰ä¼¯æ–‡é”™è¯¯æ¶ˆæ¯")
  }
  
  // åˆ›å»ºå¤šè¯­è¨€èµ„æº
  let multilingual_resource = Resource::new()
  let multilingual_resource_attributes = [
    ("service.name.zh", StringValue("ç”¨æˆ·æœåŠ¡")),
    ("service.name.ja", StringValue("ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹")),
    ("service.name.ko", StringValue("ì‚¬ìš©ì ì„œë¹„ìŠ¤")),
    ("service.name.en", StringValue("User Service")),
    ("service.description.zh", StringValue("å¤„ç†ç”¨æˆ·æ³¨å†Œã€ç™»å½•å’Œä¸ªäººä¿¡æ¯ç®¡ç†")),
    ("service.description.ja", StringValue("ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã€ãƒ­ã‚°ã‚¤ãƒ³ã€å€‹äººæƒ…å ±ç®¡ç†ã‚’å‡¦ç†")),
    ("service.description.ko", StringValue("ì‚¬ìš©ì ë“±ë¡, ë¡œê·¸ì¸, ê°œì¸ ì •ë³´ ê´€ë¦¬ë¥¼ ì²˜ë¦¬")),
    ("service.description.en", StringValue("Handles user registration, login, and profile management")),
    ("region.zh", StringValue("äºšå¤ªåœ°åŒº")),
    ("region.ja", StringValue("ã‚¢ã‚¸ã‚¢å¤ªå¹³æ´‹åœ°åŸŸ")),
    ("region.ko", StringValue("ì•„ì‹œì•„ íƒœí‰ì–‘ ì§€ì—­")),
    ("region.en", StringValue("Asia Pacific"))
  ]
  let enriched_multilingual_resource = Resource::with_attributes(multilingual_resource, multilingual_resource_attributes)
  
  // éªŒè¯å¤šè¯­è¨€èµ„æº
  let service_name_zh = Resource::get_attribute(enriched_multilingual_resource, "service.name.zh")
  let service_name_ja = Resource::get_attribute(enriched_multilingual_resource, "service.name.ja")
  let service_name_ko = Resource::get_attribute(enriched_multilingual_resource, "service.name.ko")
  let service_name_en = Resource::get_attribute(enriched_multilingual_resource, "service.name.en")
  
  match service_name_zh {
    Some(StringValue(name)) => assert_eq(name, "ç”¨æˆ·æœåŠ¡", "ä¸­æ–‡æœåŠ¡åç§°åº”è¯¥æ­£ç¡®")
    _ => assert_true(false, "æœŸæœ›ä¸­æ–‡æœåŠ¡åç§°")
  }
  
  match service_name_ja {
    Some(StringValue(name)) => assert_eq(name, "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹", "æ—¥æ–‡æœåŠ¡åç§°åº”è¯¥æ­£ç¡®")
    _ => assert_true(false, "æœŸæœ›æ—¥æ–‡æœåŠ¡åç§°")
  }
  
  match service_name_ko {
    Some(StringValue(name)) => assert_eq(name, "ì‚¬ìš©ì ì„œë¹„ìŠ¤", "éŸ©æ–‡æœåŠ¡åç§°åº”è¯¥æ­£ç¡®")
    _ => assert_true(false, "æœŸæœ›éŸ©æ–‡æœåŠ¡åç§°")
  }
  
  match service_name_en {
    Some(StringValue(name)) => assert_eq(name, "User Service", "è‹±æ–‡æœåŠ¡åç§°åº”è¯¥æ­£ç¡®")
    _ => assert_true(false, "æœŸæœ›è‹±æ–‡æœåŠ¡åç§°")
  }
}

test "æœ¬åœ°åŒ–æ ¼å¼å’Œæ—¶åŒºæµ‹è¯•" {
  // æµ‹è¯•ä¸åŒåœ°åŒºçš„æ—¥æœŸæ—¶é—´æ ¼å¼ï¼ˆæ¨¡æ‹Ÿï¼‰
  let us_date_string = StringValue("12/28/2025 03:45:30 PM EST")
  let eu_date_string = StringValue("28/12/2025 15:45:30 CET")
  let iso_date_string = StringValue("2025-12-28T15:45:30+00:00")
  let cn_date_string = StringValue("2025å¹´12æœˆ28æ—¥ 15:45:30 CST")
  let jp_date_string = StringValue("2025å¹´12æœˆ28æ—¥ 15æ™‚45åˆ†30ç§’ JST")
  
  // éªŒè¯ä¸åŒåœ°åŒºçš„æ—¥æœŸæ ¼å¼
  match us_date_string {
    StringValue(s) => {
      assert_true(s.contains("12/28/2025"), "ç¾å¼æ—¥æœŸæ ¼å¼åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("PM"), "ç¾å¼æ—¶é—´åº”è¯¥åŒ…å«AM/PM")
      assert_true(s.contains("EST"), "ç¾å¼æ—¶åŒºåº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›ç¾å¼æ—¥æœŸå­—ç¬¦ä¸²")
  }
  
  match eu_date_string {
    StringValue(s) => {
      assert_true(s.contains("28/12/2025"), "æ¬§å¼æ—¥æœŸæ ¼å¼åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("15:45"), "æ¬§å¼æ—¶é—´åº”è¯¥æ˜¯24å°æ—¶åˆ¶")
      assert_true(s.contains("CET"), "æ¬§å¼æ—¶åŒºåº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›æ¬§å¼æ—¥æœŸå­—ç¬¦ä¸²")
  }
  
  match iso_date_string {
    StringValue(s) => {
      assert_true(s.contains("2025-12-28T"), "ISOæ—¥æœŸæ ¼å¼åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("+00:00"), "ISOæ—¶åŒºåº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›ISOæ—¥æœŸå­—ç¬¦ä¸²")
  }
  
  match cn_date_string {
    StringValue(s) => {
      assert_true(s.contains("2025å¹´12æœˆ28æ—¥"), "ä¸­æ–‡æ—¥æœŸæ ¼å¼åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("CST"), "ä¸­æ–‡æ—¶åŒºåº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›ä¸­æ–‡æ—¥æœŸå­—ç¬¦ä¸²")
  }
  
  match jp_date_string {
    StringValue(s) => {
      assert_true(s.contains("2025å¹´12æœˆ28æ—¥"), "æ—¥æ–‡æ—¥æœŸæ ¼å¼åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("15æ™‚45åˆ†"), "æ—¥æ–‡æ—¶é—´æ ¼å¼åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("JST"), "æ—¥æ–‡æ—¶åŒºåº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›æ—¥æ–‡æ—¥æœŸå­—ç¬¦ä¸²")
  }
  
  // æµ‹è¯•æ•°å­—æ ¼å¼
  let us_number_string = StringValue("1,234,567.89")
  let eu_number_string = StringValue("1.234.567,89")
  let cn_number_string = StringValue("1,234,567.89")
  let in_number_string = StringValue("12,34,567.89")
  
  match us_number_string {
    StringValue(s) => {
      assert_true(s.contains("1,234,567"), "ç¾å¼æ•°å­—åƒä½åˆ†éš”ç¬¦åº”è¯¥æ­£ç¡®")
      assert_true(s.contains(".89"), "ç¾å¼æ•°å­—å°æ•°ç‚¹åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›ç¾å¼æ•°å­—å­—ç¬¦ä¸²")
  }
  
  match eu_number_string {
    StringValue(s) => {
      assert_true(s.contains("1.234.567"), "æ¬§å¼æ•°å­—åƒä½åˆ†éš”ç¬¦åº”è¯¥æ­£ç¡®")
      assert_true(s.contains(",89"), "æ¬§å¼æ•°å­—å°æ•°ç‚¹åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›æ¬§å¼æ•°å­—å­—ç¬¦ä¸²")
  }
  
  // æµ‹è¯•è´§å¸æ ¼å¼
  let us_currency_string = StringValue("$1,234.56")
  let eu_currency_string = StringValue("â‚¬1.234,56")
  let jp_currency_string = StringValue("Â¥1,235")
  let cn_currency_string = StringValue("Â¥1,234.56")
  
  match us_currency_string {
    StringValue(s) => {
      assert_true(s.contains("$"), "ç¾å…ƒç¬¦å·åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("1,234.56"), "ç¾å…ƒæ ¼å¼åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›ç¾å…ƒå­—ç¬¦ä¸²")
  }
  
  match eu_currency_string {
    StringValue(s) => {
      assert_true(s.contains("â‚¬"), "æ¬§å…ƒç¬¦å·åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("1.234,56"), "æ¬§å…ƒæ ¼å¼åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›æ¬§å…ƒå­—ç¬¦ä¸²")
  }
  
  match jp_currency_string {
    StringValue(s) => {
      assert_true(s.contains("Â¥"), "æ—¥å…ƒç¬¦å·åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("1,235"), "æ—¥å…ƒæ ¼å¼åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›æ—¥å…ƒå­—ç¬¦ä¸²")
  }
  
  match cn_currency_string {
    StringValue(s) => {
      assert_true(s.contains("Â¥"), "äººæ°‘å¸ç¬¦å·åº”è¯¥æ­£ç¡®")
      assert_true(s.contains("1,234.56"), "äººæ°‘å¸æ ¼å¼åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›äººæ°‘å¸å­—ç¬¦ä¸²")
  }
}

test "æ–‡åŒ–é€‚åº”æ€§æµ‹è¯•" {
  // æµ‹è¯•ä»å³åˆ°å·¦ï¼ˆRTLï¼‰è¯­è¨€
  let rtl_string = StringValue("Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…! Ù‡Ø°Ù‡ Ø±Ø³Ø§Ù„Ø© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.")
  match rtl_string {
    StringValue(s) => {
      assert_true(s.contains("Ù…Ø±Ø­Ø¨Ø§"), "RTLå­—ç¬¦ä¸²åº”è¯¥åŒ…å«é˜¿æ‹‰ä¼¯æ–‡é—®å€™")
      assert_true(s.contains("Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"), "RTLå­—ç¬¦ä¸²åº”è¯¥åŒ…å«é˜¿æ‹‰ä¼¯æ–‡æ ‡è¯†")
      assert_eq(s.length(), 39, "RTLå­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›RTLå­—ç¬¦ä¸²")
  }
  
  // æµ‹è¯•å¸Œä¼¯æ¥æ–‡ï¼ˆRTLï¼‰
  let hebrew_string = StringValue("×©×œ×•× ×¢×•×œ×! ×–×• ×”×•×“×¢×” ×‘×©×¤×” ×”×¢×‘×¨×™×ª.")
  match hebrew_string {
    StringValue(s) => {
      assert_true(s.contains("×©×œ×•×"), "å¸Œä¼¯æ¥æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«é—®å€™")
      assert_true(s.contains("×¢×‘×¨×™×ª"), "å¸Œä¼¯æ¥æ–‡å­—ç¬¦ä¸²åº”è¯¥åŒ…å«è¯­è¨€æ ‡è¯†")
      assert_eq(s.length(), 30, "å¸Œä¼¯æ¥æ–‡å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æ­£ç¡®")
    }
    _ => assert_true(false, "æœŸæœ›å¸Œä¼¯æ¥æ–‡å­—ç¬¦ä¸²")
  }
  
  // æµ‹è¯•å¤åˆè¯­è¨€ç¯å¢ƒ
  let mixed_locale_string = StringValue("User: ç”¨æˆ·å123, Region: ä¸­å›½, Language: ä¸­æ–‡(ç®€ä½“)")
  match mixed_locale_string {
    StringValue(s) => {
      assert_true(s.contains("ç”¨æˆ·å123"), "æ··åˆè¯­è¨€å­—ç¬¦ä¸²åº”è¯¥åŒ…å«ä¸­æ–‡ç”¨æˆ·å")
      assert_true(s.contains("ä¸­å›½"), "æ··åˆè¯­è¨€å­—ç¬¦ä¸²åº”è¯¥åŒ…å«ä¸­æ–‡åœ°åŒº")
      assert_true(s.contains("ä¸­æ–‡(ç®€ä½“)"), "æ··åˆè¯­è¨€å­—ç¬¦ä¸²åº”è¯¥åŒ…å«è¯­è¨€æ ‡è¯†")
      assert_true(s.contains("User:"), "æ··åˆè¯­è¨€å­—ç¬¦ä¸²åº”è¯¥åŒ…å«è‹±æ–‡æ ‡ç­¾")
      assert_true(s.contains("Region:"), "æ··åˆè¯­è¨€å­—ç¬¦ä¸²åº”è¯¥åŒ…å«è‹±æ–‡æ ‡ç­¾")
      assert_true(s.contains("Language:"), "æ··åˆè¯­è¨€å­—ç¬¦ä¸²åº”è¯¥åŒ…å«è‹±æ–‡æ ‡ç­¾")
    }
    _ => assert_true(false, "æœŸæœ›æ··åˆè¯­è¨€å­—ç¬¦ä¸²")
  }
  
  // åˆ›å»ºå¤šè¯­è¨€ä¸Šä¸‹æ–‡
  let zh_context = Context::with_value(Context::root(), ContextKey::new("locale"), "zh-CN")
  let ja_context = Context::with_value(Context::root(), ContextKey::new("locale"), "ja-JP")
  let ko_context = Context::with_value(Context::root(), ContextKey::new("locale"), "ko-KR")
  let ar_context = Context::with_value(Context::root(), ContextKey::new("locale"), "ar-SA")
  let he_context = Context::with_value(Context::root(), ContextKey::new("locale"), "he-IL")
  
  // éªŒè¯å¤šè¯­è¨€ä¸Šä¸‹æ–‡
  let zh_locale = Context::get(zh_context, ContextKey::new("locale"))
  let ja_locale = Context::get(ja_context, ContextKey::new("locale"))
  let ko_locale = Context::get(ko_context, ContextKey::new("locale"))
  let ar_locale = Context::get(ar_context, ContextKey::new("locale"))
  let he_locale = Context::get(he_context, ContextKey::new("locale"))
  
  assert_eq(zh_locale, Some("zh-CN"), "ä¸­æ–‡è¯­è¨€ç¯å¢ƒåº”è¯¥æ­£ç¡®")
  assert_eq(ja_locale, Some("ja-JP"), "æ—¥æ–‡è¯­è¨€ç¯å¢ƒåº”è¯¥æ­£ç¡®")
  assert_eq(ko_locale, Some("ko-KR"), "éŸ©æ–‡è¯­è¨€ç¯å¢ƒåº”è¯¥æ­£ç¡®")
  assert_eq(ar_locale, Some("ar-SA"), "é˜¿æ‹‰ä¼¯æ–‡è¯­è¨€ç¯å¢ƒåº”è¯¥æ­£ç¡®")
  assert_eq(he_locale, Some("he-IL"), "å¸Œä¼¯æ¥æ–‡è¯­è¨€ç¯å¢ƒåº”è¯¥æ­£ç¡®")
  
  // æµ‹è¯•æ–‡åŒ–ç›¸å…³çš„åº¦é‡åç§°
  let zh_meter = MeterProvider::get_meter(MeterProvider::default(), "ä¸­æ–‡åº¦é‡")
  let ja_meter = MeterProvider::get_meter(MeterProvider::default(), "æ—¥æœ¬èªãƒ¡ãƒˆãƒªãƒƒã‚¯")
  let ko_meter = MeterProvider::get_meter(MeterProvider::default(), "í•œêµ­ì–´ ë©”íŠ¸ë¦­")
  
  let zh_counter = Meter::create_counter(zh_meter, "ä¸­æ–‡è®¡æ•°å™¨")
  let ja_counter = Meter::create_counter(ja_meter, "æ—¥æœ¬èªã‚«ã‚¦ãƒ³ã‚¿ãƒ¼")
  let ko_counter = Meter::create_counter(ko_meter, "í•œêµ­ì–´ ì¹´ìš´í„°")
  
  // éªŒè¯æ–‡åŒ–ç›¸å…³çš„åº¦é‡
  assert_eq(zh_counter.name, "ä¸­æ–‡è®¡æ•°å™¨", "ä¸­æ–‡è®¡æ•°å™¨åç§°åº”è¯¥æ­£ç¡®")
  assert_eq(ja_counter.name, "æ—¥æœ¬èªã‚«ã‚¦ãƒ³ã‚¿ãƒ¼", "æ—¥æ–‡è®¡æ•°å™¨åç§°åº”è¯¥æ­£ç¡®")
  assert_eq(ko_counter.name, "í•œêµ­ì–´ ì¹´ìš´í„°", "éŸ©æ–‡è®¡æ•°å™¨åç§°åº”è¯¥æ­£ç¡®")
  
  // è®°å½•æ–‡åŒ–ç›¸å…³çš„åº¦é‡æ•°æ®
  Counter::add(zh_counter, 100.0)
  Counter::add(ja_counter, 200.0)
  Counter::add(ko_counter, 300.0)
}