// Internationalization Text Processing Tests for Azimuth Telemetry System
// This file contains test cases for internationalization and text processing

test "chinese text handling in attributes" {
  let attrs = Attributes::new()
  
  // Test Chinese characters in attribute values
  Attributes::set(attrs, "æœåŠ¡åç§°", StringValue("ç”¨æˆ·è®¤è¯æœåŠ¡"))
  Attributes::set(attrs, "æœåŠ¡æè¿°", StringValue("å¤„ç†ç”¨æˆ·ç™»å½•å’Œèº«ä»½éªŒè¯"))
  Attributes::set(attrs, "é”™è¯¯ä¿¡æ¯", StringValue("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"))
  
  let service_name = Attributes::get(attrs, "æœåŠ¡åç§°")
  let service_desc = Attributes::get(attrs, "æœåŠ¡æè¿°")
  let error_msg = Attributes::get(attrs, "é”™è¯¯ä¿¡æ¯")
  
  assert_eq(service_name, Some(StringValue("ç”¨æˆ·è®¤è¯æœåŠ¡")))
  assert_eq(service_desc, Some(StringValue("å¤„ç†ç”¨æˆ·ç™»å½•å’Œèº«ä»½éªŒè¯")))
  assert_eq(error_msg, Some(StringValue("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯")))
}

test "japanese text handling in log records" {
  let provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(provider, "æ—¥æœ¬èªãƒ­ã‚¬ãƒ¼")
  
  let record = LogRecord::new(Info, "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³ãŒæˆåŠŸã—ã¾ã—ãŸ")
  
  assert_eq(LogRecord::severity_number(record), Info)
  assert_eq(LogRecord::body(record), Some("ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³ãŒæˆåŠŸã—ã¾ã—ãŸ"))
  
  Logger::emit(logger, record)
  assert_true(true)
}

test "korean text handling in span names" {
  let span_ctx = SpanContext::new("korean-trace", "korean-span", true, "")
  let span = Span::new("í•œêµ­ì–´ ì‘ì—…", Internal, span_ctx)
  
  assert_eq(Span::name(span), "í•œêµ­ì–´ ì‘ì—…")
  assert_eq(Span::kind(span), Internal)
  assert_true(Span::is_recording(span))
}

test "arabic text handling in resource attributes" {
  let attrs = [
    ("Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©", StringValue("Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©")),
    ("Ø§Ù„ÙˆØµÙ", StringValue("Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©")),
    ("Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£", StringValue("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©"))
  ]
  
  let resource = Resource::with_attributes(Resource::new(), attrs)
  
  let service_name = Resource::get_attribute(resource, "Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©")
  let description = Resource::get_attribute(resource, "Ø§Ù„ÙˆØµÙ")
  let error_msg = Resource::get_attribute(resource, "Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£")
  
  assert_eq(service_name, Some(StringValue("Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©")))
  assert_eq(description, Some(StringValue("Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©")))
  assert_eq(error_msg, Some(StringValue("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©")))
}

test "russian text handling in baggage" {
  let baggage = Baggage::new()
  let with_entries = Baggage::set_entry(baggage, "Ğ¸Ğ¼Ñ_Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", "Ğ˜Ğ²Ğ°Ğ½_ĞŸĞµÑ‚Ñ€Ğ¾Ğ²")
  let final_baggage = Baggage::set_entry(with_entries, "Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€_ÑĞµÑÑĞ¸Ğ¸", "ÑĞµÑÑĞ¸Ñ_12345")
  
  let username = Baggage::get_entry(final_baggage, "Ğ¸Ğ¼Ñ_Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ")
  let session_id = Baggage::get_entry(final_baggage, "Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€_ÑĞµÑÑĞ¸Ğ¸")
  
  assert_eq(username, Some("Ğ˜Ğ²Ğ°Ğ½_ĞŸĞµÑ‚Ñ€Ğ¾Ğ²"))
  assert_eq(session_id, Some("ÑĞµÑÑĞ¸Ñ_12345"))
}

test "emoji and special character handling" {
  let attrs = Attributes::new()
  
  // Test emoji in attribute values
  Attributes::set(attrs, "status", StringValue("âœ… æˆåŠŸ"))
  Attributes::set(attrs, "error", StringValue("âŒ å¤±è´¥"))
  Attributes::set(attrs, "warning", StringValue("âš ï¸ è­¦å‘Š"))
  Attributes::set(attrs, "performance", StringValue("ğŸ“Š æ€§èƒ½æŒ‡æ ‡"))
  
  let status = Attributes::get(attrs, "status")
  let error = Attributes::get(attrs, "error")
  let warning = Attributes::get(attrs, "warning")
  let performance = Attributes::get(attrs, "performance")
  
  assert_eq(status, Some(StringValue("âœ… æˆåŠŸ")))
  assert_eq(error, Some(StringValue("âŒ å¤±è´¥")))
  assert_eq(warning, Some(StringValue("âš ï¸ è­¦å‘Š")))
  assert_eq(performance, Some(StringValue("ğŸ“Š æ€§èƒ½æŒ‡æ ‡")))
}

test "mixed language text processing" {
  let provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(provider, "å¤šè¯­è¨€æ—¥å¿—è®°å½•å™¨")
  
  let record = LogRecord::new_with_context(
    Warn,
    Some("Mixed language log: ç”¨æˆ·ç™»å½•å¤±è´¥ - User login failed - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—"),
    None,
    Some(1735689600000000000L),
    None,
    Some("mixed-language-trace"),
    Some("mixed-language-span"),
    None
  )
  
  assert_eq(LogRecord::severity_number(record), Warn)
  assert_eq(LogRecord::body(record), Some("Mixed language log: ç”¨æˆ·ç™»å½•å¤±è´¥ - User login failed - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—"))
  assert_eq(LogRecord::trace_id(record), Some("mixed-language-trace"))
  assert_eq(LogRecord::span_id(record), Some("mixed-language-span"))
  
  Logger::emit(logger, record)
  assert_true(true)
}

test "right-to-left text handling" {
  let attrs = Attributes::new()
  
  // Test RTL text (Hebrew and Arabic)
  Attributes::set(attrs, "×¢×‘×¨×™×ª", StringValue("×©× ×”×©×™×¨×•×ª"))
  Attributes::set(attrs, "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", StringValue("Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©"))
  
  let hebrew = Attributes::get(attrs, "×¢×‘×¨×™×ª")
  let arabic = Attributes::get(attrs, "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©")
  
  assert_eq(hebrew, Some(StringValue("×©× ×”×©×™×¨×•×ª")))
  assert_eq(arabic, Some(StringValue("Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©")))
}

test "internationalized metric names and descriptions" {
  let provider = MeterProvider::default()
  let meter = MeterProvider::get_meter(provider, "å›½é™…åŒ–ä»ªè¡¨æ¿")
  
  let counter = Meter::create_counter(
    meter, 
    "http.è¯·æ±‚.æ€»æ•°", 
    Some("HTTPè¯·æ±‚æ€»æ•°è®¡æ•°å™¨"), 
    Some("è¯·æ±‚")
  )
  
  let histogram = Meter::create_histogram(
    meter,
    "å“åº”æ—¶é—´.åˆ†å¸ƒ",
    Some("å“åº”æ—¶é—´åˆ†å¸ƒç›´æ–¹å›¾"),
    Some("æ¯«ç§’")
  )
  
  assert_eq(counter.name, "http.è¯·æ±‚.æ€»æ•°")
  assert_eq(counter.description, Some("HTTPè¯·æ±‚æ€»æ•°è®¡æ•°å™¨"))
  assert_eq(counter.unit, Some("è¯·æ±‚"))
  
  assert_eq(histogram.name, "å“åº”æ—¶é—´.åˆ†å¸ƒ")
  assert_eq(histogram.description, Some("å“åº”æ—¶é—´åˆ†å¸ƒç›´æ–¹å›¾"))
  assert_eq(histogram.unit, Some("æ¯«ç§’"))
}

test "unicode normalization and comparison" {
  let attrs = Attributes::new()
  
  // Test different Unicode representations of the same text
  Attributes::set(attrs, "normalized1", StringValue("cafÃ©"))  // Using Ã©
  Attributes::set(attrs, "normalized2", StringValue("cafe\u0301"))  // Using e + combining acute accent
  
  let normalized1 = Attributes::get(attrs, "normalized1")
  let normalized2 = Attributes::get(attrs, "normalized2")
  
  // Note: In a real implementation, you might want to normalize Unicode before comparison
  // For this test, we just verify both values are stored as provided
  assert_eq(normalized1, Some(StringValue("cafÃ©")))
  assert_eq(normalized2, Some(StringValue("cafe\u0301")))
}

test "international text in context propagation" {
  let ctx = Context::root()
  let key = ContextKey::new("å›½é™…åŒ–é”®")
  let ctx_with_value = Context::with_value(ctx, key, "å›½é™…åŒ–å€¼")
  
  let retrieved_value = Context::get(ctx_with_value, key)
  assert_eq(retrieved_value, Some("å›½é™…åŒ–å€¼"))
  
  // Test with different languages
  let english_key = ContextKey::new("english.key")
  let ctx_english = Context::with_value(ctx, english_key, "English value")
  
  let chinese_key = ContextKey::new("ä¸­æ–‡é”®")
  let ctx_chinese = Context::with_value(ctx, chinese_key, "ä¸­æ–‡å€¼")
  
  let english_value = Context::get(ctx_english, english_key)
  let chinese_value = Context::get(ctx_chinese, chinese_key)
  
  assert_eq(english_value, Some("English value"))
  assert_eq(chinese_value, Some("ä¸­æ–‡å€¼"))
}