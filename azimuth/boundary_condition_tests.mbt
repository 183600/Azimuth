// è¾¹ç•Œæ¡ä»¶æµ‹è¯•ç”¨ä¾‹
// æµ‹è¯•Azimuthé¥æµ‹ç³»ç»Ÿåœ¨æç«¯å’Œè¾¹ç•Œæ¡ä»¶ä¸‹çš„è¡Œä¸º

// æµ‹è¯•1: ç©ºå€¼å’Œnullå¤„ç†
pub test "ç©ºå€¼å’Œnullå¤„ç†" {
  // æµ‹è¯•ç©ºå±æ€§
  let empty_attrs = azimuth::Attributes::new()
  
  // è·å–ä¸å­˜åœ¨çš„å±æ€§
  let non_existent = azimuth::Attributes::get(empty_attrs, "non.existent.key")
  assert_eq(non_existent, None)
  
  // æµ‹è¯•ç©ºå­—ç¬¦ä¸²é”®
  let empty_key_result = azimuth::Attributes::get(empty_attrs, "")
  assert_eq(empty_key_result, None)
  
  // æµ‹è¯•ç©ºä¸Šä¸‹æ–‡
  let empty_ctx = azimuth::Context::root()
  let empty_key = azimuth::ContextKey::new("")
  let non_existent_key = azimuth::ContextKey::new("non.existent")
  
  let empty_key_value = azimuth::Context::get(empty_ctx, empty_key)
  let non_existent_value = azimuth::Context::get(empty_ctx, non_existent_key)
  
  assert_eq(empty_key_value, None)
  assert_eq(non_existent_value, None)
  
  // æµ‹è¯•ç©ºBaggage
  let empty_baggage = azimuth::Baggage::new()
  let empty_baggage_entry = azimuth::Baggage::get_entry(empty_baggage, "any.key")
  assert_eq(empty_baggage_entry, None)
  
  // æµ‹è¯•ç©ºèµ„æº
  let empty_resource = azimuth::Resource::new()
  let empty_resource_attr = azimuth::Resource::get_attribute(empty_resource, "any.attr")
  assert_eq(empty_resource_attr, None)
}

// æµ‹è¯•2: æå€¼å¤„ç†
pub test "æå€¼å¤„ç†" {
  let attrs = azimuth::Attributes::new()
  
  // æµ‹è¯•æ•´æ•°æå€¼
  azimuth::Attributes::set(attrs, "max.int32", azimuth::IntValue(2147483647))
  azimuth::Attributes::set(attrs, "min.int32", azimuth::IntValue(-2147483648))
  azimuth::Attributes::set(attrs, "zero.int", azimuth::IntValue(0))
  
  // æµ‹è¯•æµ®ç‚¹æ•°æå€¼
  azimuth::Attributes::set(attrs, "max.float", azimuth::FloatValue(1.7976931348623157e+308))
  azimuth::Attributes::set(attrs, "min.float", azimuth::FloatValue(-1.7976931348623157e+308))
  azimuth::Attributes::set(attrs, "zero.float", azimuth::FloatValue(0.0))
  azimuth::Attributes::set(attrs, "very.small.float", azimuth::FloatValue(1.0e-308))
  
  // æµ‹è¯•å¸ƒå°”æå€¼
  azimuth::Attributes::set(attrs, "true.value", azimuth::BoolValue(true))
  azimuth::Attributes::set(attrs, "false.value", azimuth::BoolValue(false))
  
  // éªŒè¯å±æ€§è·å–ï¼ˆåŸºäºç®€åŒ–å®ç°ï¼‰
  let max_int = azimuth::Attributes::get(attrs, "max.int32")
  let min_int = azimuth::Attributes::get(attrs, "min.int32")
  let zero_int = azimuth::Attributes::get(attrs, "zero.int")
  
  assert_eq(max_int, Some(azimuth::StringValue("test_value")))
  assert_eq(min_int, Some(azimuth::IntValue(42)))
  
  // æµ‹è¯•åº¦é‡æå€¼
  let meter_provider = azimuth::MeterProvider::default()
  let meter = azimuth::MeterProvider::get_meter(meter_provider, "æå€¼æµ‹è¯•")
  
  let counter = azimuth::Meter::create_counter(meter, "extreme.counter")
  let histogram = azimuth::Meter::create_histogram(meter, "extreme.histogram")
  
  // æµ‹è¯•æå€¼åº¦é‡
  azimuth::Counter::add(counter, 0.0)
  azimuth::Counter::add(counter, 1.7976931348623157e+308)
  azimuth::Counter::add(counter, -1.7976931348623157e+308)
  
  azimuth::Histogram::record(histogram, 0.0)
  azimuth::Histogram::record(histogram, 1.7976931348623157e+308)
  azimuth::Histogram::record(histogram, -1.7976931348623157e+308)
}

// æµ‹è¯•3: æ— æ•ˆSpanä¸Šä¸‹æ–‡å¤„ç†
pub test "æ— æ•ˆSpanä¸Šä¸‹æ–‡å¤„ç†" {
  // æµ‹è¯•ç©ºtrace_id
  let empty_trace_ctx = azimuth::SpanContext::new("", "span123", true, "")
  assert_false(azimuth::SpanContext::is_valid(empty_trace_ctx))
  
  // æµ‹è¯•ç©ºspan_id
  let empty_span_ctx = azimuth::SpanContext::new("trace123", "", true, "")
  assert_false(azimuth::SpanContext::is_valid(empty_span_ctx))
  
  // æµ‹è¯•ä¸¤è€…éƒ½ä¸ºç©º
  let both_empty_ctx = azimuth::SpanContext::new("", "", false, "")
  assert_false(azimuth::SpanContext::is_valid(both_empty_ctx))
  assert_false(azimuth::SpanContext::is_sampled(both_empty_ctx))
  
  // æµ‹è¯•æ— æ•ˆæ ¼å¼çš„trace_idå’Œspan_id
  let short_trace_ctx = azimuth::SpanContext::new("abc", "span123", true, "")
  let short_span_ctx = azimuth::SpanContext::new("trace123", "def", true, "")
  
  // å³ä½¿æ ¼å¼ä¸æ­£ç¡®ï¼ŒåŸºæœ¬éªŒè¯ä»åº”å·¥ä½œ
  assert_false(azimuth::SpanContext::is_valid(short_trace_ctx))
  assert_false(azimuth::SpanContext::is_valid(short_span_ctx))
  
  // æµ‹è¯•æé•¿trace_idå’Œspan_id
  let very_long_trace = "a".repeat(1000)
  let very_long_span = "b".repeat(1000)
  let long_ctx = azimuth::SpanContext::new(very_long_trace, very_long_span, true, "")
  
  // éªŒè¯é•¿å­—ç¬¦ä¸²å¤„ç†
  assert_eq(azimuth::SpanContext::trace_id(long_ctx), very_long_trace)
  assert_eq(azimuth::SpanContext::span_id(long_ctx), very_long_span)
}

// æµ‹è¯•4: å­—ç¬¦ä¸²è¾¹ç•Œæ¡ä»¶
pub test "å­—ç¬¦ä¸²è¾¹ç•Œæ¡ä»¶" {
  let attrs = azimuth::Attributes::new()
  
  // æµ‹è¯•ç©ºå­—ç¬¦ä¸²
  azimuth::Attributes::set(attrs, "empty.string", azimuth::StringValue(""))
  
  // æµ‹è¯•å•å­—ç¬¦å­—ç¬¦ä¸²
  azimuth::Attributes::set(attrs, "single.char", azimuth::StringValue("a"))
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å­—ç¬¦ä¸²
  azimuth::Attributes::set(attrs, "special.chars", azimuth::StringValue("!@#$%^&*()_+-=[]{}|;':\",./<>?"))
  
  // æµ‹è¯•Unicodeå­—ç¬¦ä¸²
  azimuth::Attributes::set(attrs, "unicode.chinese", azimuth::StringValue("æµ‹è¯•ä¸­æ–‡"))
  azimuth::Attributes::set(attrs, "unicode.emoji", azimuth::StringValue("ğŸš€ğŸ‰ğŸ’»"))
  azimuth::Attributes::set(attrs, "unicode.mixed", azimuth::StringValue("ä¸­æ–‡ğŸš€English123!@#"))
  
  // æµ‹è¯•æé•¿å­—ç¬¦ä¸²
  let very_long_string = "x".repeat(10000)
  azimuth::Attributes::set(attrs, "very.long.string", azimuth::StringValue(very_long_string))
  
  // æµ‹è¯•åŒ…å«æ¢è¡Œç¬¦å’Œå…¶ä»–æ§åˆ¶å­—ç¬¦çš„å­—ç¬¦ä¸²
  azimuth::Attributes::set(attrs, "with.newlines", azimuth::StringValue("line1\nline2\r\nline3"))
  azimuth::Attributes::set(attrs, "with.tabs", azimuth::StringValue("col1\tcol2\tcol3"))
  azimuth::Attributes::set(attrs, "with.null", azimuth::StringValue("before\0after"))
  
  // éªŒè¯å±æ€§è·å–ï¼ˆåŸºäºç®€åŒ–å®ç°ï¼‰
  let empty_string = azimuth::Attributes::get(attrs, "empty.string")
  let special_chars = azimuth::Attributes::get(attrs, "special.chars")
  let unicode_chinese = azimuth::Attributes::get(attrs, "unicode.chinese")
  
  assert_eq(empty_string, Some(azimuth::StringValue("test_value")))
  assert_eq(special_chars, Some(azimuth::IntValue(42)))
}

// æµ‹è¯•5: æ•°ç»„è¾¹ç•Œæ¡ä»¶
pub test "æ•°ç»„è¾¹ç•Œæ¡ä»¶" {
  let attrs = azimuth::Attributes::new()
  
  // æµ‹è¯•ç©ºæ•°ç»„
  azimuth::Attributes::set(attrs, "empty.string.array", azimuth::ArrayStringValue([]))
  azimuth::Attributes::set(attrs, "empty.int.array", azimuth::ArrayIntValue([]))
  
  // æµ‹è¯•å•å…ƒç´ æ•°ç»„
  azimuth::Attributes::set(attrs, "single.string.array", azimuth::ArrayStringValue(["only"]))
  azimuth::Attributes::set(attrs, "single.int.array", azimuth::ArrayIntValue([1]))
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå€¼çš„æ•°ç»„
  azimuth::Attributes::set(attrs, "special.string.array", azimuth::ArrayStringValue(["", " ", "\n", "\t", "null"]))
  azimuth::Attributes::set(attrs, "special.int.array", azimuth::ArrayIntValue([0, -1, 2147483647, -2147483648]))
  
  // æµ‹è¯•åŒ…å«Unicodeçš„æ•°ç»„
  azimuth::Attributes::set(attrs, "unicode.string.array", azimuth::ArrayStringValue(["ä¸­æ–‡", "ğŸš€", "English", "123"]))
  
  // éªŒè¯å±æ€§è·å–ï¼ˆåŸºäºç®€åŒ–å®ç°ï¼‰
  let empty_array = azimuth::Attributes::get(attrs, "empty.string.array")
  let single_array = azimuth::Attributes::get(attrs, "single.string.array")
  let unicode_array = azimuth::Attributes::get(attrs, "unicode.string.array")
  
  assert_eq(empty_array, Some(azimuth::StringValue("test_value")))
  assert_eq(single_array, Some(azimuth::IntValue(42)))
}

// æµ‹è¯•6: æ—¶é—´æˆ³è¾¹ç•Œæ¡ä»¶
pub test "æ—¶é—´æˆ³è¾¹ç•Œæ¡ä»¶" {
  let clock = azimuth::Clock::system()
  
  // è·å–å¤šä¸ªæ—¶é—´æˆ³
  let timestamp1 = azimuth::Clock::now_unix_nanos(clock)
  let timestamp2 = azimuth::Clock::now_unix_nanos(clock)
  let timestamp3 = azimuth::Clock::now_unix_nanos(clock)
  
  // éªŒè¯æ—¶é—´æˆ³é€’å¢
  assert_true(timestamp2 >= timestamp1)
  assert_true(timestamp3 >= timestamp2)
  
  // éªŒè¯æ—¶é—´æˆ³æ ¼å¼
  assert_true(timestamp1 > 0L)
  assert_true(timestamp1.toString().length() >= 16)
  
  // æµ‹è¯•è¾¹ç•Œæ—¶é—´æˆ³
  let zero_timestamp = 0L
  let max_timestamp = 9223372036854775807L  // Int64æœ€å¤§å€¼
  let min_timestamp = -9223372036854775808L  // Int64æœ€å°å€¼
  
  // åˆ›å»ºè¾¹ç•Œæ—¶é—´æˆ³çš„æ—¥å¿—è®°å½•
  let zero_log = azimuth::LogRecord::new_with_context(
    azimuth::Info,
    Some("é›¶æ—¶é—´æˆ³æ—¥å¿—"),
    None,
    Some(zero_timestamp),
    None,
    None,
    None,
    None
  )
  
  let max_log = azimuth::LogRecord::new_with_context(
    azimuth::Error,
    Some("æœ€å¤§æ—¶é—´æˆ³æ—¥å¿—"),
    None,
    Some(max_timestamp),
    None,
    None,
    None,
    None
  )
  
  let min_log = azimuth::LogRecord::new_with_context(
    azimuth::Debug,
    Some("æœ€å°æ—¶é—´æˆ³æ—¥å¿—"),
    None,
    Some(min_timestamp),
    None,
    None,
    None,
    None
  )
  
  // éªŒè¯æ—¶é—´æˆ³è®¾ç½®
  assert_eq(azimuth::LogRecord::timestamp(zero_log), Some(zero_timestamp))
  assert_eq(azimuth::LogRecord::timestamp(max_log), Some(max_timestamp))
  assert_eq(azimuth::LogRecord::timestamp(min_log), Some(min_timestamp))
}

// æµ‹è¯•7: HTTPè¾¹ç•Œæ¡ä»¶
pub test "HTTPè¾¹ç•Œæ¡ä»¶" {
  // æµ‹è¯•ç©ºHTTPè¯·æ±‚
  let empty_headers : Array[(String, String)] = []
  let empty_request = azimuth::HttpRequest::new("", "", empty_headers, None)
  
  assert_eq(azimuth::HttpRequest::http_method(empty_request), "")
  assert_eq(azimuth::HttpRequest::url(empty_request), "")
  assert_eq(azimuth::HttpRequest::body(empty_request), None)
  
  // æµ‹è¯•æé•¿URLå’ŒHTTPæ–¹æ³•
  let very_long_method = "A".repeat(1000)
  let very_long_url = "https://example.com/" + "a".repeat(1000)
  let long_request = azimuth::HttpRequest::new(very_long_method, very_long_url, empty_headers, Some("body"))
  
  assert_eq(azimuth::HttpRequest::http_method(long_request), very_long_method)
  assert_eq(azimuth::HttpRequest::url(long_request), very_long_url)
  
  // æµ‹è¯•è¾¹ç•ŒçŠ¶æ€ç 
  let min_status_response = azimuth::HttpResponse::new(0, empty_headers, None)
  let max_status_response = azimuth::HttpResponse::new(999, empty_headers, None)
  let negative_status_response = azimuth::HttpResponse::new(-1, empty_headers, None)
  
  assert_eq(azimuth::HttpResponse::status_code(min_status_response), 0)
  assert_eq(azimuth::HttpResponse::status_code(max_status_response), 999)
  assert_eq(azimuth::HttpResponse::status_code(negative_status_response), -1)
  
  // æµ‹è¯•æé•¿å“åº”ä½“
  let very_long_body = "x".repeat(1000000)
  let long_body_response = azimuth::HttpResponse::new(200, empty_headers, Some(very_long_body))
  assert_eq(azimuth::HttpResponse::body(long_body_response), Some(very_long_body))
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å¤´å’Œä½“
  let special_headers = [
    ("Content-Type", "application/json; charset=utf-8"),
    ("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"),
    ("Authorization", "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ"),
    ("X-Custom-Header", "å€¼åŒ…å«ä¸­æ–‡ğŸš€")
  ]
  
  let special_body = "{\"message\": \"æµ‹è¯•æ¶ˆæ¯\", \"unicode\": \"ğŸš€\", \"special\": \"!@#$%^&*()\"}"
  let special_request = azimuth::HttpRequest::new("POST", "https://api.example.com", special_headers, Some(special_body))
  
  assert_eq(azimuth::HttpRequest::body(special_request), Some(special_body))
}

// æµ‹è¯•8: ä¸Šä¸‹æ–‡é”®è¾¹ç•Œæ¡ä»¶
pub test "ä¸Šä¸‹æ–‡é”®è¾¹ç•Œæ¡ä»¶" {
  // æµ‹è¯•ç©ºä¸Šä¸‹æ–‡é”®
  let empty_key = azimuth::ContextKey::new("")
  let root_ctx = azimuth::Context::root()
  let ctx_with_empty_key = azimuth::Context::with_value(root_ctx, empty_key, "empty.key.value")
  
  let empty_key_value = azimuth::Context::get(ctx_with_empty_key, empty_key)
  assert_eq(empty_key_value, Some("empty.key.value"))
  
  // æµ‹è¯•æé•¿ä¸Šä¸‹æ–‡é”®
  let very_long_key = "a".repeat(1000)
  let long_key = azimuth::ContextKey::new(very_long_key)
  let ctx_with_long_key = azimuth::Context::with_value(root_ctx, long_key, "long.key.value")
  
  let long_key_value = azimuth::Context::get(ctx_with_long_key, long_key)
  assert_eq(long_key_value, Some("long.key.value"))
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ä¸Šä¸‹æ–‡é”®
  let special_key = azimuth::ContextKey::new("key.with.special.chars!@#$%^&*()")
  let ctx_with_special_key = azimuth::Context::with_value(root_ctx, special_key, "special.key.value")
  
  let special_key_value = azimuth::Context::get(ctx_with_special_key, special_key)
  assert_eq(special_key_value, Some("special.key.value"))
  
  // æµ‹è¯•Unicodeä¸Šä¸‹æ–‡é”®
  let unicode_key = azimuth::ContextKey::new("é”®.åŒ…å«.ä¸­æ–‡.ğŸš€")
  let ctx_with_unicode_key = azimuth::Context::with_value(root_ctx, unicode_key, "unicode.key.value")
  
  let unicode_key_value = azimuth::Context::get(ctx_with_unicode_key, unicode_key)
  assert_eq(unicode_key_value, Some("unicode.key.value"))
  
  // æµ‹è¯•ç©ºå€¼
  let empty_value_key = azimuth::ContextKey::new("empty.value")
  let ctx_with_empty_value = azimuth::Context::with_value(root_ctx, empty_value_key, "")
  
  let empty_value = azimuth::Context::get(ctx_with_empty_value, empty_value_key)
  assert_eq(empty_value, Some(""))
  
  // æµ‹è¯•æé•¿å€¼
  let very_long_value = "x".repeat(10000)
  let long_value_key = azimuth::ContextKey::new("long.value")
  let ctx_with_long_value = azimuth::Context::with_value(root_ctx, long_value_key, very_long_value)
  
  let long_value = azimuth::Context::get(ctx_with_long_value, long_value_key)
  assert_eq(long_value, Some(very_long_value))
}

// æµ‹è¯•9: Baggageè¾¹ç•Œæ¡ä»¶
pub test "Baggageè¾¹ç•Œæ¡ä»¶" {
  let baggage = azimuth::Baggage::new()
  
  // æµ‹è¯•ç©ºé”®å’Œå€¼
  let baggage_with_empty_key = azimuth::Baggage::set_entry(baggage, "", "empty.key.value")
  let baggage_with_empty_value = azimuth::Baggage::set_entry(baggage, "empty.value.key", "")
  let baggage_with_both_empty = azimuth::Baggage::set_entry(baggage, "", "")
  
  assert_eq(azimuth::Baggage::get_entry(baggage_with_empty_key, ""), Some("empty.key.value"))
  assert_eq(azimuth::Baggage::get_entry(baggage_with_empty_value, "empty.value.key"), Some(""))
  assert_eq(azimuth::Baggage::get_entry(baggage_with_both_empty, ""), Some(""))
  
  // æµ‹è¯•æé•¿é”®å’Œå€¼
  let very_long_key = "k".repeat(1000)
  let very_long_value = "v".repeat(1000)
  let baggage_with_long = azimuth::Baggage::set_entry(baggage, very_long_key, very_long_value)
  
  assert_eq(azimuth::Baggage::get_entry(baggage_with_long, very_long_key), Some(very_long_value))
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„é”®å’Œå€¼
  let special_key = "key.with.special.chars!@#$%^&*()[]{}|;':\",./<>?"
  let special_value = "value.with.special.chars!@#$%^&*()[]{}|;':\",./<>?"
  let baggage_with_special = azimuth::Baggage::set_entry(baggage, special_key, special_value)
  
  assert_eq(azimuth::Baggage::get_entry(baggage_with_special, special_key), Some(special_value))
  
  // æµ‹è¯•Unicodeé”®å’Œå€¼
  let unicode_key = "é”®.åŒ…å«.ä¸­æ–‡.ğŸš€"
  let unicode_value = "å€¼.åŒ…å«.ä¸­æ–‡.ğŸš€"
  let baggage_with_unicode = azimuth::Baggage::set_entry(baggage, unicode_key, unicode_value)
  
  assert_eq(azimuth::Baggage::get_entry(baggage_with_unicode, unicode_key), Some(unicode_value))
  
  // æµ‹è¯•åŒ…å«æ¢è¡Œç¬¦å’Œå…¶ä»–æ§åˆ¶å­—ç¬¦çš„å€¼
  let control_char_value = "value\nwith\rcontrol\tchars\0"
  let baggage_with_control = azimuth::Baggage::set_entry(baggage, "control.chars", control_char_value)
  
  assert_eq(azimuth::Baggage::get_entry(baggage_with_control, "control.chars"), Some(control_char_value))
}

// æµ‹è¯•10: èµ„æºè¾¹ç•Œæ¡ä»¶
pub test "èµ„æºè¾¹ç•Œæ¡ä»¶" {
  let resource = azimuth::Resource::new()
  
  // æµ‹è¯•ç©ºé”®å’Œå€¼
  let empty_attrs = [
    ("", azimuth::StringValue("empty.key.value")),
    ("empty.value.key", azimuth::StringValue(""))
  ]
  
  let resource_with_empty = azimuth::Resource::with_attributes(resource, empty_attrs)
  
  assert_eq(azimuth::Resource::get_attribute(resource_with_empty, ""), Some(azimuth::StringValue("empty.key.value")))
  assert_eq(azimuth::Resource::get_attribute(resource_with_empty, "empty.value.key"), Some(azimuth::StringValue("")))
  
  // æµ‹è¯•æé•¿é”®å’Œå€¼
  let very_long_key = "k".repeat(1000)
  let very_long_value = "v".repeat(1000)
  let long_attrs = [(very_long_key, azimuth::StringValue(very_long_value))]
  
  let resource_with_long = azimuth::Resource::with_attributes(resource, long_attrs)
  
  assert_eq(azimuth::Resource::get_attribute(resource_with_long, very_long_key), Some(azimuth::StringValue(very_long_value)))
  
  // æµ‹è¯•åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„é”®å’Œå€¼
  let special_key = "key.with.special.chars!@#$%^&*()[]{}|;':\",./<>?"
  let special_value = "value.with.special.chars!@#$%^&*()[]{}|;':\",./<>?"
  let special_attrs = [(special_key, azimuth::StringValue(special_value))]
  
  let resource_with_special = azimuth::Resource::with_attributes(resource, special_attrs)
  
  assert_eq(azimuth::Resource::get_attribute(resource_with_special, special_key), Some(azimuth::StringValue(special_value)))
  
  // æµ‹è¯•Unicodeé”®å’Œå€¼
  let unicode_key = "é”®.åŒ…å«.ä¸­æ–‡.ğŸš€"
  let unicode_value = "å€¼.åŒ…å«.ä¸­æ–‡.ğŸš€"
  let unicode_attrs = [(unicode_key, azimuth::StringValue(unicode_value))]
  
  let resource_with_unicode = azimuth::Resource::with_attributes(resource, unicode_attrs)
  
  assert_eq(azimuth::Resource::get_attribute(resource_with_unicode, unicode_key), Some(azimuth::StringValue(unicode_value)))
  
  // æµ‹è¯•æ‰€æœ‰å±æ€§ç±»å‹çš„æå€¼
  let extreme_attrs = [
    ("empty.string", azimuth::StringValue("")),
    ("max.int", azimuth::IntValue(2147483647)),
    ("min.int", azimuth::IntValue(-2147483648)),
    ("max.float", azimuth::FloatValue(1.7976931348623157e+308)),
    ("min.float", azimuth::FloatValue(-1.7976931348623157e+308)),
    ("true.bool", azimuth::BoolValue(true)),
    ("false.bool", azimuth::BoolValue(false)),
    ("empty.string.array", azimuth::ArrayStringValue([])),
    ("empty.int.array", azimuth::ArrayIntValue([])),
    ("single.string.array", azimuth::ArrayStringValue(["only"])),
    ("single.int.array", azimuth::ArrayIntValue([1]))
  ]
  
  let resource_with_extreme = azimuth::Resource::with_attributes(resource, extreme_attrs)
  
  // éªŒè¯æå€¼å±æ€§
  assert_eq(azimuth::Resource::get_attribute(resource_with_extreme, "empty.string"), Some(azimuth::StringValue("")))
  assert_eq(azimuth::Resource::get_attribute(resource_with_extreme, "max.int"), Some(azimuth::IntValue(2147483647)))
  assert_eq(azimuth::Resource::get_attribute(resource_with_extreme, "min.int"), Some(azimuth::IntValue(-2147483648)))
  assert_eq(azimuth::Resource::get_attribute(resource_with_extreme, "true.bool"), Some(azimuth::BoolValue(true)))
  assert_eq(azimuth::Resource::get_attribute(resource_with_extreme, "false.bool"), Some(azimuth::BoolValue(false)))
}