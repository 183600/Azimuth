#!/bin/bash

# 简单的测试脚本
echo "Running tests..."

# 检查测试目录
if [ ! -d "test" ]; then
  echo "No test directory found"
  exit 1
fi

# 进入测试目录
cd test

# 检查测试文件
if [ -f "simple_test.mbt" ]; then
  echo "Checking simple_test.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test simple_test.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "simple_test.mbt ... ok"
  else
    echo "simple_test.mbt ... failed"
  fi
fi

if [ -f "additional_comprehensive_tests.mbt" ]; then
  echo "Checking additional_comprehensive_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test additional_comprehensive_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "additional_comprehensive_tests.mbt ... ok"
  else
    echo "additional_comprehensive_tests.mbt ... failed"
  fi
fi

if [ -f "extended_tests.mbt" ]; then
  echo "Checking extended_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test extended_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "extended_tests.mbt ... ok"
  else
    echo "extended_tests.mbt ... failed"
  fi
fi

if [ -f "enhanced_boundary_tests.mbt" ]; then
  echo "Checking enhanced_boundary_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test enhanced_boundary_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "enhanced_boundary_tests.mbt ... ok"
  else
    echo "enhanced_boundary_tests.mbt ... failed"
  fi
fi

if [ -f "new_moonbit_tests.mbt" ]; then
  echo "Checking new_moonbit_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test new_moonbit_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "new_moonbit_tests.mbt ... ok"
  else
    echo "new_moonbit_tests.mbt ... failed"
  fi
fi

if [ -f "moonbit_standard_tests.mbt" ]; then
  echo "Checking moonbit_standard_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test moonbit_standard_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "moonbit_standard_tests.mbt ... ok"
  else
    echo "moonbit_standard_tests.mbt ... failed"
  fi
fi

if [ -f "moonbit_test_cases.mbt" ]; then
  echo "Checking moonbit_test_cases.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test moonbit_test_cases.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "moonbit_test_cases.mbt ... ok"
  else
    echo "moonbit_test_cases.mbt ... failed"
  fi
fi

if [ -f "my_additional_tests.mbt" ]; then
  echo "Checking my_additional_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test my_additional_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "my_additional_tests.mbt ... ok"
  else
    echo "my_additional_tests.mbt ... failed"
  fi
fi

if [ -f "standard_moonbit_tests.mbt" ]; then
  echo "Checking standard_moonbit_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test standard_moonbit_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "standard_moonbit_tests.mbt ... ok"
  else
    echo "standard_moonbit_tests.mbt ... failed"
  fi
fi

if [ -f "standard_moonbit_test_cases.mbt" ]; then
  echo "Checking standard_moonbit_test_cases.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test standard_moonbit_test_cases.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "standard_moonbit_test_cases.mbt ... ok"
  else
    echo "standard_moonbit_test_cases.mbt ... failed"
  fi
fi

if [ -f "azimuth_standard_tests.mbt" ]; then
  echo "Checking azimuth_standard_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test azimuth_standard_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "azimuth_standard_tests.mbt ... ok"
  else
    echo "azimuth_standard_tests.mbt ... failed"
  fi
fi

if [ -f "azimuth_new_test_suite.mbt" ]; then
  echo "Checking azimuth_new_test_suite.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test azimuth_new_test_suite.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "azimuth_new_test_suite.mbt ... ok"
  else
    echo "azimuth_new_test_suite.mbt ... failed"
  fi
fi

if [ -f "standard_azimuth_tests.mbt" ]; then
  echo "Checking standard_azimuth_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test standard_azimuth_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "standard_azimuth_tests.mbt ... ok"
  else
    echo "standard_azimuth_tests.mbt ... failed"
  fi
fi

if [ -f "standard_comprehensive_tests.mbt" ]; then
  echo "Checking standard_comprehensive_tests.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test standard_comprehensive_tests.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "standard_comprehensive_tests.mbt ... ok"
  else
    echo "standard_comprehensive_tests.mbt ... failed"
  fi
fi

if [ -f "azimuth_enhanced_test_cases.mbt" ]; then
  echo "Checking azimuth_enhanced_test_cases.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test azimuth_enhanced_test_cases.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "azimuth_enhanced_test_cases.mbt ... ok"
  else
    echo "azimuth_enhanced_test_cases.mbt ... failed"
  fi
fi

if [ -f "azimuth_standard_test_suite.mbt" ]; then
  echo "Checking azimuth_standard_test_suite.mbt..."
  # 使用 moonc.js 检查测试文件
  node ../moonc.js check -pkg "$(basename $(pwd))" -std-path "../../core" -blackbox-test azimuth_standard_test_suite.mbt -i ../azimuth.mi
  if [ $? -eq 0 ]; then
    echo "azimuth_standard_test_suite.mbt ... ok"
  else
    echo "azimuth_standard_test_suite.mbt ... failed"
  fi
fi

echo "Tests completed"