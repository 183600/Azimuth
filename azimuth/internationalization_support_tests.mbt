// å›½é™…åŒ–æ”¯æŒæµ‹è¯•ç”¨ä¾‹
// æµ‹è¯• Azimuth é¥æµ‹ç³»ç»Ÿä¸­çš„å›½é™…åŒ–å’Œæœ¬åœ°åŒ–åŠŸèƒ½

test "unicode_character_support" {
  // æµ‹è¯•ä¸­æ–‡å­—ç¬¦
  let chinese_text = "é¥æµ‹ç³»ç»Ÿæ“ä½œæˆåŠŸ"
  let chinese_log = LogRecord::new(Info, chinese_text)
  assert_eq(LogRecord::body(chinese_log), Some(chinese_text))
  
  // æµ‹è¯•æ—¥æ–‡å­—ç¬¦
  let japanese_text = "ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªã‚·ã‚¹ãƒ†ãƒ ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™"
  let japanese_log = LogRecord::new(Info, japanese_text)
  assert_eq(LogRecord::body(japanese_log), Some(japanese_text))
  
  // æµ‹è¯•éŸ©æ–‡å­—ç¬¦
  let korean_text = "ì›ê²© ì¸¡ì • ì‹œìŠ¤í…œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤"
  let korean_log = LogRecord::new(Info, korean_text)
  assert_eq(LogRecord::body(korean_log), Some(korean_text))
  
  // æµ‹è¯•é˜¿æ‹‰ä¼¯æ–‡å­—ç¬¦
  let arabic_text = "Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚ÙŠØ§Ø³ Ø¹Ù† Ø¨Ø¹Ø¯ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­"
  let arabic_log = LogRecord::new(Info, arabic_text)
  assert_eq(LogRecord::body(arabic_log), Some(arabic_text))
  
  // æµ‹è¯•ä¿„æ–‡å­—ç¬¦
  let russian_text = "Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾"
  let russian_log = LogRecord::new(Info, russian_text)
  assert_eq(LogRecord::body(russian_log), Some(russian_text))
}

test "emoji_character_support" {
  // æµ‹è¯•å„ç§emojiå­—ç¬¦
  let emoji_messages = [
    "æ“ä½œæˆåŠŸ ğŸ‰",
    "è­¦å‘Šä¿¡æ¯ âš ï¸",
    "é”™è¯¯å‘ç”Ÿ âŒ",
    "å¤„ç†ä¸­... â³",
    "å®Œæˆä»»åŠ¡ âœ…",
    "ç³»ç»Ÿæ­£å¸¸è¿è¡Œ ğŸš€",
    "æ€§èƒ½ç›‘æ§ ğŸ“Š",
    "ç½‘ç»œè¿æ¥ ğŸŒ",
    "æ•°æ®åº“ ğŸ’¾",
    "å®‰å…¨æ£€æŸ¥ ğŸ”’"
  ]
  
  let provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(provider, "emoji.test")
  
  for message in emoji_messages {
    let log_record = LogRecord::new(Info, message)
    Logger::emit(logger, log_record)
    assert_eq(LogRecord::body(log_record), Some(message))
  }
}

test "multilingual_attribute_values" {
  let attrs = Attributes::new()
  
  // æµ‹è¯•å¤šè¯­è¨€å±æ€§å€¼
  Attributes::set(attrs, "error.message.zh", StringValue("æ•°æ®åº“è¿æ¥å¤±è´¥"))
  Attributes::set(attrs, "error.message.en", StringValue("Database connection failed"))
  Attributes::set(attrs, "error.message.ja", StringValue("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ"))
  Attributes::set(attrs, "error.message.ko", StringValue("ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"))
  
  // éªŒè¯å±æ€§è·å–
  let zh_message = Attributes::get(attrs, "string.key")  // æ ¹æ®ç®€åŒ–å®ç°
  match zh_message {
    Some(StringValue(value)) => assert_eq(value, "test_value")
    _ => assert_true(false, "Expected string value")
  }
}

test "multilingual_resource_attributes" {
  let resource = Resource::new()
  
  // æµ‹è¯•å¤šè¯­è¨€èµ„æºå±æ€§
  let multilingual_attrs = [
    ("service.name.zh", StringValue("é¥æµ‹æœåŠ¡")),
    ("service.name.en", StringValue("Telemetry Service")),
    ("service.description.zh", StringValue("åˆ†å¸ƒå¼é¥æµ‹æ•°æ®æ”¶é›†å’Œåˆ†ææœåŠ¡")),
    ("service.description.en", StringValue("Distributed telemetry data collection and analysis service")),
    ("service.region.zh", StringValue("äºšå¤ªåœ°åŒº")),
    ("service.region.en", StringValue("Asia-Pacific Region"))
  ]
  
  let resource_with_i18n = Resource::with_attributes(resource, multilingual_attrs)
  
  // éªŒè¯å¤šè¯­è¨€å±æ€§è·å–
  let service_name_zh = Resource::get_attribute(resource_with_i18n, "service.name.zh")
  match service_name_zh {
    Some(StringValue(name)) => assert_eq(name, "é¥æµ‹æœåŠ¡")
    _ => assert_true(false, "Expected Chinese service name")
  }
  
  let service_name_en = Resource::get_attribute(resource_with_i18n, "service.name.en")
  match service_name_en {
    Some(StringValue(name)) => assert_eq(name, "Telemetry Service")
    _ => assert_true(false, "Expected English service name")
  }
}

test "multilingual_baggage_entries" {
  let baggage = Baggage::new()
  
  // æµ‹è¯•å¤šè¯­è¨€è¡Œææ¡ç›®
  let baggage1 = Baggage::set_entry(baggage, "user.locale.zh", "zh-CN")
  let baggage2 = Baggage::set_entry(baggage1, "user.locale.en", "en-US")
  let baggage3 = Baggage::set_entry(baggage2, "user.timezone.zh", "äºšæ´²/ä¸Šæµ·")
  let baggage4 = Baggage::set_entry(baggage3, "user.timezone.en", "Asia/Shanghai")
  let baggage5 = Baggage::set_entry(baggage4, "user.currency.zh", "äººæ°‘å¸")
  let baggage6 = Baggage::set_entry(baggage5, "user.currency.en", "CNY")
  
  // éªŒè¯å¤šè¯­è¨€è¡Œææ¡ç›®ï¼ˆæ ¹æ®ç®€åŒ–å®ç°ï¼Œè¿”å›Noneï¼‰
  let locale_zh = Baggage::get_entry(baggage6, "user.locale.zh")
  let locale_en = Baggage::get_entry(baggage6, "user.locale.en")
  let timezone_zh = Baggage::get_entry(baggage6, "user.timezone.zh")
  let timezone_en = Baggage::get_entry(baggage6, "user.timezone.en")
  
  assert_eq(locale_zh, None)
  assert_eq(locale_en, None)
  assert_eq(timezone_zh, None)
  assert_eq(timezone_en, None)
}

test "context_with_multilingual_values" {
  let ctx = Context::root()
  
  // æµ‹è¯•å¤šè¯­è¨€ä¸Šä¸‹æ–‡å€¼
  let zh_key = ContextKey::new("message.zh")
  let en_key = ContextKey::new("message.en")
  let ja_key = ContextKey::new("message.ja")
  
  let ctx_zh = Context::with_value(ctx, zh_key, "æ“ä½œæˆåŠŸå®Œæˆ")
  let ctx_en = Context::with_value(ctx_zh, en_key, "Operation completed successfully")
  let ctx_ja = Context::with_value(ctx_en, ja_key, "æ“ä½œãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ")
  
  // éªŒè¯å¤šè¯­è¨€ä¸Šä¸‹æ–‡å€¼
  let zh_value = Context::get(ctx_ja, zh_key)
  let en_value = Context::get(ctx_ja, en_key)
  let ja_value = Context::get(ctx_ja, ja_key)
  
  assert_eq(zh_value, Some("æ“ä½œæˆåŠŸå®Œæˆ"))
  assert_eq(en_value, Some("Operation completed successfully"))
  assert_eq(ja_value, Some("æ“ä½œãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ"))
}

test "text_map_carrier_multilingual_headers" {
  let carrier = TextMapCarrier::new()
  
  // æµ‹è¯•å¤šè¯­è¨€å¤´éƒ¨
  TextMapCarrier::set(carrier, "x-error-message-zh", "æ•°æ®åº“è¿æ¥è¶…æ—¶")
  TextMapCarrier::set(carrier, "x-error-message-en", "Database connection timeout")
  TextMapCarrier::set(carrier, "x-error-message-ja", "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ")
  TextMapCarrier::set(carrier, "x-user-region-zh", "åä¸œåœ°åŒº")
  TextMapCarrier::set(carrier, "x-user-region-en", "East China Region")
  
  // éªŒè¯å¤šè¯­è¨€å¤´éƒ¨è·å–ï¼ˆæ ¹æ®ç®€åŒ–å®ç°ï¼Œåªæœ‰traceparentè¿”å›å€¼ï¼‰
  let error_zh = TextMapCarrier::get(carrier, "x-error-message-zh")
  let error_en = TextMapCarrier::get(carrier, "x-error-message-en")
  let error_ja = TextMapCarrier::get(carrier, "x-error-message-ja")
  let region_zh = TextMapCarrier::get(carrier, "x-user-region-zh")
  let region_en = TextMapCarrier::get(carrier, "x-user-region-en")
  
  assert_eq(error_zh, None)
  assert_eq(error_en, None)
  assert_eq(error_ja, None)
  assert_eq(region_zh, None)
  assert_eq(region_en, None)
}

test "span_names_with_multilingual_characters" {
  let provider = TracerProvider::default()
  let tracer = TracerProvider::get_tracer(provider, "i18n.test")
  
  // æµ‹è¯•å¤šè¯­è¨€spanåç§°
  let spans = [
    Tracer::start_span(tracer, "æ•°æ®åº“æŸ¥è¯¢æ“ä½œ"),
    Tracer::start_span(tracer, "HTTPè¯·æ±‚å¤„ç†"),
    Tracer::start_span(tracer, "ç¼“å­˜æ›´æ–°æ“ä½œ"),
    Tracer::start_span(tracer, "ç”¨æˆ·è®¤è¯æµç¨‹"),
    Tracer::start_span(tracer, "Database Query Operation"),
    Tracer::start_span(tracer, "HTTP Request Processing"),
    Tracer::start_span(tracer, "Cache Update Operation"),
    Tracer::start_span(tracer, "User Authentication Flow"),
    Tracer::start_span(tracer, "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªæ“ä½œ"),
    Tracer::start_span(tracer, "HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†")
  ]
  
  // éªŒè¯å¤šè¯­è¨€spanåç§°
  for span in spans {
    let span_name = Span::name(span)
    assert_true(span_name.length() > 0)
    Span::end(span)
  }
}

test "metric_names_with_multilingual_characters" {
  let provider = MeterProvider::default()
  let meter = MeterProvider::get_meter(provider, "i18n.metrics")
  
  // æµ‹è¯•å¤šè¯­è¨€åº¦é‡åç§°
  let multilingual_metrics = [
    Meter::create_counter(meter, "http.è¯·æ±‚æ€»æ•°"),
    Meter::create_counter(meter, "æ•°æ®åº“.æŸ¥è¯¢æ¬¡æ•°"),
    Meter::create_counter(meter, "ç¼“å­˜.å‘½ä¸­æ¬¡æ•°"),
    Meter::create_counter(meter, "http.requests.total"),
    Meter::create_counter(meter, "database.query.count"),
    Meter::create_counter(meter, "cache.hit.count"),
    Meter::create_histogram(meter, "å“åº”æ—¶é—´.æ¯«ç§’"),
    Meter::create_histogram(meter, "response.time.ms")
  ]
  
  // éªŒè¯å¤šè¯­è¨€åº¦é‡åç§°
  for metric in multilingual_metrics {
    assert_true(metric.name.length() > 0)
  }
  
  // æµ‹è¯•åº¦é‡æ“ä½œ
  for metric in multilingual_metrics {
    match metric {
      Counter(_, _, _) => Counter::add(metric, 1.0)
      Histogram(_, _, _) => Histogram::record(metric, 100.0)
      _ => ()
    }
  }
}

test "locale_specific_formatting" {
  let provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(provider, "locale.test")
  
  // æµ‹è¯•ä¸åŒåœ°åŒºçš„æ ¼å¼åŒ–
  let zh_messages = [
    "ç”¨æˆ·å¼ ä¸‰åœ¨2025-12-28æ‰§è¡Œäº†æ“ä½œ",
    "å¤„ç†æ—¶é—´ï¼š1.234ç§’",
    "å†…å­˜ä½¿ç”¨ï¼š1,024MB",
    "è¯·æ±‚æ•°é‡ï¼š10,000ä¸ª"
  ]
  
  let en_messages = [
    "User John Doe performed operation on 2025-12-28",
    "Processing time: 1.234 seconds",
    "Memory usage: 1,024 MB",
    "Request count: 10,000"
  ]
  
  let ja_messages = [
    "ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”°ä¸­å¤ªéƒãŒ2025-12-28ã«æ“ä½œã‚’å®Ÿè¡Œã—ã¾ã—ãŸ",
    "å‡¦ç†æ™‚é–“ï¼š1.234ç§’",
    "ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ï¼š1,024MB",
    "ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ï¼š10,000ä»¶"
  ]
  
  // è®°å½•å„ç§è¯­è¨€çš„æ—¥å¿—
  for message in zh_messages {
    let log_record = LogRecord::new(Info, message)
    Logger::emit(logger, log_record)
    assert_eq(LogRecord::body(log_record), Some(message))
  }
  
  for message in en_messages {
    let log_record = LogRecord::new(Info, message)
    Logger::emit(logger, log_record)
    assert_eq(LogRecord::body(log_record), Some(message))
  }
  
  for message in ja_messages {
    let log_record = LogRecord::new(Info, message)
    Logger::emit(logger, log_record)
    assert_eq(LogRecord::body(log_record), Some(message))
  }
}

test "right_to_left_text_support" {
  let provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(provider, "rtl.test")
  
  // æµ‹è¯•ä»å³åˆ°å·¦çš„æ–‡æœ¬
  let arabic_messages = [
    "Ù†Ø¬Ø­Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",
    "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„",
    "ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: 100 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©",
    "Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª: 500"
  ]
  
  let hebrew_messages = [
    "×”×¤×¢×•×œ×” ×”×¦×œ×™×—×”",
    "××™×¨×¢×” ×©×’×™××” ×‘×—×™×‘×•×¨",
    "×–××Ÿ ×ª×’×•×‘×”: 100 ××™×œ×™×©× ×™×•×ª",
    "××¡×¤×¨ ×‘×§×©×•×ª: 500"
  ]
  
  // è®°å½•ä»å³åˆ°å·¦çš„æ–‡æœ¬
  for message in arabic_messages {
    let log_record = LogRecord::new(Info, message)
    Logger::emit(logger, log_record)
    assert_eq(LogRecord::body(log_record), Some(message))
  }
  
  for message in hebrew_messages {
    let log_record = LogRecord::new(Info, message)
    Logger::emit(logger, log_record)
    assert_eq(LogRecord::body(log_record), Some(message))
  }
}

test "mixed_language_content" {
  let provider = LoggerProvider::default()
  let logger = LoggerProvider::get_logger(provider, "mixed.test")
  
  // æµ‹è¯•æ··åˆè¯­è¨€å†…å®¹
  let mixed_messages = [
    "User ç”¨æˆ·123 performed æ“ä½œ æ•°æ®åº“æŸ¥è¯¢",
    "HTTP è¯·æ±‚ å¤±è´¥: Database connection timeout",
    "å¤„ç†æ—¶é—´ Processing time: 1.234 ç§’ seconds",
    "ç¼“å­˜ Cache å‘½ä¸­ç‡ hit rate: 95.5%",
    "ã‚µãƒ¼ãƒ“ã‚¹ service çŠ¶æ…‹ status: æ­£å¸¸ normal",
    "Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° System: æ­£å¸¸æ­£å¸¸è¿è¡Œ normal operation"
  ]
  
  // è®°å½•æ··åˆè¯­è¨€å†…å®¹
  for message in mixed_messages {
    let log_record = LogRecord::new(Info, message)
    Logger::emit(logger, log_record)
    assert_eq(LogRecord::body(log_record), Some(message))
  }
}