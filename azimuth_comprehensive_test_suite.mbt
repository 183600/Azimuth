// Azimuth é¡¹ç›®æ–°å¢ MoonBit æµ‹è¯•ç”¨ä¾‹
// ä½¿ç”¨æ ‡å‡† MoonBit æµ‹è¯•è¯­æ³•ï¼Œè¦†ç›–å¤šç§åŠŸèƒ½åœºæ™¯

test "extreme_boundary_values" {
  // æå€¼è¾¹ç•Œæµ‹è¯•
  let max_val = 2147483647
  let min_val = -2147483648
  let zero = 0
  let one = 1
  let neg_one = -1
  
  // æµ‹è¯•æå€¼é—´çš„åŠ æ³•è¿ç®—
  @azimuth.assert_eq(max_val, @azimuth.add(max_val, zero))
  @azimuth.assert_eq(min_val, @azimuth.add(min_val, zero))
  @azimuth.assert_eq(max_val - 1, @azimuth.add(max_val, neg_one))
  @azimuth.assert_eq(min_val + 1, @azimuth.add(min_val, one))
  
  // æµ‹è¯•æå€¼é—´çš„ä¹˜æ³•è¿ç®—
  @azimuth.assert_eq(zero, @azimuth.multiply(max_val, zero))
  @azimuth.assert_eq(zero, @azimuth.multiply(min_val, zero))
  @azimuth.assert_eq(max_val, @azimuth.multiply(max_val, one))
  @azimuth.assert_eq(min_val, @azimuth.multiply(min_val, one))
}

test "advanced_string_operations" {
  // é«˜çº§å­—ç¬¦ä¸²æ“ä½œæµ‹è¯•
  // æµ‹è¯•å¤šè¯­è¨€å­—ç¬¦ä¸²
  let chinese_name = "å¼ ä¸‰"
  let english_name = "John"
  let mixed_name = "å¼ ä¸‰ John"
  
  @azimuth.assert_eq_string("Hello, å¼ ä¸‰!", @azimuth.greet(chinese_name))
  @azimuth.assert_eq_string("Hello, John!", @azimuth.greet(english_name))
  @azimuth.assert_eq_string("Hello, å¼ ä¸‰ John!", @azimuth.greet(mixed_name))
  
  // æµ‹è¯•ç‰¹æ®Šå­—ç¬¦å’Œæ•°å­—ç»„åˆ
  let special_chars = "User@123#Admin"
  let unicode_chars = "æµ‹è¯•ğŸš€User"
  
  @azimuth.assert_eq_string("Hello, User@123#Admin!", @azimuth.greet(special_chars))
  @azimuth.assert_eq_string("Hello, æµ‹è¯•ğŸš€User!", @azimuth.greet(unicode_chars))
  
  // æµ‹è¯•ç©ºå­—ç¬¦ä¸²å’Œå•å­—ç¬¦
  let empty_string = ""
  let single_char = "A"
  
  @azimuth.assert_eq_string("Hello, !", @azimuth.greet(empty_string))
  @azimuth.assert_eq_string("Hello, A!", @azimuth.greet(single_char))
}

test "complex_mathematical_calculations" {
  // å¤æ‚æ•°å­¦è®¡ç®—æµ‹è¯•
  // æµ‹è¯•æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—
  let fib_0 = 0
  let fib_1 = 1
  let fib_2 = @azimuth.add(fib_0, fib_1)
  let fib_3 = @azimuth.add(fib_1, fib_2)
  let fib_4 = @azimuth.add(fib_2, fib_3)
  let fib_5 = @azimuth.add(fib_3, fib_4)
  
  @azimuth.assert_eq(1, fib_2)
  @azimuth.assert_eq(2, fib_3)
  @azimuth.assert_eq(3, fib_4)
  @azimuth.assert_eq(5, fib_5)
  
  // æµ‹è¯•é˜¶ä¹˜è®¡ç®— (5! = 120)
  let fact_1 = 1
  let fact_2 = @azimuth.multiply(fact_1, 2)
  let fact_3 = @azimuth.multiply(fact_2, 3)
  let fact_4 = @azimuth.multiply(fact_3, 4)
  let fact_5 = @azimuth.multiply(fact_4, 5)
  
  @azimuth.assert_eq(2, fact_2)
  @azimuth.assert_eq(6, fact_3)
  @azimuth.assert_eq(24, fact_4)
  @azimuth.assert_eq(120, fact_5)
  
  // æµ‹è¯•å¹‚è¿ç®— (2^4 = 16)
  let power_base = 2
  let power_result_1 = power_base
  let power_result_2 = @azimuth.multiply(power_result_1, power_base)
  let power_result_3 = @azimuth.multiply(power_result_2, power_base)
  let power_result_4 = @azimuth.multiply(power_result_3, power_base)
  
  @azimuth.assert_eq(2, power_result_1)
  @azimuth.assert_eq(4, power_result_2)
  @azimuth.assert_eq(8, power_result_3)
  @azimuth.assert_eq(16, power_result_4)
}

test "financial_calculations" {
  // é‡‘èè®¡ç®—æµ‹è¯•
  // æµ‹è¯•å¤åˆ©è®¡ç®— A = P(1 + r/n)^(nt)
  let principal = 1000  // æœ¬é‡‘
  let rate = 5  // å¹´åˆ©ç‡5%
  let time = 3  // 3å¹´
  
  // ç®€åŒ–è®¡ç®—ï¼š1000 * (1.05)^3 â‰ˆ 1000 * 1.157625 = 1157
  let year1_amount = @azimuth.add(principal, @azimuth.multiply(principal, rate) / 100)
  let year2_amount = @azimuth.add(year1_amount, @azimuth.multiply(year1_amount, rate) / 100)
  let year3_amount = @azimuth.add(year2_amount, @azimuth.multiply(year2_amount, rate) / 100)
  
  @azimuth.assert_eq(1050, year1_amount)
  @azimuth.assert_eq(1102, year2_amount)  // æ•´æ•°é™¤æ³•ï¼š1050 + 52 = 1102
  @azimuth.assert_eq(1157, year3_amount)  // æ•´æ•°é™¤æ³•ï¼š1102 + 55 = 1157
  
  // æµ‹è¯•è´·æ¬¾è®¡ç®—
  let loan_amount = 10000
  let annual_rate = 6  // 6%
  let loan_term = 5  // 5å¹´
  
  // ç®€åŒ–è®¡ç®—ï¼šæ€»åˆ©æ¯ = æœ¬é‡‘ * å¹´åˆ©ç‡ * å¹´æ•°
  let total_interest = @azimuth.multiply(@azimuth.multiply(loan_amount, annual_rate), loan_term) / 100
  let total_payment = @azimuth.add(loan_amount, total_interest)
  
  @azimuth.assert_eq(3000, total_interest)
  @azimuth.assert_eq(13000, total_payment)
  
  // æµ‹è¯•æŠ˜æ—§è®¡ç®—
  let asset_value = 5000
  let depreciation_rate = 20  // 20%
  let useful_life = 5  // 5å¹´
  
  let annual_depreciation = @azimuth.multiply(asset_value, depreciation_rate) / 100
  let book_value_after_3_years = @azimuth.add(asset_value, -@azimuth.multiply(annual_depreciation, 3))
  
  @azimuth.assert_eq(1000, annual_depreciation)
  @azimuth.assert_eq(2000, book_value_after_3_years)
}

test "scientific_engineering_calculations" {
  // ç§‘å­¦å·¥ç¨‹è®¡ç®—æµ‹è¯•
  // æµ‹è¯•æ¬§å§†å®šå¾‹ V = I * R
  let current = 5  // 5å®‰åŸ¹
  let resistance = 10  // 10æ¬§å§†
  let voltage = @azimuth.multiply(current, resistance)
  
  @azimuth.assert_eq(50, voltage)
  
  // æµ‹è¯•åŠŸç‡è®¡ç®— P = V * I
  let power = @azimuth.multiply(voltage, current)
  @azimuth.assert_eq(250, power)
  
  // æµ‹è¯•åŠ¨èƒ½è®¡ç®— E = 0.5 * m * v^2
  let mass = 100  // 100kg
  let velocity = 10  // 10m/s
  let kinetic_energy = @azimuth.multiply(mass, @azimuth.multiply(velocity, velocity)) / 2
  
  @azimuth.assert_eq(5000, kinetic_energy)
  
  // æµ‹è¯•åœ†çš„é¢ç§¯å’Œå‘¨é•¿
  let radius = 7
  let pi_approx = 22  // 22/7 â‰ˆ Ï€
  let circumference = @azimuth.multiply(2, @azimuth.multiply(radius, pi_approx)) / 7
  let area = @azimuth.multiply(radius, @azimuth.multiply(radius, pi_approx)) / 7
  
  @azimuth.assert_eq(44, circumference)  // 2 * 7 * 22/7 = 44
  @azimuth.assert_eq(154, area)  // 7 * 7 * 22/7 = 154
}

test "data_analysis_calculations" {
  // æ•°æ®åˆ†æè®¡ç®—æµ‹è¯•
  // æµ‹è¯•å¹³å‡å€¼è®¡ç®—
  let data_sum = 150
  let data_count = 5
  let average = data_sum / data_count
  
  @azimuth.assert_eq(30, average)
  
  // æµ‹è¯•æ–¹å·®è®¡ç®— (ç®€åŒ–ç‰ˆ)
  let mean = 30  // å¹³å‡å€¼
  // ç®€åŒ–æ–¹å·®è®¡ç®—ï¼š(10-30)Â² + (20-30)Â² + (30-30)Â² + (40-30)Â² + (50-30)Â²
  let diff1 = @azimuth.add(10, -mean)  // -20
  let diff2 = @azimuth.add(20, -mean)  // -10
  let diff3 = @azimuth.add(30, -mean)  // 0
  let diff4 = @azimuth.add(40, -mean)  // 10
  let diff5 = @azimuth.add(50, -mean)  // 20
  
  let variance_sum = @azimuth.add(@azimuth.add(@azimuth.add(
    @azimuth.multiply(diff1, diff1), @azimuth.multiply(diff2, diff2)),
    @azimuth.add(@azimuth.multiply(diff3, diff3), @azimuth.multiply(diff4, diff4))),
    @azimuth.multiply(diff5, diff5))
  
  @azimuth.assert_eq(1000, variance_sum)  // 400 + 100 + 0 + 100 + 400 = 1000
  let variance = variance_sum / data_count
  @azimuth.assert_eq(200, variance)
  
  // æµ‹è¯•ç™¾åˆ†æ¯”è®¡ç®—
  let part = 25
  let whole = 200
  let percentage = @azimuth.multiply(part, 100) / whole
  
  @azimuth.assert_eq(12, percentage)
  
  // æµ‹è¯•å¢é•¿ç‡è®¡ç®—
  let old_value = 100
  let new_value = 150
  let growth_rate = @azimuth.multiply(@azimuth.add(new_value, -old_value), 100) / old_value
  
  @azimuth.assert_eq(50, growth_rate)
}

test "error_handling_and_validation" {
  // é”™è¯¯å¤„ç†å’ŒéªŒè¯æµ‹è¯•
  // æµ‹è¯•é™¤é›¶ä¿æŠ¤ï¼ˆé€šè¿‡ä¹˜æ³•æ¨¡æ‹Ÿï¼‰
  let numerator = 100
  let denominator = 0
  
  // æ¨¡æ‹Ÿé™¤é›¶æ£€æŸ¥ï¼šå¦‚æœåˆ†æ¯ä¸º0ï¼Œè¿”å›0
  let safe_division_result = @azimuth.multiply(numerator, denominator)  // ä»»ä½•æ•°ä¹˜ä»¥0éƒ½æ˜¯0
  @azimuth.assert_eq(0, safe_division_result)
  
  // æµ‹è¯•æº¢å‡ºå¤„ç†
  let large_num = 2147483647
  let small_num = 1
  
  // æµ‹è¯•åŠ æ³•æº¢å‡º
  let overflow_add = @azimuth.add(large_num, small_num)
  // åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œè¿™åº”è¯¥è§¦å‘æº¢å‡ºå¤„ç†ï¼Œè¿™é‡Œæˆ‘ä»¬éªŒè¯è¡Œä¸º
  @azimuth.assert_eq(large_num, overflow_add)
  
  // æµ‹è¯•ä¹˜æ³•æº¢å‡º
  let overflow_mul = @azimuth.multiply(large_num, 2)
  @azimuth.assert_eq(large_num, overflow_mul)
  
  // æµ‹è¯•è´Ÿæ•°è¾“å…¥éªŒè¯
  let negative_input = -100
  let positive_result = @azimuth.multiply(negative_input, -1)
  @azimuth.assert_eq(100, positive_result)
}

test "performance_benchmarks" {
  // æ€§èƒ½åŸºå‡†æµ‹è¯•
  // æµ‹è¯•å¤§é‡æ•°æ®è¿ç®—æ€§èƒ½
  let iterations = 1000
  let base_value = 5
  let multiplier = 3
  let addend = 2
  
  // æ¨¡æ‹Ÿå¾ªç¯è¿ç®—ï¼šresult = (base * multiplier + addend) * iterations
  let single_operation = @azimuth.add(@azimuth.multiply(base_value, multiplier), addend)
  let batch_result = @azimuth.multiply(single_operation, iterations)
  
  @azimuth.assert_eq(17, single_operation)  // 5 * 3 + 2 = 17
  @azimuth.assert_eq(17000, batch_result)  // 17 * 1000 = 17000
  
  // æµ‹è¯•å†…å­˜ä½¿ç”¨æ¨¡å¼
  let array_size = 100
  let element_size = 4  // å‡è®¾æ¯ä¸ªå…ƒç´ 4å­—èŠ‚
  let total_memory = @azimuth.multiply(array_size, element_size)
  
  @azimuth.assert_eq(400, total_memory)
  
  // æµ‹è¯•ç¼“å­˜æ•ˆç‡æ¨¡æ‹Ÿ
  let cache_size = 64
  let data_size = 1024
  let cache_misses = @azimuth.multiply(data_size / cache_size, 1)
  
  @azimuth.assert_eq(16, cache_misses)  // 1024/64 = 16
}

test "real_world_scenarios" {
  // çœŸå®ä¸–ç•Œåœºæ™¯æµ‹è¯•
  // æµ‹è¯•ç”µå­å•†åŠ¡è´­ç‰©è½¦è®¡ç®—
  let item1_price = 299
  let item1_quantity = 2
  let item2_price = 199
  let item2_quantity = 1
  let tax_rate = 8  // 8%
  let shipping_cost = 15
  
  // è®¡ç®—å•†å“æ€»ä»·
  let item1_total = @azimuth.multiply(item1_price, item1_quantity)
  let item2_total = @azimuth.multiply(item2_price, item2_quantity)
  let subtotal = @azimuth.add(item1_total, item2_total)
  
  // è®¡ç®—ç¨è´¹
  let tax_amount = @azimuth.multiply(subtotal, tax_rate) / 100
  
  // è®¡ç®—æ€»ä»·
  let total = @azimuth.add(@azimuth.add(subtotal, tax_amount), shipping_cost)
  
  @azimuth.assert_eq(598, item1_total)  // 299 * 2
  @azimuth.assert_eq(199, item2_total)  // 199 * 1
  @azimuth.assert_eq(797, subtotal)  // 598 + 199
  @azimuth.assert_eq(63, tax_amount)  // 797 * 8% = 63 (æ•´æ•°é™¤æ³•)
  @azimuth.assert_eq(875, total)  // 797 + 63 + 15 = 875
  
  // æµ‹è¯•ç”¨æˆ·ç§¯åˆ†ç³»ç»Ÿ
  let purchase_amount = 875
  let points_per_dollar = 10
  let earned_points = @azimuth.multiply(purchase_amount, points_per_dollar)
  
  @azimuth.assert_eq(8750, earned_points)
  
  // æµ‹è¯•åº“å­˜ç®¡ç†
  let initial_stock = 100
  let sold_items = @azimuth.add(item1_quantity, item2_quantity)
  let restocked_items = 50
  let current_stock = @azimuth.add(@azimuth.add(initial_stock, -sold_items), restocked_items)
  
  @azimuth.assert_eq(3, sold_items)  // 2 + 1
  @azimuth.assert_eq(147, current_stock)  // 100 - 3 + 50 = 147
}

test "algorithm_implementation" {
  // ç®—æ³•å®ç°æµ‹è¯•
  // æµ‹è¯•çº¿æ€§æœç´¢æ¨¡æ‹Ÿ
  let array_size = 10
  let target_position = 7  // ç›®æ ‡åœ¨ç¬¬7ä¸ªä½ç½®
  let comparisons = target_position  // éœ€è¦æ¯”è¾ƒ7æ¬¡
  
  @azimuth.assert_eq(7, comparisons)
  
  // æµ‹è¯•äºŒåˆ†æœç´¢æ¨¡æ‹Ÿ
  let sorted_array_size = 100
  // æœ€åæƒ…å†µä¸‹éœ€è¦ log2(100) â‰ˆ 7 æ¬¡æ¯”è¾ƒ
  let max_binary_comparisons = 7
  let best_case_comparisons = 1
  
  @azimuth.assert_eq(1, best_case_comparisons)
  @azimuth.assert_eq(7, max_binary_comparisons)
  
  // æµ‹è¯•æ’åºç®—æ³•å¤æ‚åº¦æ¨¡æ‹Ÿ
  let sort_size = 5
  // å†’æ³¡æ’åºæœ€åæƒ…å†µï¼šn*(n-1)/2
  let bubble_sort_swaps = @azimuth.multiply(sort_size, @azimuth.add(sort_size, -1)) / 2
  // é€‰æ‹©æ’åºæ€»æ˜¯ï¼šn*(n-1)/2
  let selection_sort_comparisons = @azimuth.multiply(sort_size, @azimuth.add(sort_size, -1)) / 2
  
  @azimuth.assert_eq(10, bubble_sort_swaps)  // 5*4/2 = 10
  @azimuth.assert_eq(10, selection_sort_comparisons)  // 5*4/2 = 10
  
  // æµ‹è¯•é€’å½’å‡½æ•°æ¨¡æ‹Ÿï¼ˆé˜¶ä¹˜ï¼‰
  let n = 4
  // 4! = 4 * 3 * 2 * 1 = 24
  let factorial_result = @azimuth.multiply(@azimuth.multiply(
    @azimuth.multiply(4, 3), 2), 1)
  
  @azimuth.assert_eq(24, factorial_result)
  
  // æµ‹è¯•åŠ¨æ€è§„åˆ’æ¨¡æ‹Ÿï¼ˆæ–æ³¢é‚£å¥‘ï¼‰
  // F(6) = 8 (0,1,1,2,3,5,8)
  let fib_6 = 8  // é¢„è®¡ç®—ç»“æœ
  
  @azimuth.assert_eq(8, fib_6)
}